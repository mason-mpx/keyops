import{u as us,r as a,H as f,j as e,B as i,T as r,J as q,a as x,A as J,w as xe,x as pe,K,c as X,P as O,m as y,s as ue,t as Z,L as gs,N as Te,M as b,O as ge,I as ee,g as ke,Q as ms,h as Re,i as D,k as z,l as T,p as k,b as F,V as We,W as Ae,X as Me,y as js,Y as Be,D as fs}from"./index-DNdAKB9f.js";import{T as Le,a as Oe,b as Fe,c as se,d as c,e as $e}from"./TableRow-2FuGKbnY.js";import{C as m}from"./Chip-B8lB6W_F.js";import{T as me}from"./TablePagination-CykxsR0-.js";import{S as je}from"./Stack-6rKlDBQM.js";import"./LastPage-v7sA_Lnn.js";function Ss(){const{t}=us(),[te,Ee]=a.useState([]),[l,w]=a.useState(null),[$,Ue]=a.useState({}),[oe,Ne]=a.useState([]),[,E]=a.useState(!1),[U,Qe]=a.useState(""),[R,S]=a.useState("name"),[Ve,I]=a.useState("asc"),[fe,ne]=a.useState(0),[ae,Ye]=a.useState(20),[ys]=a.useState(0),[ye,be]=a.useState(null),[v,Ce]=a.useState(null),[Ge,C]=a.useState(null),[_e,W]=a.useState(!1),[qe,N]=a.useState(!1),[Je,A]=a.useState(!1),[Ke,re]=a.useState(!1),[we,ve]=a.useState([]),[Xe,Q]=a.useState(!1),[ie,M]=a.useState(!1),[h,j]=a.useState({name:"",description:"",color:"#607d8b"}),[g,P]=a.useState([]),[B,G]=a.useState(""),[le,u]=a.useState(0),[V,Pe]=a.useState(10),H=async()=>{try{E(!0);const s=await f.get("/api/host-groups?stats=true");s.data.code===0&&Ee(s.data.data?.groups||s.data.data||[])}catch(s){console.error("Failed to load groups:",s)}finally{E(!1)}},Y=a.useCallback(async s=>{try{const o=await f.get(`/api/host-groups/${s}/hosts?pageSize=10000`);o.data.code===0&&Ue(d=>({...d,[s]:o.data.data.hosts||[]}))}catch(o){console.error("Failed to load group hosts:",o)}},[]),Ze=async()=>{try{const s=await f.get("/api/hosts?pageSize=10000");s.data.code===0&&Ne(s.data.data?.hosts||[])}catch(s){console.error("Failed to load all hosts:",s)}};a.useEffect(()=>{H(),Ze()},[]),a.useEffect(()=>{ie&&l&&!$[l.id]&&Y(l.id)},[ie,l,$,Y]);const es=async()=>{try{(await f.post("/api/host-groups",h)).data.code===0&&(W(!1),H(),j({name:"",description:"",color:"#607d8b"}))}catch(s){console.error("Failed to create group:",s)}},ss=async()=>{if(l){if(!h.name.trim()){alert("分组名称不能为空");return}try{const s=await f.put(`/api/host-groups/${l.id}`,h);s.data.code===0?(N(!1),H(),j({name:"",description:"",color:"#607d8b"}),l.id===s.data.data?.id&&w(s.data.data)):alert(`更新失败: ${s.data.msg||"未知错误"}`)}catch(s){console.error("Failed to update group:",s);const o=s?.response?.data?.msg||s?.message||"更新分组失败";alert(`更新失败: ${o}`)}}},ts=async()=>{if(l)try{const s=await f.delete(`/api/host-groups/${l.id}`);s.data.code===0?(Q(!1),w(null),H()):alert(`删除失败: ${s.data.msg||"未知错误"}`)}catch(s){console.error("Failed to delete group:",s);const o=s?.response?.data?.msg||s?.message||"删除分组失败";alert(`删除失败: ${o}`)}},os=async()=>{if(!(!l||g.length===0))try{const s=await f.post(`/api/host-groups/${l.id}/hosts`,{hostIds:g});s.data.code===0?(A(!1),P([]),G(""),u(0),await Y(l.id),await H(),M(!0)):alert(`添加失败: ${s.data.msg||"未知错误"}`)}catch(s){console.error("Failed to add hosts:",s);const o=s?.response?.data?.msg||s?.message||"添加主机失败";alert(`添加失败: ${o}`)}},ns=async s=>{if(l)try{const o=await f.delete(`/api/host-groups/${l.id}/hosts`,{data:{hostIds:[s]}});o.data.code===0?(await Y(l.id),await H()):alert(`删除失败: ${o.data.msg||"未知错误"}`)}catch(o){console.error("Failed to remove host:",o);const d=o?.response?.data?.msg||o?.message||"删除主机失败";alert(`删除失败: ${d}`)}},as=(s,o)=>{s.stopPropagation(),be(s.currentTarget),Ce(o)},_=()=>{be(null),Ce(null)},rs=()=>{v&&Se(v),_()},is=()=>{v&&(w(v),Q(!0)),_()},ls=async()=>{if(v){w(v),E(!0);try{const s=await f.get(`/api/host-groups/${v.id}/users`);s.data.code===0&&(ve(s.data.data.users||[]),re(!0))}catch(s){console.error("Failed to load group users:",s),ve([])}finally{E(!1)}}_()},cs=s=>{w(s),A(!0)},Se=s=>{w(s),j({name:s.name,description:s.description,color:s.color||"#607d8b"}),N(!0)},ds=()=>{if(!l)return[];const s=$[l.id]||[],o=new Set(s.map(d=>d.id));return oe.filter(d=>!o.has(d.id))},Ie=()=>{let s=te;return U&&(s=s.filter(o=>o.name.toLowerCase().includes(U.toLowerCase())||o.description.toLowerCase().includes(U.toLowerCase()))),s=[...s].sort((o,d)=>{let n=o[R],p=d[R];return R==="createdAt"&&(n=new Date(n).getTime(),p=new Date(p).getTime()),Ve==="asc"?n>p?1:-1:n<p?1:-1}),s},hs=()=>{const s=Ie(),o=fe*ae,d=o+ae;return s.slice(o,d)},ce=s=>B?s.filter(o=>o.name.toLowerCase().includes(B.toLowerCase())||o.ip.includes(B)):s,He=s=>{const o=ce(s),d=le*V,n=d+V;return o.slice(d,n)},De=te.length,de=oe.length,ze=oe.filter(s=>s.status==="online").length,he=Ie(),xs=(s,o)=>{ne(o)},ps=s=>{Ye(parseInt(s.target.value,10)),ne(0)};return e.jsxs(i,{sx:{p:3},children:[e.jsxs(i,{sx:{mb:3},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(i,{children:[e.jsxs(r,{variant:"h4",sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(q,{fontSize:"large"}),t("hostGroups.title")]}),e.jsx(r,{variant:"body2",color:"text.secondary",children:t("hostGroups.subtitle")})]}),e.jsx(x,{variant:"contained",size:"large",startIcon:e.jsx(J,{}),onClick:()=>W(!0),sx:{borderRadius:2},children:t("hostGroups.createGroup")})]}),e.jsxs(i,{sx:{display:"flex",gap:2,mb:3,width:"100%",flexWrap:"wrap"},children:[e.jsx(xe,{sx:{flex:1,minWidth:{xs:"100%",sm:"calc(33.333% - 12px)"},bgcolor:"primary.main",color:"white",height:160,borderRadius:3,transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:6}},children:e.jsx(pe,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(i,{children:[e.jsx(r,{variant:"body2",sx:{opacity:.9,mb:1},children:t("hostGroups.stats.totalGroups")}),e.jsx(r,{variant:"h2",sx:{fontWeight:700,lineHeight:1},children:De}),e.jsx(r,{variant:"caption",sx:{opacity:.8,mt:1,display:"block"},children:t("hostGroups.stats.groups")})]}),e.jsx(i,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",p:2,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(q,{sx:{fontSize:48}})})]})})}),e.jsx(xe,{sx:{flex:1,minWidth:{xs:"100%",sm:"calc(33.333% - 12px)"},bgcolor:"success.main",color:"white",height:160,borderRadius:3,transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:6}},children:e.jsx(pe,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(i,{children:[e.jsx(r,{variant:"body2",sx:{opacity:.9,mb:1},children:t("hostGroups.stats.totalHosts")}),e.jsx(r,{variant:"h2",sx:{fontWeight:700,lineHeight:1},children:de}),e.jsx(r,{variant:"caption",sx:{opacity:.8,mt:1,display:"block"},children:t("hostGroups.stats.hosts")})]}),e.jsx(i,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",p:2,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(K,{sx:{fontSize:48}})})]})})}),e.jsx(xe,{sx:{flex:1,minWidth:{xs:"100%",sm:"calc(33.333% - 12px)"},bgcolor:"info.main",color:"white",height:160,borderRadius:3,transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:6}},children:e.jsx(pe,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(i,{children:[e.jsx(r,{variant:"body2",sx:{opacity:.9,mb:1},children:t("hostGroups.stats.onlineHosts")}),e.jsx(r,{variant:"h2",sx:{fontWeight:700,lineHeight:1},children:ze}),e.jsxs(r,{variant:"caption",sx:{opacity:.8,mt:1,display:"block"},children:[de>0?Math.round(ze/de*100):0,"% ",t("hostGroups.stats.onlineRate")]})]}),e.jsx(i,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",p:2,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(X,{sx:{fontSize:48}})})]})})})]})]}),e.jsx(O,{sx:{p:2,mb:3},children:e.jsxs(i,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:2,alignItems:"center"},children:[e.jsx(i,{sx:{flex:{xs:"none",md:"0 0 33.333%"}},children:e.jsx(y,{fullWidth:!0,size:"small",placeholder:t("hostGroups.search.placeholder"),value:U,onChange:s=>{Qe(s.target.value),ne(0)},InputProps:{startAdornment:e.jsx(ue,{position:"start",children:e.jsx(Z,{})})}})}),e.jsx(i,{sx:{flex:1},children:e.jsxs(i,{sx:{display:"flex",gap:2,alignItems:"center",justifyContent:"flex-end"},children:[e.jsxs(x,{startIcon:e.jsx(gs,{}),onClick:s=>C(s.currentTarget),variant:"outlined",size:"small",children:[t("hostGroups.search.sort"),": ",t(R==="name"?"common.name":R==="hostCount"?"hostGroups.table.hostCount":"common.createdAt")]}),e.jsx(r,{variant:"body2",color:"text.secondary",children:t("hostGroups.search.showing",{filtered:he.length,total:De})})]})})]})}),e.jsxs(Te,{anchorEl:Ge,open:!!Ge,onClose:()=>C(null),children:[e.jsx(b,{onClick:()=>{S("name"),I("asc"),C(null)},children:t("hostGroups.search.sortBy.nameAsc")}),e.jsx(b,{onClick:()=>{S("name"),I("desc"),C(null)},children:t("hostGroups.search.sortBy.nameDesc")}),e.jsx(b,{onClick:()=>{S("hostCount"),I("desc"),C(null)},children:t("hostGroups.search.sortBy.hostCountDesc")}),e.jsx(b,{onClick:()=>{S("hostCount"),I("asc"),C(null)},children:t("hostGroups.search.sortBy.hostCountAsc")}),e.jsx(b,{onClick:()=>{S("createdAt"),I("desc"),C(null)},children:t("hostGroups.search.sortBy.timeDesc")}),e.jsx(b,{onClick:()=>{S("createdAt"),I("asc"),C(null)},children:t("hostGroups.search.sortBy.timeAsc")})]}),te.length===0?e.jsxs(O,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(168, 85, 247, 0.05) 100%)"},children:[e.jsx(q,{sx:{fontSize:80,color:"text.secondary",mb:2,opacity:.5}}),e.jsx(r,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:t("hostGroups.empty.noGroups")}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:3},children:t("hostGroups.empty.noGroupsDesc")}),e.jsx(x,{variant:"contained",startIcon:e.jsx(J,{}),onClick:()=>W(!0),children:t("hostGroups.empty.createFirst")})]}):he.length===0?e.jsxs(O,{sx:{p:4,textAlign:"center"},children:[e.jsx(Z,{sx:{fontSize:60,color:"text.secondary",mb:2}}),e.jsx(r,{variant:"h6",color:"text.secondary",children:t("hostGroups.empty.noResults")}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mt:1},children:t("hostGroups.empty.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{component:O,children:e.jsxs(Oe,{children:[e.jsx(Fe,{children:e.jsxs(se,{children:[e.jsx(c,{children:t("hostGroups.table.groupInfo")}),e.jsx(c,{align:"center",children:t("hostGroups.table.hostCount")}),e.jsx(c,{align:"center",children:t("hostGroups.table.onlineCount")}),e.jsx(c,{align:"center",children:t("hostGroups.table.onlineRate")}),e.jsx(c,{align:"center",children:t("hostGroups.table.createdAt")}),e.jsx(c,{align:"right",children:t("common.actions")})]})}),e.jsx($e,{children:hs().map(s=>e.jsxs(se,{hover:!0,sx:{cursor:"pointer"},onClick:()=>{w(s),M(!0)},children:[e.jsx(c,{children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ge,{sx:{bgcolor:s.color,width:40,height:40,fontWeight:600,fontSize:"1.2rem"},children:s.name?.[0]?.toUpperCase()}),e.jsxs(i,{children:[e.jsx(r,{variant:"subtitle2",fontWeight:600,children:s.name}),e.jsx(r,{variant:"caption",color:"text.secondary",children:s.description||t("hostGroups.dialog.noDescription")})]})]})}),e.jsx(c,{align:"center",children:e.jsx(m,{icon:e.jsx(K,{}),label:s.hostCount,size:"small",variant:"outlined"})}),e.jsx(c,{align:"center",children:e.jsx(m,{icon:e.jsx(X,{}),label:s.onlineCount,size:"small",color:"success"})}),e.jsx(c,{align:"center",children:e.jsx(r,{variant:"body2",children:s.hostCount>0?`${Math.round(s.onlineCount/s.hostCount*100)}%`:"-"})}),e.jsx(c,{align:"center",children:e.jsx(r,{variant:"caption",color:"text.secondary",children:new Date(s.createdAt).toLocaleDateString()})}),e.jsxs(c,{align:"right",onClick:o=>o.stopPropagation(),children:[e.jsx(ee,{size:"small",onClick:o=>{o.stopPropagation(),Se(s)},children:e.jsx(ke,{fontSize:"small"})}),e.jsx(ee,{size:"small",onClick:o=>{o.stopPropagation(),cs(s)},children:e.jsx(J,{fontSize:"small"})}),e.jsx(ee,{size:"small",onClick:o=>as(o,s),children:e.jsx(ms,{fontSize:"small"})})]})]},s.id))})]})}),e.jsx(O,{sx:{mt:2},children:e.jsx(me,{component:"div",count:he.length,page:fe,onPageChange:xs,rowsPerPage:ae,onRowsPerPageChange:ps,rowsPerPageOptions:[10,20,50,100],labelRowsPerPage:t("hostGroups.pagination.rowsPerPage"),labelDisplayedRows:({from:s,to:o,count:d})=>t("hostGroups.pagination.displayedRows",{from:s,to:o,count:d}),sx:{borderTop:"1px solid #e2e8f0",mt:0,width:"100%",".MuiTablePagination-toolbar":{paddingLeft:2,paddingRight:2,minHeight:"52px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},".MuiTablePagination-spacer":{flex:"1 1 auto"},".MuiTablePagination-selectLabel":{marginRight:1,marginBottom:0,fontWeight:500,fontSize:"0.875rem",color:"text.secondary",display:"flex",alignItems:"center",lineHeight:1.5},".MuiTablePagination-displayedRows":{marginBottom:0,fontWeight:500,fontSize:"0.875rem",color:"text.secondary",display:"flex",alignItems:"center",lineHeight:1.5},".MuiTablePagination-select":{fontSize:"0.875rem",marginRight:2,marginTop:0,marginBottom:0},".MuiTablePagination-actions":{marginLeft:1,display:"flex",alignItems:"center"}}})})]}),e.jsxs(Te,{anchorEl:ye,open:!!ye,onClose:_,children:[e.jsxs(b,{onClick:rs,children:[e.jsx(ke,{sx:{mr:1},fontSize:"small"}),t("hostGroups.actions.edit")]}),e.jsxs(b,{onClick:ls,children:[e.jsx(q,{sx:{mr:1},fontSize:"small"}),"查看授权用户"]}),e.jsxs(b,{onClick:is,sx:{color:"error.main"},children:[e.jsx(Re,{sx:{mr:1},fontSize:"small"}),t("hostGroups.actions.delete")]})]}),e.jsxs(D,{open:_e,onClose:()=>W(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(z,{children:t("hostGroups.dialog.create")}),e.jsx(T,{children:e.jsxs(je,{spacing:2,sx:{mt:1},children:[e.jsx(y,{label:t("hostGroups.groupName"),value:h.name,onChange:s=>j({...h,name:s.target.value}),fullWidth:!0,required:!0}),e.jsx(y,{label:t("hostGroups.groupDescription"),value:h.description,onChange:s=>j({...h,description:s.target.value}),fullWidth:!0,multiline:!0,rows:2,placeholder:t("hostGroups.dialog.descPlaceholder")}),e.jsx(y,{label:t("hostGroups.groupColor"),type:"color",value:h.color,onChange:s=>j({...h,color:s.target.value}),fullWidth:!0})]})}),e.jsxs(k,{children:[e.jsx(x,{onClick:()=>W(!1),children:t("hostGroups.actions.cancel")}),e.jsx(x,{onClick:es,variant:"contained",disabled:!h.name,children:t("hostGroups.actions.create")})]})]}),e.jsxs(D,{open:qe,onClose:()=>N(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(z,{children:t("hostGroups.dialog.edit")}),e.jsx(T,{children:e.jsxs(je,{spacing:2,sx:{mt:1},children:[e.jsx(y,{label:t("hostGroups.groupName"),value:h.name,onChange:s=>j({...h,name:s.target.value}),fullWidth:!0,required:!0}),e.jsx(y,{label:t("hostGroups.groupDescription"),value:h.description,onChange:s=>j({...h,description:s.target.value}),fullWidth:!0,multiline:!0,rows:2,placeholder:t("hostGroups.dialog.descPlaceholder")}),e.jsx(y,{label:t("hostGroups.groupColor"),type:"color",value:h.color,onChange:s=>j({...h,color:s.target.value}),fullWidth:!0})]})}),e.jsxs(k,{children:[e.jsx(x,{onClick:()=>N(!1),children:t("hostGroups.actions.cancel")}),e.jsx(x,{onClick:ss,variant:"contained",disabled:!h.name,children:t("hostGroups.actions.save")})]})]}),e.jsxs(D,{open:ie,onClose:()=>{M(!1),G(""),u(0)},maxWidth:"lg",fullWidth:!0,children:[e.jsx(z,{children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ge,{sx:{bgcolor:l?.color,width:48,height:48,fontWeight:700,fontSize:"1.5rem"},children:l?.name?.[0]?.toUpperCase()}),e.jsxs(i,{children:[e.jsx(r,{variant:"h6",children:l?.name}),e.jsx(r,{variant:"caption",color:"text.secondary",children:l?.description||t("hostGroups.dialog.noDescription")})]})]}),e.jsx(x,{variant:"outlined",startIcon:e.jsx(J,{}),onClick:()=>{M(!1),A(!0)},children:t("hostGroups.hosts.addHost")})]})}),e.jsxs(T,{dividers:!0,children:[e.jsx(y,{fullWidth:!0,size:"small",placeholder:t("hostGroups.hosts.searchPlaceholder"),value:B,onChange:s=>{G(s.target.value),u(0)},sx:{mb:2},InputProps:{startAdornment:e.jsx(ue,{position:"start",children:e.jsx(Z,{})})}}),(()=>{const s=$[l?.id||""]||[],o=ce(s),d=He(s);return s.length===0?e.jsx(F,{severity:"info",children:t("hostGroups.hosts.noHosts")}):o.length===0?e.jsx(F,{severity:"warning",children:t("hostGroups.hosts.noHostsFound")}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{children:e.jsxs(Oe,{size:"small",children:[e.jsx(Fe,{children:e.jsxs(se,{children:[e.jsx(c,{children:t("hostGroups.hosts.hostName")}),e.jsx(c,{children:t("hostGroups.hosts.ipAddress")}),e.jsx(c,{align:"center",children:t("hostGroups.hosts.port")}),e.jsx(c,{align:"center",children:t("hostGroups.hosts.type")}),e.jsx(c,{align:"center",children:t("common.status")}),e.jsx(c,{align:"right",children:t("common.actions")})]})}),e.jsx($e,{children:d.map(n=>e.jsxs(se,{hover:!0,children:[e.jsx(c,{children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(K,{color:"primary",fontSize:"small"}),e.jsx(r,{variant:"body2",children:n.name})]})}),e.jsx(c,{children:e.jsx(m,{label:n.ip,size:"small",variant:"outlined"})}),e.jsx(c,{align:"center",children:n.port}),e.jsx(c,{align:"center",children:e.jsx(m,{label:n.deviceType,size:"small"})}),e.jsx(c,{align:"center",children:e.jsx(m,{icon:n.status==="online"?e.jsx(X,{}):e.jsx(We,{}),label:n.status,size:"small",color:n.status==="online"?"success":"default"})}),e.jsx(c,{align:"right",children:e.jsx(ee,{size:"small",onClick:()=>{window.confirm(`确定要从分组 "${l?.name}" 中移除主机 "${n.name}" 吗？`)&&ns(n.id)},color:"error",children:e.jsx(Re,{fontSize:"small"})})})]},n.id))})]})}),e.jsx(me,{component:"div",count:o.length,page:le,onPageChange:(n,p)=>u(p),rowsPerPage:V,onRowsPerPageChange:n=>{Pe(parseInt(n.target.value,10)),u(0)},rowsPerPageOptions:[10,25,50,100],labelRowsPerPage:t("hostGroups.pagination.rowsPerPage"),labelDisplayedRows:({from:n,to:p,count:L})=>t("hostGroups.pagination.displayedRows",{from:n,to:p,count:L}),sx:{borderTop:"1px solid #e2e8f0",mt:0,width:"100%",".MuiTablePagination-toolbar":{paddingLeft:2,paddingRight:2,minHeight:"52px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},".MuiTablePagination-spacer":{flex:"1 1 auto"},".MuiTablePagination-selectLabel":{marginRight:1,marginBottom:0,fontWeight:500,fontSize:"0.875rem",color:"text.secondary",display:"flex",alignItems:"center",lineHeight:1.5},".MuiTablePagination-displayedRows":{marginBottom:0,fontWeight:500,fontSize:"0.875rem",color:"text.secondary",display:"flex",alignItems:"center",lineHeight:1.5},".MuiTablePagination-select":{fontSize:"0.875rem",marginRight:2,marginTop:0,marginBottom:0},".MuiTablePagination-actions":{marginLeft:1,display:"flex",alignItems:"center"}}})]})})()]}),e.jsx(k,{children:e.jsx(x,{onClick:()=>{M(!1),G(""),u(0)},children:t("hostGroups.actions.close")})})]}),e.jsxs(D,{open:Je,onClose:()=>{A(!1),P([]),G(""),u(0)},maxWidth:"md",fullWidth:!0,children:[e.jsx(z,{children:t("hostGroups.hosts.addToGroup")}),e.jsxs(T,{dividers:!0,children:[e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t("hostGroups.hosts.addToGroupDesc",{name:l?.name})}),e.jsx(y,{fullWidth:!0,size:"small",placeholder:t("hostGroups.hosts.searchPlaceholder"),value:B,onChange:s=>{G(s.target.value),u(0)},sx:{mb:2},InputProps:{startAdornment:e.jsx(ue,{position:"start",children:e.jsx(Z,{})})}}),(()=>{const s=ds(),o=ce(s),d=He(s);return s.length===0?e.jsx(F,{severity:"info",children:t("hostGroups.hosts.allInGroup")}):o.length===0?e.jsx(F,{severity:"warning",children:t("hostGroups.hosts.noHostsFound")}):e.jsxs(e.Fragment,{children:[e.jsxs(i,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(r,{variant:"body2",color:"text.secondary",children:t("hostGroups.hosts.selectedCount",{count:g.length})}),e.jsx(x,{size:"small",onClick:()=>{g.length===o.length?P([]):P(o.map(n=>n.id))},children:g.length===o.length?t("hostGroups.hosts.deselectAll"):t("hostGroups.hosts.selectAll")})]}),e.jsx(Ae,{sx:{maxHeight:400,overflow:"auto"},children:d.map(n=>e.jsxs(Me,{dense:!0,sx:{border:"1px solid",borderColor:"divider",borderRadius:1,mb:1},children:[e.jsx(js,{checked:g.includes(n.id),onChange:p=>{p.target.checked?P([...g,n.id]):P(g.filter(L=>L!==n.id))}}),e.jsx(K,{sx:{mr:1,color:"primary.main"}}),e.jsx(Be,{primary:n.name,secondary:e.jsxs(je,{direction:"row",spacing:.5,sx:{mt:.5},children:[e.jsx(m,{label:n.ip,size:"small",variant:"outlined"}),e.jsx(m,{icon:n.status==="online"?e.jsx(X,{}):e.jsx(We,{}),label:n.status,size:"small",color:n.status==="online"?"success":"default"}),e.jsx(m,{label:n.deviceType,size:"small"})]})})]},n.id))}),e.jsx(me,{component:"div",count:o.length,page:le,onPageChange:(n,p)=>u(p),rowsPerPage:V,onRowsPerPageChange:n=>{Pe(parseInt(n.target.value,10)),u(0)},rowsPerPageOptions:[10,25,50],labelRowsPerPage:t("hostGroups.pagination.rowsPerPage"),labelDisplayedRows:({from:n,to:p,count:L})=>t("hostGroups.pagination.displayedRows",{from:n,to:p,count:L}),sx:{borderTop:"1px solid #e2e8f0",mt:0,width:"100%",".MuiTablePagination-toolbar":{paddingLeft:2,paddingRight:2,minHeight:"52px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},".MuiTablePagination-spacer":{flex:"1 1 auto"},".MuiTablePagination-selectLabel":{marginRight:1,marginBottom:0,fontWeight:500,fontSize:"0.875rem",color:"text.secondary",display:"flex",alignItems:"center",lineHeight:1.5},".MuiTablePagination-displayedRows":{marginBottom:0,fontWeight:500,fontSize:"0.875rem",color:"text.secondary",display:"flex",alignItems:"center",lineHeight:1.5},".MuiTablePagination-select":{fontSize:"0.875rem",marginRight:2,marginTop:0,marginBottom:0},".MuiTablePagination-actions":{marginLeft:1,display:"flex",alignItems:"center"}}})]})})()]}),e.jsxs(k,{children:[e.jsx(x,{onClick:()=>{A(!1),P([]),G(""),u(0)},children:t("hostGroups.actions.cancel")}),e.jsxs(x,{onClick:()=>{os(),G(""),u(0)},variant:"contained",disabled:g.length===0,children:[t("hostGroups.actions.add")," (",g.length,")"]})]})]}),e.jsxs(D,{open:Ke,onClose:()=>re(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(z,{children:["授权用户列表 - ",l?.name]}),e.jsx(T,{children:e.jsxs(i,{sx:{pt:2},children:[we.length===0?e.jsx(F,{severity:"info",children:"暂无用户被授权访问此分组"}):e.jsx(Ae,{children:we.map((s,o)=>e.jsxs("div",{children:[o>0&&e.jsx(fs,{}),e.jsxs(Me,{children:[e.jsx(ge,{sx:{mr:2,bgcolor:"primary.main"},children:s.username?.[0]?.toUpperCase()}),e.jsx(Be,{primary:s.username,secondary:e.jsxs(i,{children:[e.jsx(r,{variant:"caption",display:"block",children:s.email||"未设置邮箱"}),e.jsx(m,{label:s.role==="admin"?"管理员":"普通用户",size:"small",color:s.role==="admin"?"error":"default",sx:{mt:.5}}),s.status!=="active"&&e.jsx(m,{label:"已禁用",size:"small",color:"warning",sx:{mt:.5,ml:.5}})]})})]})]},s.id))}),e.jsx(i,{sx:{mt:2,p:2,bgcolor:"background.default",borderRadius:1},children:e.jsx(r,{variant:"body2",color:"text.secondary",children:'提示：在"用户管理"页面可以为用户分配分组权限'})})]})}),e.jsx(k,{children:e.jsx(x,{onClick:()=>re(!1),children:"关闭"})})]}),e.jsxs(D,{open:Xe,onClose:()=>Q(!1),children:[e.jsx(z,{children:t("hostGroups.dialog.delete")}),e.jsxs(T,{children:[e.jsx(r,{children:t("hostGroups.dialog.deleteConfirm",{name:l?.name})}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mt:1},children:t("hostGroups.dialog.deleteNote")})]}),e.jsxs(k,{children:[e.jsx(x,{onClick:()=>Q(!1),children:t("hostGroups.actions.cancel")}),e.jsx(x,{onClick:ts,color:"error",variant:"contained",children:t("hostGroups.actions.confirmDelete")})]})]})]})}export{Ss as default};

import{b6 as Rn,r as D,j as c,B as Q,T as F,w as Qs,x as Js,D as $t,d as hn,I as pn,cR as lo,cD as uo,cz as ea,i as ta,k as na,l as oa,p as ra,a as Fe,bg as ia,ax as sa,b2 as aa,bf as fo,C as ca,b as ot,aA as la,a3 as ua,a4 as Nt,bj as da,dw as fa,cH as ha,dG as pa,P as rt}from"./index-DNdAKB9f.js";import{t as ga}from"./ticketApi-DZP3lA1o.js";import{a as Pe,b as ho,c as ma,d as po,i as gn,u as ya}from"./value-DEjY8fVb.js";import{C as he}from"./Chip-B8lB6W_F.js";import{G as ue}from"./GridLegacy-Bg8nSEpP.js";import{j as xa,F as wa,k as va,b5 as _a,b6 as ba,b2 as Sn,aY as go,a_ as Sa,aT as Ea,b4 as Ca,aX as Ot,aU as ja,u as Le,aW as Na,b3 as ka,aV as Ma,b1 as Ia}from"./index-BxWjY_ZV.js";import{T as it,a as st,b as at,c as xe,d as Z,e as ct}from"./TableRow-2FuGKbnY.js";import"./typeof-QjJsDpFa.js";var mo=180/Math.PI,En={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function gr(e,t,n,o,r,s){var i,a,l;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(l=e*n+t*o)&&(n-=e*l,o-=t*l),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,l/=a),e*o<t*n&&(e=-e,t=-t,l=-l,i=-i),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*mo,skewX:Math.atan(l)*mo,scaleX:i,scaleY:a}}var kt;function za(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?En:gr(t.a,t.b,t.c,t.d,t.e,t.f)}function Pa(e){return e==null||(kt||(kt=document.createElementNS("http://www.w3.org/2000/svg","g")),kt.setAttribute("transform",e),!(e=kt.transform.baseVal.consolidate()))?En:(e=e.matrix,gr(e.a,e.b,e.c,e.d,e.e,e.f))}function mr(e,t,n,o){function r(u){return u.length?u.pop()+" ":""}function s(u,h,d,f,y,p){if(u!==d||h!==f){var x=y.push("translate(",null,t,null,n);p.push({i:x-4,x:Pe(u,d)},{i:x-2,x:Pe(h,f)})}else(d||f)&&y.push("translate("+d+t+f+n)}function i(u,h,d,f){u!==h?(u-h>180?h+=360:h-u>180&&(u+=360),f.push({i:d.push(r(d)+"rotate(",null,o)-2,x:Pe(u,h)})):h&&d.push(r(d)+"rotate("+h+o)}function a(u,h,d,f){u!==h?f.push({i:d.push(r(d)+"skewX(",null,o)-2,x:Pe(u,h)}):h&&d.push(r(d)+"skewX("+h+o)}function l(u,h,d,f,y,p){if(u!==d||h!==f){var x=y.push(r(y)+"scale(",null,",",null,")");p.push({i:x-4,x:Pe(u,d)},{i:x-2,x:Pe(h,f)})}else(d!==1||f!==1)&&y.push(r(y)+"scale("+d+","+f+")")}return function(u,h){var d=[],f=[];return u=e(u),h=e(h),s(u.translateX,u.translateY,h.translateX,h.translateY,d,f),i(u.rotate,h.rotate,d,f),a(u.skewX,h.skewX,d,f),l(u.scaleX,u.scaleY,h.scaleX,h.scaleY,d,f),u=h=null,function(y){for(var p=-1,x=f.length,w;++p<x;)d[(w=f[p]).i]=w.x(y);return d.join("")}}}var Aa=mr(za,"px, ","px)","deg)"),Da=mr(Pa,", ",")",")"),Ta=1e-12;function yo(e){return((e=Math.exp(e))+1/e)/2}function $a(e){return((e=Math.exp(e))-1/e)/2}function Ra(e){return((e=Math.exp(2*e))-1)/(e+1)}const Rt=(function e(t,n,o){function r(s,i){var a=s[0],l=s[1],u=s[2],h=i[0],d=i[1],f=i[2],y=h-a,p=d-l,x=y*y+p*p,w,m;if(x<Ta)m=Math.log(f/u)/t,w=function(j){return[a+j*y,l+j*p,u*Math.exp(t*j*m)]};else{var b=Math.sqrt(x),g=(f*f-u*u+o*x)/(2*u*n*b),v=(f*f-u*u-o*x)/(2*f*n*b),C=Math.log(Math.sqrt(g*g+1)-g),S=Math.log(Math.sqrt(v*v+1)-v);m=(S-C)/t,w=function(j){var A=j*m,P=yo(C),V=u/(n*b)*(P*Ra(t*A+C)-$a(C));return[a+V*y,l+V*p,u*P/yo(t*A+C)]}}return w.duration=m*1e3*t/Math.SQRT2,w}return r.rho=function(s){var i=Math.max(.001,+s),a=i*i,l=a*a;return e(i,a,l)},r})(Math.SQRT2,2,4);function ce(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=ce(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var La={value:()=>{}};function Kt(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Lt(n)}function Lt(e){this._=e}function Ha(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Lt.prototype=Kt.prototype={constructor:Lt,on:function(e,t){var n=this._,o=Ha(e+"",n),r,s=-1,i=o.length;if(arguments.length<2){for(;++s<i;)if((r=(e=o[s]).type)&&(r=Va(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(r=(e=o[s]).type)n[r]=xo(n[r],e.name,t);else if(t==null)for(r in n)n[r]=xo(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Lt(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,s;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],o=0,r=s.length;o<r;++o)s[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,s=o.length;r<s;++r)o[r].value.apply(t,n)}};function Va(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function xo(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=La,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var Cn="http://www.w3.org/1999/xhtml";const wo={svg:"http://www.w3.org/2000/svg",xhtml:Cn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),wo.hasOwnProperty(t)?{space:wo[t],local:e}:e}function Ba(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Cn&&t.documentElement.namespaceURI===Cn?t.createElement(e):t.createElementNS(n,e)}}function Oa(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function yr(e){var t=Qt(e);return(t.local?Oa:Ba)(t)}function Fa(){}function Ln(e){return e==null?Fa:function(){return this.querySelector(e)}}function Wa(e){typeof e!="function"&&(e=Ln(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var s=t[r],i=s.length,a=o[r]=new Array(i),l,u,h=0;h<i;++h)(l=s[h])&&(u=e.call(l,l.__data__,h,s))&&("__data__"in l&&(u.__data__=l.__data__),a[h]=u);return new fe(o,this._parents)}function Xa(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ya(){return[]}function xr(e){return e==null?Ya:function(){return this.querySelectorAll(e)}}function Za(e){return function(){return Xa(e.apply(this,arguments))}}function Ga(e){typeof e=="function"?e=Za(e):e=xr(e);for(var t=this._groups,n=t.length,o=[],r=[],s=0;s<n;++s)for(var i=t[s],a=i.length,l,u=0;u<a;++u)(l=i[u])&&(o.push(e.call(l,l.__data__,u,i)),r.push(l));return new fe(o,r)}function wr(e){return function(){return this.matches(e)}}function vr(e){return function(t){return t.matches(e)}}var qa=Array.prototype.find;function Ua(e){return function(){return qa.call(this.children,e)}}function Ka(){return this.firstElementChild}function Qa(e){return this.select(e==null?Ka:Ua(typeof e=="function"?e:vr(e)))}var Ja=Array.prototype.filter;function ec(){return Array.from(this.children)}function tc(e){return function(){return Ja.call(this.children,e)}}function nc(e){return this.selectAll(e==null?ec:tc(typeof e=="function"?e:vr(e)))}function oc(e){typeof e!="function"&&(e=wr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var s=t[r],i=s.length,a=o[r]=[],l,u=0;u<i;++u)(l=s[u])&&e.call(l,l.__data__,u,s)&&a.push(l);return new fe(o,this._parents)}function _r(e){return new Array(e.length)}function rc(){return new fe(this._enter||this._groups.map(_r),this._parents)}function Ft(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ft.prototype={constructor:Ft,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ic(e){return function(){return e}}function sc(e,t,n,o,r,s){for(var i=0,a,l=t.length,u=s.length;i<u;++i)(a=t[i])?(a.__data__=s[i],o[i]=a):n[i]=new Ft(e,s[i]);for(;i<l;++i)(a=t[i])&&(r[i]=a)}function ac(e,t,n,o,r,s,i){var a,l,u=new Map,h=t.length,d=s.length,f=new Array(h),y;for(a=0;a<h;++a)(l=t[a])&&(f[a]=y=i.call(l,l.__data__,a,t)+"",u.has(y)?r[a]=l:u.set(y,l));for(a=0;a<d;++a)y=i.call(e,s[a],a,s)+"",(l=u.get(y))?(o[a]=l,l.__data__=s[a],u.delete(y)):n[a]=new Ft(e,s[a]);for(a=0;a<h;++a)(l=t[a])&&u.get(f[a])===l&&(r[a]=l)}function cc(e){return e.__data__}function lc(e,t){if(!arguments.length)return Array.from(this,cc);var n=t?ac:sc,o=this._parents,r=this._groups;typeof e!="function"&&(e=ic(e));for(var s=r.length,i=new Array(s),a=new Array(s),l=new Array(s),u=0;u<s;++u){var h=o[u],d=r[u],f=d.length,y=uc(e.call(h,h&&h.__data__,u,o)),p=y.length,x=a[u]=new Array(p),w=i[u]=new Array(p),m=l[u]=new Array(f);n(h,d,x,w,m,y,t);for(var b=0,g=0,v,C;b<p;++b)if(v=x[b]){for(b>=g&&(g=b+1);!(C=w[g])&&++g<p;);v._next=C||null}}return i=new fe(i,o),i._enter=a,i._exit=l,i}function uc(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dc(){return new fe(this._exit||this._groups.map(_r),this._parents)}function fc(e,t,n){var o=this.enter(),r=this,s=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?s.remove():n(s),o&&r?o.merge(r).order():r}function hc(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,s=o.length,i=Math.min(r,s),a=new Array(r),l=0;l<i;++l)for(var u=n[l],h=o[l],d=u.length,f=a[l]=new Array(d),y,p=0;p<d;++p)(y=u[p]||h[p])&&(f[p]=y);for(;l<r;++l)a[l]=n[l];return new fe(a,this._parents)}function pc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,s=o[r],i;--r>=0;)(i=o[r])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function gc(e){e||(e=mc);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,o=n.length,r=new Array(o),s=0;s<o;++s){for(var i=n[s],a=i.length,l=r[s]=new Array(a),u,h=0;h<a;++h)(u=i[h])&&(l[h]=u);l.sort(t)}return new fe(r,this._parents).order()}function mc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function yc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function xc(){return Array.from(this)}function wc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,s=o.length;r<s;++r){var i=o[r];if(i)return i}return null}function vc(){let e=0;for(const t of this)++e;return e}function _c(){return!this.node()}function bc(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],s=0,i=r.length,a;s<i;++s)(a=r[s])&&e.call(a,a.__data__,s,r);return this}function Sc(e){return function(){this.removeAttribute(e)}}function Ec(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Cc(e,t){return function(){this.setAttribute(e,t)}}function jc(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Nc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function kc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Mc(e,t){var n=Qt(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?Ec:Sc:typeof t=="function"?n.local?kc:Nc:n.local?jc:Cc)(n,t))}function br(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ic(e){return function(){this.style.removeProperty(e)}}function zc(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Pc(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function Ac(e,t,n){return arguments.length>1?this.each((t==null?Ic:typeof t=="function"?Pc:zc)(e,t,n??"")):Xe(this.node(),e)}function Xe(e,t){return e.style.getPropertyValue(t)||br(e).getComputedStyle(e,null).getPropertyValue(t)}function Dc(e){return function(){delete this[e]}}function Tc(e,t){return function(){this[e]=t}}function $c(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Rc(e,t){return arguments.length>1?this.each((t==null?Dc:typeof t=="function"?$c:Tc)(e,t)):this.node()[e]}function Sr(e){return e.trim().split(/^|\s+/)}function Hn(e){return e.classList||new Er(e)}function Er(e){this._node=e,this._names=Sr(e.getAttribute("class")||"")}Er.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Cr(e,t){for(var n=Hn(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function jr(e,t){for(var n=Hn(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function Lc(e){return function(){Cr(this,e)}}function Hc(e){return function(){jr(this,e)}}function Vc(e,t){return function(){(t.apply(this,arguments)?Cr:jr)(this,e)}}function Bc(e,t){var n=Sr(e+"");if(arguments.length<2){for(var o=Hn(this.node()),r=-1,s=n.length;++r<s;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?Vc:t?Lc:Hc)(n,t))}function Oc(){this.textContent=""}function Fc(e){return function(){this.textContent=e}}function Wc(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Xc(e){return arguments.length?this.each(e==null?Oc:(typeof e=="function"?Wc:Fc)(e)):this.node().textContent}function Yc(){this.innerHTML=""}function Zc(e){return function(){this.innerHTML=e}}function Gc(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function qc(e){return arguments.length?this.each(e==null?Yc:(typeof e=="function"?Gc:Zc)(e)):this.node().innerHTML}function Uc(){this.nextSibling&&this.parentNode.appendChild(this)}function Kc(){return this.each(Uc)}function Qc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Jc(){return this.each(Qc)}function el(e){var t=typeof e=="function"?e:yr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function tl(){return null}function nl(e,t){var n=typeof e=="function"?e:yr(e),o=t==null?tl:typeof t=="function"?t:Ln(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function ol(){var e=this.parentNode;e&&e.removeChild(this)}function rl(){return this.each(ol)}function il(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function sl(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function al(e){return this.select(e?sl:il)}function cl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ll(e){return function(t){e.call(this,t,this.__data__)}}function ul(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function dl(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,s;n<r;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++o]=s;++o?t.length=o:delete this.__on}}}function fl(e,t,n){return function(){var o=this.__on,r,s=ll(t);if(o){for(var i=0,a=o.length;i<a;++i)if((r=o[i]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=t;return}}this.addEventListener(e.type,s,n),r={type:e.type,name:e.name,value:t,listener:s,options:n},o?o.push(r):this.__on=[r]}}function hl(e,t,n){var o=ul(e+""),r,s=o.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,h;l<u;++l)for(r=0,h=a[l];r<s;++r)if((i=o[r]).type===h.type&&i.name===h.name)return h.value}return}for(a=t?fl:dl,r=0;r<s;++r)this.each(a(o[r],t,n));return this}function Nr(e,t,n){var o=br(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function pl(e,t){return function(){return Nr(this,e,t)}}function gl(e,t){return function(){return Nr(this,e,t.apply(this,arguments))}}function ml(e,t){return this.each((typeof t=="function"?gl:pl)(e,t))}function*yl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,s=o.length,i;r<s;++r)(i=o[r])&&(yield i)}var kr=[null];function fe(e,t){this._groups=e,this._parents=t}function _t(){return new fe([[document.documentElement]],kr)}function xl(){return this}fe.prototype=_t.prototype={constructor:fe,select:Wa,selectAll:Ga,selectChild:Qa,selectChildren:nc,filter:oc,data:lc,enter:rc,exit:dc,join:fc,merge:hc,selection:xl,order:pc,sort:gc,call:yc,nodes:xc,node:wc,size:vc,empty:_c,each:bc,attr:Mc,style:Ac,property:Rc,classed:Bc,text:Xc,html:qc,raise:Kc,lower:Jc,append:el,insert:nl,remove:rl,clone:al,datum:cl,on:hl,dispatch:ml,[Symbol.iterator]:yl};function de(e){return typeof e=="string"?new fe([[document.querySelector(e)]],[document.documentElement]):new fe([[e]],kr)}function wl(e){let t;for(;t=e.sourceEvent;)e=t;return e}function pe(e,t){if(e=wl(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const vl={passive:!1},pt={capture:!0,passive:!1};function mn(e){e.stopImmediatePropagation()}function We(e){e.preventDefault(),e.stopImmediatePropagation()}function Mr(e){var t=e.document.documentElement,n=de(e).on("dragstart.drag",We,pt);"onselectstart"in t?n.on("selectstart.drag",We,pt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Ir(e,t){var n=e.document.documentElement,o=de(e).on("dragstart.drag",null);t&&(o.on("click.drag",We,pt),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Mt=e=>()=>e;function jn(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:s,x:i,y:a,dx:l,dy:u,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:h}})}jn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function _l(e){return!e.ctrlKey&&!e.button}function bl(){return this.parentNode}function Sl(e,t){return t??{x:e.x,y:e.y}}function El(){return navigator.maxTouchPoints||"ontouchstart"in this}function zr(){var e=_l,t=bl,n=Sl,o=El,r={},s=Kt("start","drag","end"),i=0,a,l,u,h,d=0;function f(v){v.on("mousedown.drag",y).filter(o).on("touchstart.drag",w).on("touchmove.drag",m,vl).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(v,C){if(!(h||!e.call(this,v,C))){var S=g(this,t.call(this,v,C),v,C,"mouse");S&&(de(v.view).on("mousemove.drag",p,pt).on("mouseup.drag",x,pt),Mr(v.view),mn(v),u=!1,a=v.clientX,l=v.clientY,S("start",v))}}function p(v){if(We(v),!u){var C=v.clientX-a,S=v.clientY-l;u=C*C+S*S>d}r.mouse("drag",v)}function x(v){de(v.view).on("mousemove.drag mouseup.drag",null),Ir(v.view,u),We(v),r.mouse("end",v)}function w(v,C){if(e.call(this,v,C)){var S=v.changedTouches,j=t.call(this,v,C),A=S.length,P,V;for(P=0;P<A;++P)(V=g(this,j,v,C,S[P].identifier,S[P]))&&(mn(v),V("start",v,S[P]))}}function m(v){var C=v.changedTouches,S=C.length,j,A;for(j=0;j<S;++j)(A=r[C[j].identifier])&&(We(v),A("drag",v,C[j]))}function b(v){var C=v.changedTouches,S=C.length,j,A;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),j=0;j<S;++j)(A=r[C[j].identifier])&&(mn(v),A("end",v,C[j]))}function g(v,C,S,j,A,P){var V=s.copy(),I=pe(P||S,C),T,R,_;if((_=n.call(v,new jn("beforestart",{sourceEvent:S,target:f,identifier:A,active:i,x:I[0],y:I[1],dx:0,dy:0,dispatch:V}),j))!=null)return T=_.x-I[0]||0,R=_.y-I[1]||0,function N(E,M,k){var z=I,$;switch(E){case"start":r[A]=N,$=i++;break;case"end":delete r[A],--i;case"drag":I=pe(k||M,C),$=i;break}V.call(E,v,new jn(E,{sourceEvent:M,subject:_,target:f,identifier:A,active:$,x:I[0]+T,y:I[1]+R,dx:I[0]-z[0],dy:I[1]-z[1],dispatch:V}),j)}}return f.filter=function(v){return arguments.length?(e=typeof v=="function"?v:Mt(!!v),f):e},f.container=function(v){return arguments.length?(t=typeof v=="function"?v:Mt(v),f):t},f.subject=function(v){return arguments.length?(n=typeof v=="function"?v:Mt(v),f):n},f.touchable=function(v){return arguments.length?(o=typeof v=="function"?v:Mt(!!v),f):o},f.on=function(){var v=s.on.apply(s,arguments);return v===s?f:v},f.clickDistance=function(v){return arguments.length?(d=(v=+v)*v,f):Math.sqrt(d)},f}var Ye=0,dt=0,lt=0,Pr=1e3,Wt,ft,Xt=0,Te=0,Jt=0,gt=typeof performance=="object"&&performance.now?performance:Date,Ar=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Vn(){return Te||(Ar(Cl),Te=gt.now()+Jt)}function Cl(){Te=0}function Yt(){this._call=this._time=this._next=null}Yt.prototype=Dr.prototype={constructor:Yt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Vn():+n)+(t==null?0:+t),!this._next&&ft!==this&&(ft?ft._next=this:Wt=this,ft=this),this._call=e,this._time=n,Nn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nn())}};function Dr(e,t,n){var o=new Yt;return o.restart(e,t,n),o}function jl(){Vn(),++Ye;for(var e=Wt,t;e;)(t=Te-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ye}function vo(){Te=(Xt=gt.now())+Jt,Ye=dt=0;try{jl()}finally{Ye=0,kl(),Te=0}}function Nl(){var e=gt.now(),t=e-Xt;t>Pr&&(Jt-=t,Xt=e)}function kl(){for(var e,t=Wt,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Wt=n);ft=e,Nn(o)}function Nn(e){if(!Ye){dt&&(dt=clearTimeout(dt));var t=e-Te;t>24?(e<1/0&&(dt=setTimeout(vo,e-gt.now()-Jt)),lt&&(lt=clearInterval(lt))):(lt||(Xt=gt.now(),lt=setInterval(Nl,Pr)),Ye=1,Ar(vo))}}function _o(e,t,n){var o=new Yt;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var Ml=Kt("start","end","cancel","interrupt"),Il=[],Tr=0,bo=1,kn=2,Ht=3,So=4,Mn=5,Vt=6;function en(e,t,n,o,r,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;zl(e,n,{name:t,index:o,group:r,on:Ml,tween:Il,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Tr})}function Bn(e,t){var n=ye(e,t);if(n.state>Tr)throw new Error("too late; already scheduled");return n}function ve(e,t){var n=ye(e,t);if(n.state>Ht)throw new Error("too late; already running");return n}function ye(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function zl(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=Dr(s,0,n.time);function s(u){n.state=bo,n.timer.restart(i,n.delay,n.time),n.delay<=u&&i(u-n.delay)}function i(u){var h,d,f,y;if(n.state!==bo)return l();for(h in o)if(y=o[h],y.name===n.name){if(y.state===Ht)return _o(i);y.state===So?(y.state=Vt,y.timer.stop(),y.on.call("interrupt",e,e.__data__,y.index,y.group),delete o[h]):+h<t&&(y.state=Vt,y.timer.stop(),y.on.call("cancel",e,e.__data__,y.index,y.group),delete o[h])}if(_o(function(){n.state===Ht&&(n.state=So,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=kn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===kn){for(n.state=Ht,r=new Array(f=n.tween.length),h=0,d=-1;h<f;++h)(y=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(r[++d]=y);r.length=d+1}}function a(u){for(var h=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=Mn,1),d=-1,f=r.length;++d<f;)r[d].call(e,h);n.state===Mn&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Vt,n.timer.stop(),delete o[t];for(var u in o)return;delete e.__transition}}function Bt(e,t){var n=e.__transition,o,r,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((o=n[i]).name!==t){s=!1;continue}r=o.state>kn&&o.state<Mn,o.state=Vt,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[i]}s&&delete e.__transition}}function Pl(e){return this.each(function(){Bt(this,e)})}function Al(e,t){var n,o;return function(){var r=ve(this,e),s=r.tween;if(s!==n){o=n=s;for(var i=0,a=o.length;i<a;++i)if(o[i].name===t){o=o.slice(),o.splice(i,1);break}}r.tween=o}}function Dl(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var s=ve(this,e),i=s.tween;if(i!==o){r=(o=i).slice();for(var a={name:t,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===t){r[l]=a;break}l===u&&r.push(a)}s.tween=r}}function Tl(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=ye(this.node(),n).tween,r=0,s=o.length,i;r<s;++r)if((i=o[r]).name===e)return i.value;return null}return this.each((t==null?Al:Dl)(n,e,t))}function On(e,t,n){var o=e._id;return e.each(function(){var r=ve(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return ye(r,o).value[t]}}function $r(e,t){var n;return(typeof t=="number"?Pe:t instanceof po?ho:(n=po(t))?(t=n,ho):ma)(e,t)}function $l(e){return function(){this.removeAttribute(e)}}function Rl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ll(e,t,n){var o,r=n+"",s;return function(){var i=this.getAttribute(e);return i===r?null:i===o?s:s=t(o=i,n)}}function Hl(e,t,n){var o,r=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===r?null:i===o?s:s=t(o=i,n)}}function Vl(e,t,n){var o,r,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),l=a+"",i===l?null:i===o&&l===r?s:(r=l,s=t(o=i,a)))}}function Bl(e,t,n){var o,r,s;return function(){var i,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),l=a+"",i===l?null:i===o&&l===r?s:(r=l,s=t(o=i,a)))}}function Ol(e,t){var n=Qt(e),o=n==="transform"?Da:$r;return this.attrTween(e,typeof t=="function"?(n.local?Bl:Vl)(n,o,On(this,"attr."+e,t)):t==null?(n.local?Rl:$l)(n):(n.local?Hl:Ll)(n,o,t))}function Fl(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Wl(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Xl(e,t){var n,o;function r(){var s=t.apply(this,arguments);return s!==o&&(n=(o=s)&&Wl(e,s)),n}return r._value=t,r}function Yl(e,t){var n,o;function r(){var s=t.apply(this,arguments);return s!==o&&(n=(o=s)&&Fl(e,s)),n}return r._value=t,r}function Zl(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=Qt(e);return this.tween(n,(o.local?Xl:Yl)(o,t))}function Gl(e,t){return function(){Bn(this,e).delay=+t.apply(this,arguments)}}function ql(e,t){return t=+t,function(){Bn(this,e).delay=t}}function Ul(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Gl:ql)(t,e)):ye(this.node(),t).delay}function Kl(e,t){return function(){ve(this,e).duration=+t.apply(this,arguments)}}function Ql(e,t){return t=+t,function(){ve(this,e).duration=t}}function Jl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Kl:Ql)(t,e)):ye(this.node(),t).duration}function eu(e,t){if(typeof t!="function")throw new Error;return function(){ve(this,e).ease=t}}function tu(e){var t=this._id;return arguments.length?this.each(eu(t,e)):ye(this.node(),t).ease}function nu(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ve(this,e).ease=n}}function ou(e){if(typeof e!="function")throw new Error;return this.each(nu(this._id,e))}function ru(e){typeof e!="function"&&(e=wr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var s=t[r],i=s.length,a=o[r]=[],l,u=0;u<i;++u)(l=s[u])&&e.call(l,l.__data__,u,s)&&a.push(l);return new Ee(o,this._parents,this._name,this._id)}function iu(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,s=Math.min(o,r),i=new Array(o),a=0;a<s;++a)for(var l=t[a],u=n[a],h=l.length,d=i[a]=new Array(h),f,y=0;y<h;++y)(f=l[y]||u[y])&&(d[y]=f);for(;a<o;++a)i[a]=t[a];return new Ee(i,this._parents,this._name,this._id)}function su(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function au(e,t,n){var o,r,s=su(t)?Bn:ve;return function(){var i=s(this,e),a=i.on;a!==o&&(r=(o=a).copy()).on(t,n),i.on=r}}function cu(e,t){var n=this._id;return arguments.length<2?ye(this.node(),n).on.on(e):this.each(au(n,e,t))}function lu(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function uu(){return this.on("end.remove",lu(this._id))}function du(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ln(e));for(var o=this._groups,r=o.length,s=new Array(r),i=0;i<r;++i)for(var a=o[i],l=a.length,u=s[i]=new Array(l),h,d,f=0;f<l;++f)(h=a[f])&&(d=e.call(h,h.__data__,f,a))&&("__data__"in h&&(d.__data__=h.__data__),u[f]=d,en(u[f],t,n,f,u,ye(h,n)));return new Ee(s,this._parents,t,n)}function fu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=xr(e));for(var o=this._groups,r=o.length,s=[],i=[],a=0;a<r;++a)for(var l=o[a],u=l.length,h,d=0;d<u;++d)if(h=l[d]){for(var f=e.call(h,h.__data__,d,l),y,p=ye(h,n),x=0,w=f.length;x<w;++x)(y=f[x])&&en(y,t,n,x,f,p);s.push(f),i.push(h)}return new Ee(s,i,t,n)}var hu=_t.prototype.constructor;function pu(){return new hu(this._groups,this._parents)}function gu(e,t){var n,o,r;return function(){var s=Xe(this,e),i=(this.style.removeProperty(e),Xe(this,e));return s===i?null:s===n&&i===o?r:r=t(n=s,o=i)}}function Rr(e){return function(){this.style.removeProperty(e)}}function mu(e,t,n){var o,r=n+"",s;return function(){var i=Xe(this,e);return i===r?null:i===o?s:s=t(o=i,n)}}function yu(e,t,n){var o,r,s;return function(){var i=Xe(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),Xe(this,e))),i===l?null:i===o&&l===r?s:(r=l,s=t(o=i,a))}}function xu(e,t){var n,o,r,s="style."+t,i="end."+s,a;return function(){var l=ve(this,e),u=l.on,h=l.value[s]==null?a||(a=Rr(t)):void 0;(u!==n||r!==h)&&(o=(n=u).copy()).on(i,r=h),l.on=o}}function wu(e,t,n){var o=(e+="")=="transform"?Aa:$r;return t==null?this.styleTween(e,gu(e,o)).on("end.style."+e,Rr(e)):typeof t=="function"?this.styleTween(e,yu(e,o,On(this,"style."+e,t))).each(xu(this._id,e)):this.styleTween(e,mu(e,o,t),n).on("end.style."+e,null)}function vu(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function _u(e,t,n){var o,r;function s(){var i=t.apply(this,arguments);return i!==r&&(o=(r=i)&&vu(e,i,n)),o}return s._value=t,s}function bu(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,_u(e,t,n??""))}function Su(e){return function(){this.textContent=e}}function Eu(e){return function(){var t=e(this);this.textContent=t??""}}function Cu(e){return this.tween("text",typeof e=="function"?Eu(On(this,"text",e)):Su(e==null?"":e+""))}function ju(e){return function(t){this.textContent=e.call(this,t)}}function Nu(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&ju(r)),t}return o._value=e,o}function ku(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Nu(e))}function Mu(){for(var e=this._name,t=this._id,n=Lr(),o=this._groups,r=o.length,s=0;s<r;++s)for(var i=o[s],a=i.length,l,u=0;u<a;++u)if(l=i[u]){var h=ye(l,t);en(l,e,n,u,i,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Ee(o,this._parents,e,n)}function Iu(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(s,i){var a={value:i},l={value:function(){--r===0&&s()}};n.each(function(){var u=ve(this,o),h=u.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),u.on=t}),r===0&&s()})}var zu=0;function Ee(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function Lr(){return++zu}var be=_t.prototype;Ee.prototype={constructor:Ee,select:du,selectAll:fu,selectChild:be.selectChild,selectChildren:be.selectChildren,filter:ru,merge:iu,selection:pu,transition:Mu,call:be.call,nodes:be.nodes,node:be.node,size:be.size,empty:be.empty,each:be.each,on:cu,attr:Ol,attrTween:Zl,style:wu,styleTween:bu,text:Cu,textTween:ku,remove:uu,tween:Tl,delay:Ul,duration:Jl,ease:tu,easeVarying:ou,end:Iu,[Symbol.iterator]:be[Symbol.iterator]};function Pu(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Au={time:null,delay:0,duration:250,ease:Pu};function Du(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Tu(e){var t,n;e instanceof Ee?(t=e._id,e=e._name):(t=Lr(),(n=Au).time=Vn(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,s=0;s<r;++s)for(var i=o[s],a=i.length,l,u=0;u<a;++u)(l=i[u])&&en(l,e,t,u,i,n||Du(l,t));return new Ee(o,this._parents,e,t)}_t.prototype.interrupt=Pl;_t.prototype.transition=Tu;const It=e=>()=>e;function $u(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function Se(e,t,n){this.k=e,this.x=t,this.y=n}Se.prototype={constructor:Se,scale:function(e){return e===1?this:new Se(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Se(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tn=new Se(1,0,0);Hr.prototype=Se.prototype;function Hr(e){for(;!e.__zoom;)if(!(e=e.parentNode))return tn;return e.__zoom}function yn(e){e.stopImmediatePropagation()}function ut(e){e.preventDefault(),e.stopImmediatePropagation()}function Ru(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Lu(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Eo(){return this.__zoom||tn}function Hu(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Vu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Bu(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function Vr(){var e=Ru,t=Lu,n=Bu,o=Hu,r=Vu,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,l=Rt,u=Kt("start","zoom","end"),h,d,f,y=500,p=150,x=0,w=10;function m(_){_.property("__zoom",Eo).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",V).filter(r).on("touchstart.zoom",I).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(_,N,E,M){var k=_.selection?_.selection():_;k.property("__zoom",Eo),_!==k?C(_,N,E,M):k.interrupt().each(function(){S(this,arguments).event(M).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},m.scaleBy=function(_,N,E,M){m.scaleTo(_,function(){var k=this.__zoom.k,z=typeof N=="function"?N.apply(this,arguments):N;return k*z},E,M)},m.scaleTo=function(_,N,E,M){m.transform(_,function(){var k=t.apply(this,arguments),z=this.__zoom,$=E==null?v(k):typeof E=="function"?E.apply(this,arguments):E,H=z.invert($),L=typeof N=="function"?N.apply(this,arguments):N;return n(g(b(z,L),$,H),k,i)},E,M)},m.translateBy=function(_,N,E,M){m.transform(_,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof E=="function"?E.apply(this,arguments):E),t.apply(this,arguments),i)},null,M)},m.translateTo=function(_,N,E,M,k){m.transform(_,function(){var z=t.apply(this,arguments),$=this.__zoom,H=M==null?v(z):typeof M=="function"?M.apply(this,arguments):M;return n(tn.translate(H[0],H[1]).scale($.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof E=="function"?-E.apply(this,arguments):-E),z,i)},M,k)};function b(_,N){return N=Math.max(s[0],Math.min(s[1],N)),N===_.k?_:new Se(N,_.x,_.y)}function g(_,N,E){var M=N[0]-E[0]*_.k,k=N[1]-E[1]*_.k;return M===_.x&&k===_.y?_:new Se(_.k,M,k)}function v(_){return[(+_[0][0]+ +_[1][0])/2,(+_[0][1]+ +_[1][1])/2]}function C(_,N,E,M){_.on("start.zoom",function(){S(this,arguments).event(M).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(M).end()}).tween("zoom",function(){var k=this,z=arguments,$=S(k,z).event(M),H=t.apply(k,z),L=E==null?v(H):typeof E=="function"?E.apply(k,z):E,W=Math.max(H[1][0]-H[0][0],H[1][1]-H[0][1]),O=k.__zoom,q=typeof N=="function"?N.apply(k,z):N,J=l(O.invert(L).concat(W/O.k),q.invert(L).concat(W/q.k));return function(G){if(G===1)G=q;else{var B=J(G),Y=W/B[2];G=new Se(Y,L[0]-B[0]*Y,L[1]-B[1]*Y)}$.zoom(null,G)}})}function S(_,N,E){return!E&&_.__zooming||new j(_,N)}function j(_,N){this.that=_,this.args=N,this.active=0,this.sourceEvent=null,this.extent=t.apply(_,N),this.taps=0}j.prototype={event:function(_){return _&&(this.sourceEvent=_),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(_,N){return this.mouse&&_!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&_!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&_!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(_){var N=de(this.that).datum();u.call(_,this.that,new $u(_,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:u}),N)}};function A(_,...N){if(!e.apply(this,arguments))return;var E=S(this,N).event(_),M=this.__zoom,k=Math.max(s[0],Math.min(s[1],M.k*Math.pow(2,o.apply(this,arguments)))),z=pe(_);if(E.wheel)(E.mouse[0][0]!==z[0]||E.mouse[0][1]!==z[1])&&(E.mouse[1]=M.invert(E.mouse[0]=z)),clearTimeout(E.wheel);else{if(M.k===k)return;E.mouse=[z,M.invert(z)],Bt(this),E.start()}ut(_),E.wheel=setTimeout($,p),E.zoom("mouse",n(g(b(M,k),E.mouse[0],E.mouse[1]),E.extent,i));function $(){E.wheel=null,E.end()}}function P(_,...N){if(f||!e.apply(this,arguments))return;var E=_.currentTarget,M=S(this,N,!0).event(_),k=de(_.view).on("mousemove.zoom",L,!0).on("mouseup.zoom",W,!0),z=pe(_,E),$=_.clientX,H=_.clientY;Mr(_.view),yn(_),M.mouse=[z,this.__zoom.invert(z)],Bt(this),M.start();function L(O){if(ut(O),!M.moved){var q=O.clientX-$,J=O.clientY-H;M.moved=q*q+J*J>x}M.event(O).zoom("mouse",n(g(M.that.__zoom,M.mouse[0]=pe(O,E),M.mouse[1]),M.extent,i))}function W(O){k.on("mousemove.zoom mouseup.zoom",null),Ir(O.view,M.moved),ut(O),M.event(O).end()}}function V(_,...N){if(e.apply(this,arguments)){var E=this.__zoom,M=pe(_.changedTouches?_.changedTouches[0]:_,this),k=E.invert(M),z=E.k*(_.shiftKey?.5:2),$=n(g(b(E,z),M,k),t.apply(this,N),i);ut(_),a>0?de(this).transition().duration(a).call(C,$,M,_):de(this).call(m.transform,$,M,_)}}function I(_,...N){if(e.apply(this,arguments)){var E=_.touches,M=E.length,k=S(this,N,_.changedTouches.length===M).event(_),z,$,H,L;for(yn(_),$=0;$<M;++$)H=E[$],L=pe(H,this),L=[L,this.__zoom.invert(L),H.identifier],k.touch0?!k.touch1&&k.touch0[2]!==L[2]&&(k.touch1=L,k.taps=0):(k.touch0=L,z=!0,k.taps=1+!!h);h&&(h=clearTimeout(h)),z&&(k.taps<2&&(d=L[0],h=setTimeout(function(){h=null},y)),Bt(this),k.start())}}function T(_,...N){if(this.__zooming){var E=S(this,N).event(_),M=_.changedTouches,k=M.length,z,$,H,L;for(ut(_),z=0;z<k;++z)$=M[z],H=pe($,this),E.touch0&&E.touch0[2]===$.identifier?E.touch0[0]=H:E.touch1&&E.touch1[2]===$.identifier&&(E.touch1[0]=H);if($=E.that.__zoom,E.touch1){var W=E.touch0[0],O=E.touch0[1],q=E.touch1[0],J=E.touch1[1],G=(G=q[0]-W[0])*G+(G=q[1]-W[1])*G,B=(B=J[0]-O[0])*B+(B=J[1]-O[1])*B;$=b($,Math.sqrt(G/B)),H=[(W[0]+q[0])/2,(W[1]+q[1])/2],L=[(O[0]+J[0])/2,(O[1]+J[1])/2]}else if(E.touch0)H=E.touch0[0],L=E.touch0[1];else return;E.zoom("touch",n(g($,H,L),E.extent,i))}}function R(_,...N){if(this.__zooming){var E=S(this,N).event(_),M=_.changedTouches,k=M.length,z,$;for(yn(_),f&&clearTimeout(f),f=setTimeout(function(){f=null},y),z=0;z<k;++z)$=M[z],E.touch0&&E.touch0[2]===$.identifier?delete E.touch0:E.touch1&&E.touch1[2]===$.identifier&&delete E.touch1;if(E.touch1&&!E.touch0&&(E.touch0=E.touch1,delete E.touch1),E.touch0)E.touch0[1]=this.__zoom.invert(E.touch0[0]);else if(E.end(),E.taps===2&&($=pe($,this),Math.hypot(d[0]-$[0],d[1]-$[1])<w)){var H=de(this).on("dblclick.zoom");H&&H.apply(this,arguments)}}}return m.wheelDelta=function(_){return arguments.length?(o=typeof _=="function"?_:It(+_),m):o},m.filter=function(_){return arguments.length?(e=typeof _=="function"?_:It(!!_),m):e},m.touchable=function(_){return arguments.length?(r=typeof _=="function"?_:It(!!_),m):r},m.extent=function(_){return arguments.length?(t=typeof _=="function"?_:It([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),m):t},m.scaleExtent=function(_){return arguments.length?(s[0]=+_[0],s[1]=+_[1],m):[s[0],s[1]]},m.translateExtent=function(_){return arguments.length?(i[0][0]=+_[0][0],i[1][0]=+_[1][0],i[0][1]=+_[0][1],i[1][1]=+_[1][1],m):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},m.constrain=function(_){return arguments.length?(n=_,m):n},m.duration=function(_){return arguments.length?(a=+_,m):a},m.interpolate=function(_){return arguments.length?(l=_,m):l},m.on=function(){var _=u.on.apply(u,arguments);return _===u?m:_},m.clickDistance=function(_){return arguments.length?(x=(_=+_)*_,m):Math.sqrt(x)},m.tapDistance=function(_){return arguments.length?(w=+_,m):w},m}const we={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},mt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Br=["Enter"," ","Escape"],Or={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Ze;(function(e){e.Strict="strict",e.Loose="loose"})(Ze||(Ze={}));var De;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(De||(De={}));var yt;(function(e){e.Partial="partial",e.Full="full"})(yt||(yt={}));const Fr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Me;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Me||(Me={}));var Zt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Zt||(Zt={}));var X;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(X||(X={}));const Co={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top};function Wr(e){return e===null?null:e?"valid":"invalid"}const Xr=e=>"id"in e&&"source"in e&&"target"in e,Ou=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Fn=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),bt=(e,t=[0,0])=>{const{width:n,height:o}=Ce(e),r=e.origin??t,s=n*r[0],i=o*r[1];return{x:e.position.x-s,y:e.position.y-i}},Fu=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,r)=>{const s=typeof r=="string";let i=!t.nodeLookup&&!s?r:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(r):Fn(r)?r:t.nodeLookup.get(r.id));const a=i?Gt(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return nn(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return on(n)},St=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(r=>{(t.filter===void 0||t.filter(r))&&(n=nn(n,Gt(r)),o=!0)}),o?on(n):{x:0,y:0,width:0,height:0}},Wn=(e,t,[n,o,r]=[0,0,1],s=!1,i=!1)=>{const a={...Ct(t,[n,o,r]),width:t.width/r,height:t.height/r},l=[];for(const u of e.values()){const{measured:h,selectable:d=!0,hidden:f=!1}=u;if(i&&!d||f)continue;const y=h.width??u.width??u.initialWidth??null,p=h.height??u.height??u.initialHeight??null,x=xt(a,qe(u)),w=(y??0)*(p??0),m=s&&x>0;(!u.internals.handleBounds||m||x>=w||u.dragging)&&l.push(u)}return l},Wu=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Xu(e,t){const n=new Map,o=t?.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&(t?.includeHiddenNodes||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function Yu({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=Xu(e,i),l=St(a),u=Xn(l,t,n,i?.minZoom??r,i?.maxZoom??s,i?.padding??.1);return await o.setViewport(u,{duration:i?.duration,ease:i?.ease,interpolate:i?.interpolate}),Promise.resolve(!0)}function Yr({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:l,y:u}=a?a.internals.positionAbsolute:{x:0,y:0},h=i.origin??o;let d=i.extent||r;if(i.extent==="parent"&&!i.expandParent)if(!a)s?.("005",we.error005());else{const y=a.measured.width,p=a.measured.height;y&&p&&(d=[[l,u],[l+y,u+p]])}else a&&Ue(i.extent)&&(d=[[i.extent[0][0]+l,i.extent[0][1]+u],[i.extent[1][0]+l,i.extent[1][1]+u]]);const f=Ue(d)?$e(t,d,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&s?.("015",we.error015()),{position:{x:f.x-l+(i.measured.width??0)*h[0],y:f.y-u+(i.measured.height??0)*h[1]},positionAbsolute:f}}async function Zu({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){const s=new Set(e.map(f=>f.id)),i=[];for(const f of n){if(f.deletable===!1)continue;const y=s.has(f.id),p=!y&&f.parentId&&i.find(x=>x.id===f.parentId);(y||p)&&i.push(f)}const a=new Set(t.map(f=>f.id)),l=o.filter(f=>f.deletable!==!1),h=Wu(i,l);for(const f of l)a.has(f.id)&&!h.find(p=>p.id===f.id)&&h.push(f);if(!r)return{edges:h,nodes:i};const d=await r({nodes:i,edges:h});return typeof d=="boolean"?d?{edges:h,nodes:i}:{edges:[],nodes:[]}:d}const Ge=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),$e=(e={x:0,y:0},t,n)=>({x:Ge(e.x,t[0][0],t[1][0]-(n?.width??0)),y:Ge(e.y,t[0][1],t[1][1]-(n?.height??0))});function Zr(e,t,n){const{width:o,height:r}=Ce(n),{x:s,y:i}=n.internals.positionAbsolute;return $e(e,[[s,i],[s+o,i+r]],t)}const jo=(e,t,n)=>e<t?Ge(Math.abs(e-t),1,t)/t:e>n?-Ge(Math.abs(e-n),1,t)/t:0,Gr=(e,t,n=15,o=40)=>{const r=jo(e.x,o,t.width-o)*n,s=jo(e.y,o,t.height-o)*n;return[r,s]},nn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),In=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),on=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),qe=(e,t=[0,0])=>{const{x:n,y:o}=Fn(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Gt=(e,t=[0,0])=>{const{x:n,y:o}=Fn(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},qr=(e,t)=>on(nn(In(e),In(t))),xt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},No=e=>ge(e.width)&&ge(e.height)&&ge(e.x)&&ge(e.y),ge=e=>!isNaN(e)&&isFinite(e),Gu=(e,t)=>{},Et=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Ct=({x:e,y:t},[n,o,r],s=!1,i=[1,1])=>{const a={x:(e-n)/r,y:(t-o)/r};return s?Et(a,i):a},qt=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function Ve(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function qu(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Ve(e,n),r=Ve(e,t);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof e=="object"){const o=Ve(e.top??e.y??0,n),r=Ve(e.bottom??e.y??0,n),s=Ve(e.left??e.x??0,t),i=Ve(e.right??e.x??0,t);return{top:o,right:i,bottom:r,left:s,x:s+i,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Uu(e,t,n,o,r,s){const{x:i,y:a}=qt(e,[t,n,o]),{x:l,y:u}=qt({x:e.x+e.width,y:e.y+e.height},[t,n,o]),h=r-l,d=s-u;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(h),bottom:Math.floor(d)}}const Xn=(e,t,n,o,r,s)=>{const i=qu(s,t,n),a=(t-i.x)/e.width,l=(n-i.y)/e.height,u=Math.min(a,l),h=Ge(u,o,r),d=e.x+e.width/2,f=e.y+e.height/2,y=t/2-d*h,p=n/2-f*h,x=Uu(e,y,p,h,t,n),w={left:Math.min(x.left-i.left,0),top:Math.min(x.top-i.top,0),right:Math.min(x.right-i.right,0),bottom:Math.min(x.bottom-i.bottom,0)};return{x:y-w.left+w.right,y:p-w.top+w.bottom,zoom:h}},wt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Ue(e){return e!=null&&e!=="parent"}function Ce(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Ur(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function Kr(e,t={width:0,height:0},n,o,r){const s={...e},i=o.get(n);if(i){const a=i.origin||r;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function ko(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Ku(){let e,t;return{promise:new Promise((o,r)=>{e=o,t=r}),resolve:e,reject:t}}function Qu(e){return{...Or,...e||{}}}function ht(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:s,y:i}=me(e),a=Ct({x:s-(r?.left??0),y:i-(r?.top??0)},o),{x:l,y:u}=n?Et(a,t):a;return{xSnapped:l,ySnapped:u,...a}}const Yn=e=>({width:e.offsetWidth,height:e.offsetHeight}),Qr=e=>e?.getRootNode?.()||window?.document,Ju=["INPUT","SELECT","TEXTAREA"];function Jr(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Ju.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ei=e=>"clientX"in e,me=(e,t)=>{const n=ei(e),o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},Mo=(e,t,n,o,r)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:r,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...Yn(i)}})};function ti({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:s,targetControlX:i,targetControlY:a}){const l=e*.125+r*.375+i*.375+n*.125,u=t*.125+s*.375+a*.375+o*.125,h=Math.abs(l-e),d=Math.abs(u-t);return[l,u,h,d]}function zt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Io({pos:e,x1:t,y1:n,x2:o,y2:r,c:s}){switch(e){case X.Left:return[t-zt(t-o,s),n];case X.Right:return[t+zt(o-t,s),n];case X.Top:return[t,n-zt(n-r,s)];case X.Bottom:return[t,n+zt(r-n,s)]}}function ni({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:s=X.Top,curvature:i=.25}){const[a,l]=Io({pos:n,x1:e,y1:t,x2:o,y2:r,c:i}),[u,h]=Io({pos:s,x1:o,y1:r,x2:e,y2:t,c:i}),[d,f,y,p]=ti({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:u,targetControlY:h});return[`M${e},${t} C${a},${l} ${u},${h} ${o},${r}`,d,f,y,p]}function oi({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,s=n<e?n+r:n-r,i=Math.abs(o-t)/2,a=o<t?o+i:o-i;return[s,a,r,i]}function ed({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1,zIndexMode:s="basic"}){if(s==="manual")return o;const i=r&&n?o+1e3:o,a=Math.max(e.parentId||r&&e.selected?e.internals.z:0,t.parentId||r&&t.selected?t.internals.z:0);return i+a}function td({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){const s=nn(Gt(e),Gt(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return xt(i,on(s))>0}const nd=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,od=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),rd=(e,t,n={})=>{if(!e.source||!e.target)return t;const o=n.getEdgeId||nd;let r;return Xr(e)?r={...e}:r={...e,id:o(e)},od(r,t)?t:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,t.concat(r))};function ri({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,s,i,a]=oi({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,s,i,a]}const zo={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}},id=({source:e,sourcePosition:t=X.Bottom,target:n})=>t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Po=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function sd({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:o=X.Top,center:r,offset:s,stepPosition:i}){const a=zo[t],l=zo[o],u={x:e.x+a.x*s,y:e.y+a.y*s},h={x:n.x+l.x*s,y:n.y+l.y*s},d=id({source:u,sourcePosition:t,target:h}),f=d.x!==0?"x":"y",y=d[f];let p=[],x,w;const m={x:0,y:0},b={x:0,y:0},[,,g,v]=oi({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[f]*l[f]===-1){f==="x"?(x=r.x??u.x+(h.x-u.x)*i,w=r.y??(u.y+h.y)/2):(x=r.x??(u.x+h.x)/2,w=r.y??u.y+(h.y-u.y)*i);const S=[{x,y:u.y},{x,y:h.y}],j=[{x:u.x,y:w},{x:h.x,y:w}];a[f]===y?p=f==="x"?S:j:p=f==="x"?j:S}else{const S=[{x:u.x,y:h.y}],j=[{x:h.x,y:u.y}];if(f==="x"?p=a.x===y?j:S:p=a.y===y?S:j,t===o){const T=Math.abs(e[f]-n[f]);if(T<=s){const R=Math.min(s-1,s-T);a[f]===y?m[f]=(u[f]>e[f]?-1:1)*R:b[f]=(h[f]>n[f]?-1:1)*R}}if(t!==o){const T=f==="x"?"y":"x",R=a[f]===l[T],_=u[T]>h[T],N=u[T]<h[T];(a[f]===1&&(!R&&_||R&&N)||a[f]!==1&&(!R&&N||R&&_))&&(p=f==="x"?S:j)}const A={x:u.x+m.x,y:u.y+m.y},P={x:h.x+b.x,y:h.y+b.y},V=Math.max(Math.abs(A.x-p[0].x),Math.abs(P.x-p[0].x)),I=Math.max(Math.abs(A.y-p[0].y),Math.abs(P.y-p[0].y));V>=I?(x=(A.x+P.x)/2,w=p[0].y):(x=p[0].x,w=(A.y+P.y)/2)}return[[e,{x:u.x+m.x,y:u.y+m.y},...p,{x:h.x+b.x,y:h.y+b.y},n],x,w,g,v]}function ad(e,t,n,o){const r=Math.min(Po(e,t)/2,Po(t,n)/2,o),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const u=e.x<n.x?-1:1,h=e.y<n.y?1:-1;return`L ${s+r*u},${i}Q ${s},${i} ${s},${i+r*h}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${s},${i+r*l}Q ${s},${i} ${s+r*a},${i}`}function zn({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:s=X.Top,borderRadius:i=5,centerX:a,centerY:l,offset:u=20,stepPosition:h=.5}){const[d,f,y,p,x]=sd({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:s,center:{x:a,y:l},offset:u,stepPosition:h});return[d.reduce((m,b,g)=>{let v="";return g>0&&g<d.length-1?v=ad(d[g-1],b,d[g+1],i):v=`${g===0?"M":"L"}${b.x} ${b.y}`,m+=v,m},""),f,y,p,x]}function Ao(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function cd(e){const{sourceNode:t,targetNode:n}=e;if(!Ao(t)||!Ao(n))return null;const o=t.internals.handleBounds||Do(t.handles),r=n.internals.handleBounds||Do(n.handles),s=To(o?.source??[],e.sourceHandle),i=To(e.connectionMode===Ze.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!s||!i)return e.onError?.("008",we.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=s?.position||X.Bottom,l=i?.position||X.Top,u=Re(t,s,a),h=Re(n,i,l);return{sourceX:u.x,sourceY:u.y,targetX:h.x,targetY:h.y,sourcePosition:a,targetPosition:l}}function Do(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Re(e,t,n=X.Left,o=!1){const r=(t?.x??0)+e.internals.positionAbsolute.x,s=(t?.y??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??Ce(e);if(o)return{x:r+i/2,y:s+a/2};switch(t?.position??n){case X.Top:return{x:r+i/2,y:s};case X.Right:return{x:r+i,y:s+a/2};case X.Bottom:return{x:r+i/2,y:s+a};case X.Left:return{x:r,y:s+a/2}}}function To(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Pn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function ld(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||o,a.markerEnd||r].forEach(l=>{if(l&&typeof l=="object"){const u=Pn(l,t);s.has(u)||(i.push({id:u,color:l.color||n,...l}),s.add(u))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const ii=1e3,ud=10,Zn={nodeOrigin:[0,0],nodeExtent:mt,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},dd={...Zn,checkEquality:!0};function Gn(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function fd(e,t,n){const o=Gn(Zn,n);for(const r of e.values())if(r.parentId)Un(r,e,t,o);else{const s=bt(r,o.nodeOrigin),i=Ue(r.extent)?r.extent:o.nodeExtent,a=$e(s,i,Ce(r));r.internals.positionAbsolute=a}}function hd(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],o=[];for(const r of e.handles){const s={id:r.id,width:r.width??1,height:r.height??1,nodeId:e.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(s):r.type==="target"&&o.push(s)}return{source:n,target:o}}function qn(e){return e==="manual"}function An(e,t,n,o={}){const r=Gn(dd,o),s={i:0},i=new Map(t),a=r?.elevateNodesOnSelect&&!qn(r.zIndexMode)?ii:0;let l=e.length>0;t.clear(),n.clear();for(const u of e){let h=i.get(u.id);if(r.checkEquality&&u===h?.internals.userNode)t.set(u.id,h);else{const d=bt(u,r.nodeOrigin),f=Ue(u.extent)?u.extent:r.nodeExtent,y=$e(d,f,Ce(u));h={...r.defaults,...u,measured:{width:u.measured?.width,height:u.measured?.height},internals:{positionAbsolute:y,handleBounds:hd(u,h),z:si(u,a,r.zIndexMode),userNode:u}},t.set(u.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(l=!1),u.parentId&&Un(h,t,n,o,s)}return l}function pd(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Un(e,t,n,o,r){const{elevateNodesOnSelect:s,nodeOrigin:i,nodeExtent:a,zIndexMode:l}=Gn(Zn,o),u=e.parentId,h=t.get(u);if(!h){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}pd(e,n),r&&!h.parentId&&h.internals.rootParentIndex===void 0&&l==="auto"&&(h.internals.rootParentIndex=++r.i,h.internals.z=h.internals.z+r.i*ud),r&&h.internals.rootParentIndex!==void 0&&(r.i=h.internals.rootParentIndex);const d=s&&!qn(l)?ii:0,{x:f,y,z:p}=gd(e,h,i,a,d,l),{positionAbsolute:x}=e.internals,w=f!==x.x||y!==x.y;(w||p!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:w?{x:f,y}:x,z:p}})}function si(e,t,n){const o=ge(e.zIndex)?e.zIndex:0;return qn(n)?o:o+(e.selected?t:0)}function gd(e,t,n,o,r,s){const{x:i,y:a}=t.internals.positionAbsolute,l=Ce(e),u=bt(e,n),h=Ue(e.extent)?$e(u,e.extent,l):u;let d=$e({x:i+h.x,y:a+h.y},o,l);e.extent==="parent"&&(d=Zr(d,l,t));const f=si(e,r,s),y=t.internals.z??0;return{x:d.x,y:d.y,z:y>=f?y+1:f}}function Kn(e,t,n,o=[0,0]){const r=[],s=new Map;for(const i of e){const a=t.get(i.parentId);if(!a)continue;const l=s.get(i.parentId)?.expandedRect??qe(a),u=qr(l,i.rect);s.set(i.parentId,{expandedRect:u,parent:a})}return s.size>0&&s.forEach(({expandedRect:i,parent:a},l)=>{const u=a.internals.positionAbsolute,h=Ce(a),d=a.origin??o,f=i.x<u.x?Math.round(Math.abs(u.x-i.x)):0,y=i.y<u.y?Math.round(Math.abs(u.y-i.y)):0,p=Math.max(h.width,Math.round(i.width)),x=Math.max(h.height,Math.round(i.height)),w=(p-h.width)*d[0],m=(x-h.height)*d[1];(f>0||y>0||w||m)&&(r.push({id:l,type:"position",position:{x:a.position.x-f+w,y:a.position.y-y+m}}),n.get(l)?.forEach(b=>{e.some(g=>g.id===b.id)||r.push({id:b.id,type:"position",position:{x:b.position.x+f,y:b.position.y+y}})})),(h.width<i.width||h.height<i.height||f||y)&&r.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:p+(f?d[0]*f-w:0),height:x+(y?d[1]*y-m:0)}})}),r}function md(e,t,n,o,r,s,i){const a=o?.querySelector(".xyflow__viewport");let l=!1;if(!a)return{changes:[],updatedInternals:l};const u=[],h=window.getComputedStyle(a),{m22:d}=new window.DOMMatrixReadOnly(h.transform),f=[];for(const y of e.values()){const p=t.get(y.id);if(!p)continue;if(p.hidden){t.set(p.id,{...p,internals:{...p.internals,handleBounds:void 0}}),l=!0;continue}const x=Yn(y.nodeElement),w=p.measured.width!==x.width||p.measured.height!==x.height;if(!!(x.width&&x.height&&(w||!p.internals.handleBounds||y.force))){const b=y.nodeElement.getBoundingClientRect(),g=Ue(p.extent)?p.extent:s;let{positionAbsolute:v}=p.internals;p.parentId&&p.extent==="parent"?v=Zr(v,x,t.get(p.parentId)):g&&(v=$e(v,g,x));const C={...p,measured:x,internals:{...p.internals,positionAbsolute:v,handleBounds:{source:Mo("source",y.nodeElement,b,d,p.id),target:Mo("target",y.nodeElement,b,d,p.id)}}};t.set(p.id,C),p.parentId&&Un(C,t,n,{nodeOrigin:r,zIndexMode:i}),l=!0,w&&(u.push({id:p.id,type:"dimensions",dimensions:x}),p.expandParent&&p.parentId&&f.push({id:p.id,parentId:p.parentId,rect:qe(C,r)}))}}if(f.length>0){const y=Kn(f,t,n,r);u.push(...y)}return{changes:u,updatedInternals:l}}async function yd({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,s]],o),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function $o(e,t,n,o,r,s){let i=r;const a=o.get(i)||new Map;o.set(i,a.set(n,t)),i=`${r}-${e}`;const l=o.get(i)||new Map;if(o.set(i,l.set(n,t)),s){i=`${r}-${e}-${s}`;const u=o.get(i)||new Map;o.set(i,u.set(n,t))}}function ai(e,t,n){e.clear(),t.clear();for(const o of n){const{source:r,target:s,sourceHandle:i=null,targetHandle:a=null}=o,l={edgeId:o.id,source:r,target:s,sourceHandle:i,targetHandle:a},u=`${r}-${i}--${s}-${a}`,h=`${s}-${a}--${r}-${i}`;$o("source",l,h,e,r,i),$o("target",l,u,e,s,a),t.set(o.id,o)}}function ci(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:ci(n,t):!1}function Ro(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function xd(e,t,n,o){const r=new Map;for(const[s,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!ci(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&r.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function xn({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){const r=[];for(const[i,a]of t){const l=n.get(i)?.internals.userNode;l&&r.push({...l,position:a.position,dragging:o})}if(!e)return[r[0],r];const s=n.get(e)?.internals.userNode;return[s?{...s,position:t.get(e)?.position||s.position,dragging:o}:r[0],r]}function wd({dragItems:e,snapGrid:t,x:n,y:o}){const r=e.values().next().value;if(!r)return null;const s={x:n-r.distance.x,y:o-r.distance.y},i=Et(s,t);return{x:i.x-s.x,y:i.y-s.y}}function vd({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let s={x:null,y:null},i=0,a=new Map,l=!1,u={x:0,y:0},h=null,d=!1,f=null,y=!1,p=!1,x=null;function w({noDragClassName:b,handleSelector:g,domNode:v,isSelectable:C,nodeId:S,nodeClickDistance:j=0}){f=de(v);function A({x:T,y:R}){const{nodeLookup:_,nodeExtent:N,snapGrid:E,snapToGrid:M,nodeOrigin:k,onNodeDrag:z,onSelectionDrag:$,onError:H,updateNodePositions:L}=t();s={x:T,y:R};let W=!1;const O=a.size>1,q=O&&N?In(St(a)):null,J=O&&M?wd({dragItems:a,snapGrid:E,x:T,y:R}):null;for(const[G,B]of a){if(!_.has(G))continue;let Y={x:T-B.distance.x,y:R-B.distance.y};M&&(Y=J?{x:Math.round(Y.x+J.x),y:Math.round(Y.y+J.y)}:Et(Y,E));let te=null;if(O&&N&&!B.extent&&q){const{positionAbsolute:K}=B.internals,oe=K.x-q.x+N[0][0],ie=K.x+B.measured.width-q.x2+N[1][0],re=K.y-q.y+N[0][1],le=K.y+B.measured.height-q.y2+N[1][1];te=[[oe,re],[ie,le]]}const{position:ee,positionAbsolute:U}=Yr({nodeId:G,nextPosition:Y,nodeLookup:_,nodeExtent:te||N,nodeOrigin:k,onError:H});W=W||B.position.x!==ee.x||B.position.y!==ee.y,B.position=ee,B.internals.positionAbsolute=U}if(p=p||W,!!W&&(L(a,!0),x&&(o||z||!S&&$))){const[G,B]=xn({nodeId:S,dragItems:a,nodeLookup:_});o?.(x,a,G,B),z?.(x,G,B),S||$?.(x,B)}}async function P(){if(!h)return;const{transform:T,panBy:R,autoPanSpeed:_,autoPanOnNodeDrag:N}=t();if(!N){l=!1,cancelAnimationFrame(i);return}const[E,M]=Gr(u,h,_);(E!==0||M!==0)&&(s.x=(s.x??0)-E/T[2],s.y=(s.y??0)-M/T[2],await R({x:E,y:M})&&A(s)),i=requestAnimationFrame(P)}function V(T){const{nodeLookup:R,multiSelectionActive:_,nodesDraggable:N,transform:E,snapGrid:M,snapToGrid:k,selectNodesOnDrag:z,onNodeDragStart:$,onSelectionDragStart:H,unselectNodesAndEdges:L}=t();d=!0,(!z||!C)&&!_&&S&&(R.get(S)?.selected||L()),C&&z&&S&&e?.(S);const W=ht(T.sourceEvent,{transform:E,snapGrid:M,snapToGrid:k,containerBounds:h});if(s=W,a=xd(R,N,W,S),a.size>0&&(n||$||!S&&H)){const[O,q]=xn({nodeId:S,dragItems:a,nodeLookup:R});n?.(T.sourceEvent,a,O,q),$?.(T.sourceEvent,O,q),S||H?.(T.sourceEvent,q)}}const I=zr().clickDistance(j).on("start",T=>{const{domNode:R,nodeDragThreshold:_,transform:N,snapGrid:E,snapToGrid:M}=t();h=R?.getBoundingClientRect()||null,y=!1,p=!1,x=T.sourceEvent,_===0&&V(T),s=ht(T.sourceEvent,{transform:N,snapGrid:E,snapToGrid:M,containerBounds:h}),u=me(T.sourceEvent,h)}).on("drag",T=>{const{autoPanOnNodeDrag:R,transform:_,snapGrid:N,snapToGrid:E,nodeDragThreshold:M,nodeLookup:k}=t(),z=ht(T.sourceEvent,{transform:_,snapGrid:N,snapToGrid:E,containerBounds:h});if(x=T.sourceEvent,(T.sourceEvent.type==="touchmove"&&T.sourceEvent.touches.length>1||S&&!k.has(S))&&(y=!0),!y){if(!l&&R&&d&&(l=!0,P()),!d){const $=me(T.sourceEvent,h),H=$.x-u.x,L=$.y-u.y;Math.sqrt(H*H+L*L)>M&&V(T)}(s.x!==z.xSnapped||s.y!==z.ySnapped)&&a&&d&&(u=me(T.sourceEvent,h),A(z))}}).on("end",T=>{if(!(!d||y)&&(l=!1,d=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:R,updateNodePositions:_,onNodeDragStop:N,onSelectionDragStop:E}=t();if(p&&(_(a,!1),p=!1),r||N||!S&&E){const[M,k]=xn({nodeId:S,dragItems:a,nodeLookup:R,dragging:!1});r?.(T.sourceEvent,a,M,k),N?.(T.sourceEvent,M,k),S||E?.(T.sourceEvent,k)}}}).filter(T=>{const R=T.target;return!T.button&&(!b||!Ro(R,`.${b}`,v))&&(!g||Ro(R,g,v))});f.call(I)}function m(){f?.on(".drag",null)}return{update:w,destroy:m}}function _d(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())xt(r,qe(s))>0&&o.push(s);return o}const bd=250;function Sd(e,t,n,o){let r=[],s=1/0;const i=_d(e,n,t+bd);for(const a of i){const l=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(const u of l){if(o.nodeId===u.nodeId&&o.type===u.type&&o.id===u.id)continue;const{x:h,y:d}=Re(a,u,u.position,!0),f=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(d-e.y,2));f>t||(f<s?(r=[{...u,x:h,y:d}],s=f):f===s&&r.push({...u,x:h,y:d}))}}if(!r.length)return null;if(r.length>1){const a=o.type==="source"?"target":"source";return r.find(l=>l.type===a)??r[0]}return r[0]}function li(e,t,n,o,r,s=!1){const i=o.get(e);if(!i)return null;const a=r==="strict"?i.internals.handleBounds?.[t]:[...i.internals.handleBounds?.source??[],...i.internals.handleBounds?.target??[]],l=(n?a?.find(u=>u.id===n):a?.[0])??null;return l&&s?{...l,...Re(i,l,l.position,!0)}:l}function ui(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Ed(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const di=()=>!0;function Cd(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:l,lib:u,autoPanOnConnect:h,flowId:d,panBy:f,cancelConnection:y,onConnectStart:p,onConnect:x,onConnectEnd:w,isValidConnection:m=di,onReconnectEnd:b,updateConnection:g,getTransform:v,getFromHandle:C,autoPanSpeed:S,dragThreshold:j=1,handleDomNode:A}){const P=Qr(e.target);let V=0,I;const{x:T,y:R}=me(e),_=ui(s,A),N=a?.getBoundingClientRect();let E=!1;if(!N||!_)return;const M=li(r,_,o,l,t);if(!M)return;let k=me(e,N),z=!1,$=null,H=!1,L=null;function W(){if(!h||!N)return;const[ee,U]=Gr(k,N,S);f({x:ee,y:U}),V=requestAnimationFrame(W)}const O={...M,nodeId:r,type:_,position:M.position},q=l.get(r);let G={inProgress:!0,isValid:null,from:Re(q,O,X.Left,!0),fromHandle:O,fromPosition:O.position,fromNode:q,to:k,toHandle:null,toPosition:Co[O.position],toNode:null,pointer:k};function B(){E=!0,g(G),p?.(e,{nodeId:r,handleId:o,handleType:_})}j===0&&B();function Y(ee){if(!E){const{x:le,y:je}=me(ee),_e=le-T,ze=je-R;if(!(_e*_e+ze*ze>j*j))return;B()}if(!C()||!O){te(ee);return}const U=v();k=me(ee,N),I=Sd(Ct(k,U,!1,[1,1]),n,l,O),z||(W(),z=!0);const K=fi(ee,{handle:I,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:i?"target":"source",isValidConnection:m,doc:P,lib:u,flowId:d,nodeLookup:l});L=K.handleDomNode,$=K.connection,H=Ed(!!I,K.isValid);const oe=l.get(r),ie=oe?Re(oe,O,X.Left,!0):G.from,re={...G,from:ie,isValid:H,to:K.toHandle&&H?qt({x:K.toHandle.x,y:K.toHandle.y},U):k,toHandle:K.toHandle,toPosition:H&&K.toHandle?K.toHandle.position:Co[O.position],toNode:K.toHandle?l.get(K.toHandle.nodeId):null,pointer:k};g(re),G=re}function te(ee){if(!("touches"in ee&&ee.touches.length>0)){if(E){(I||L)&&$&&H&&x?.($);const{inProgress:U,...K}=G,oe={...K,toPosition:G.toHandle?G.toPosition:null};w?.(ee,oe),s&&b?.(ee,oe)}y(),cancelAnimationFrame(V),z=!1,H=!1,$=null,L=null,P.removeEventListener("mousemove",Y),P.removeEventListener("mouseup",te),P.removeEventListener("touchmove",Y),P.removeEventListener("touchend",te)}}P.addEventListener("mousemove",Y),P.addEventListener("mouseup",te),P.addEventListener("touchmove",Y),P.addEventListener("touchend",te)}function fi(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:s,doc:i,lib:a,flowId:l,isValidConnection:u=di,nodeLookup:h}){const d=s==="target",f=t?i.querySelector(`.${a}-flow__handle[data-id="${l}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:y,y:p}=me(e),x=i.elementFromPoint(y,p),w=x?.classList.contains(`${a}-flow__handle`)?x:f,m={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){const b=ui(void 0,w),g=w.getAttribute("data-nodeid"),v=w.getAttribute("data-handleid"),C=w.classList.contains("connectable"),S=w.classList.contains("connectableend");if(!g||!b)return m;const j={source:d?g:o,sourceHandle:d?v:r,target:d?o:g,targetHandle:d?r:v};m.connection=j;const P=C&&S&&(n===Ze.Strict?d&&b==="source"||!d&&b==="target":g!==o||v!==r);m.isValid=P&&u(j),m.toHandle=li(g,b,v,h,n,!0)}return m}const Dn={onPointerDown:Cd,isValid:fi};function jd({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const r=de(e);function s({translateExtent:a,width:l,height:u,zoomStep:h=1,pannable:d=!0,zoomable:f=!0,inversePan:y=!1}){const p=g=>{if(g.sourceEvent.type!=="wheel"||!t)return;const v=n(),C=g.sourceEvent.ctrlKey&&wt()?10:1,S=-g.sourceEvent.deltaY*(g.sourceEvent.deltaMode===1?.05:g.sourceEvent.deltaMode?1:.002)*h,j=v[2]*Math.pow(2,S*C);t.scaleTo(j)};let x=[0,0];const w=g=>{(g.sourceEvent.type==="mousedown"||g.sourceEvent.type==="touchstart")&&(x=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY])},m=g=>{const v=n();if(g.sourceEvent.type!=="mousemove"&&g.sourceEvent.type!=="touchmove"||!t)return;const C=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY],S=[C[0]-x[0],C[1]-x[1]];x=C;const j=o()*Math.max(v[2],Math.log(v[2]))*(y?-1:1),A={x:v[0]-S[0]*j,y:v[1]-S[1]*j},P=[[0,0],[l,u]];t.setViewportConstrained({x:A.x,y:A.y,zoom:v[2]},P,a)},b=Vr().on("start",w).on("zoom",d?m:null).on("zoom.wheel",f?p:null);r.call(b,{})}function i(){r.on("zoom",null)}return{update:s,destroy:i,pointer:pe}}const rn=e=>({x:e.x,y:e.y,zoom:e.k}),wn=({x:e,y:t,zoom:n})=>tn.translate(e,t).scale(n),Be=(e,t)=>e.target.closest(`.${t}`),hi=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Nd=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,vn=(e,t=0,n=Nd,o=()=>{})=>{const r=typeof t=="number"&&t>0;return r||o(),r?e.transition().duration(t).ease(n).on("end",o):e},pi=e=>{const t=e.ctrlKey&&wt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function kd({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:u}){return h=>{if(Be(h,t))return h.ctrlKey&&h.preventDefault(),!1;h.preventDefault(),h.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(h.ctrlKey&&i){const w=pe(h),m=pi(h),b=d*Math.pow(2,m);o.scaleTo(n,b,w,h);return}const f=h.deltaMode===1?20:1;let y=r===De.Vertical?0:h.deltaX*f,p=r===De.Horizontal?0:h.deltaY*f;!wt()&&h.shiftKey&&r!==De.Vertical&&(y=h.deltaY*f,p=0),o.translateBy(n,-(y/d)*s,-(p/d)*s,{internal:!0});const x=rn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(l?.(h,x),e.panScrollTimeout=setTimeout(()=>{u?.(h,x),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,a?.(h,x))}}function Md({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){const s=o.type==="wheel",i=!t&&s&&!o.ctrlKey,a=Be(o,e);if(o.ctrlKey&&s&&a&&o.preventDefault(),i||a)return null;o.preventDefault(),n.call(this,o,r)}}function Id({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const r=rn(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,r)}}function zd({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return s=>{e.usedRightMouseButton=!!(n&&hi(t,e.mouseButton??0)),s.sourceEvent?.sync||o([s.transform.x,s.transform.y,s.transform.k]),r&&!s.sourceEvent?.internal&&r?.(s.sourceEvent,rn(s.transform))}}function Pd({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:s}){return i=>{if(!i.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,s&&hi(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),r)){const a=rn(i.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(i.sourceEvent,a)},n?150:0)}}}function Ad({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:l,lib:u,connectionInProgress:h}){return d=>{const f=e||t,y=n&&d.ctrlKey,p=d.type==="wheel";if(d.button===1&&d.type==="mousedown"&&(Be(d,`${u}-flow__node`)||Be(d,`${u}-flow__edge`)))return!0;if(!o&&!f&&!r&&!s&&!n||i||h&&!p||Be(d,a)&&p||Be(d,l)&&(!p||r&&p&&!e)||!n&&d.ctrlKey&&p)return!1;if(!n&&d.type==="touchstart"&&d.touches?.length>1)return d.preventDefault(),!1;if(!f&&!r&&!y&&p||!o&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(o)&&!o.includes(d.button)&&d.type==="mousedown")return!1;const x=Array.isArray(o)&&o.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||p)&&x}}function Dd({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:r,onPanZoom:s,onPanZoomStart:i,onPanZoomEnd:a,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),d=Vr().scaleExtent([t,n]).translateExtent(o),f=de(e).call(d);b({x:r.x,y:r.y,zoom:Ge(r.zoom,t,n)},[[0,0],[h.width,h.height]],o);const y=f.on("wheel.zoom"),p=f.on("dblclick.zoom");d.wheelDelta(pi);function x(I,T){return f?new Promise(R=>{d?.interpolate(T?.interpolate==="linear"?gn:Rt).transform(vn(f,T?.duration,T?.ease,()=>R(!0)),I)}):Promise.resolve(!1)}function w({noWheelClassName:I,noPanClassName:T,onPaneContextMenu:R,userSelectionActive:_,panOnScroll:N,panOnDrag:E,panOnScrollMode:M,panOnScrollSpeed:k,preventScrolling:z,zoomOnPinch:$,zoomOnScroll:H,zoomOnDoubleClick:L,zoomActivationKeyPressed:W,lib:O,onTransformChange:q,connectionInProgress:J,paneClickDistance:G,selectionOnDrag:B}){_&&!u.isZoomingOrPanning&&m();const Y=N&&!W&&!_;d.clickDistance(B?1/0:!ge(G)||G<0?0:G);const te=Y?kd({zoomPanValues:u,noWheelClassName:I,d3Selection:f,d3Zoom:d,panOnScrollMode:M,panOnScrollSpeed:k,zoomOnPinch:$,onPanZoomStart:i,onPanZoom:s,onPanZoomEnd:a}):Md({noWheelClassName:I,preventScrolling:z,d3ZoomHandler:y});if(f.on("wheel.zoom",te,{passive:!1}),!_){const U=Id({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:i});d.on("start",U);const K=zd({zoomPanValues:u,panOnDrag:E,onPaneContextMenu:!!R,onPanZoom:s,onTransformChange:q});d.on("zoom",K);const oe=Pd({zoomPanValues:u,panOnDrag:E,panOnScroll:N,onPaneContextMenu:R,onPanZoomEnd:a,onDraggingChange:l});d.on("end",oe)}const ee=Ad({zoomActivationKeyPressed:W,panOnDrag:E,zoomOnScroll:H,panOnScroll:N,zoomOnDoubleClick:L,zoomOnPinch:$,userSelectionActive:_,noPanClassName:T,noWheelClassName:I,lib:O,connectionInProgress:J});d.filter(ee),L?f.on("dblclick.zoom",p):f.on("dblclick.zoom",null)}function m(){d.on("zoom",null)}async function b(I,T,R){const _=wn(I),N=d?.constrain()(_,T,R);return N&&await x(N),new Promise(E=>E(N))}async function g(I,T){const R=wn(I);return await x(R,T),new Promise(_=>_(R))}function v(I){if(f){const T=wn(I),R=f.property("__zoom");(R.k!==I.zoom||R.x!==I.x||R.y!==I.y)&&d?.transform(f,T,null,{sync:!0})}}function C(){const I=f?Hr(f.node()):{x:0,y:0,k:1};return{x:I.x,y:I.y,zoom:I.k}}function S(I,T){return f?new Promise(R=>{d?.interpolate(T?.interpolate==="linear"?gn:Rt).scaleTo(vn(f,T?.duration,T?.ease,()=>R(!0)),I)}):Promise.resolve(!1)}function j(I,T){return f?new Promise(R=>{d?.interpolate(T?.interpolate==="linear"?gn:Rt).scaleBy(vn(f,T?.duration,T?.ease,()=>R(!0)),I)}):Promise.resolve(!1)}function A(I){d?.scaleExtent(I)}function P(I){d?.translateExtent(I)}function V(I){const T=!ge(I)||I<0?0:I;d?.clickDistance(T)}return{update:w,destroy:m,setViewport:g,setViewportConstrained:b,getViewport:C,scaleTo:S,scaleBy:j,setScaleExtent:A,setTranslateExtent:P,syncViewport:v,setClickDistance:V}}var Ke;(function(e){e.Line="line",e.Handle="handle"})(Ke||(Ke={}));function Td({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:s}){const i=e-t,a=n-o,l=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&r&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}function Lo(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:r}}function Ne(e,t){return Math.max(0,t-e)}function ke(e,t){return Math.max(0,e-t)}function Pt(e,t,n){return Math.max(0,t-e,e-n)}function Ho(e,t){return e?!t:t}function $d(e,t,n,o,r,s,i,a){let{affectsX:l,affectsY:u}=t;const{isHorizontal:h,isVertical:d}=t,f=h&&d,{xSnapped:y,ySnapped:p}=n,{minWidth:x,maxWidth:w,minHeight:m,maxHeight:b}=o,{x:g,y:v,width:C,height:S,aspectRatio:j}=e;let A=Math.floor(h?y-e.pointerX:0),P=Math.floor(d?p-e.pointerY:0);const V=C+(l?-A:A),I=S+(u?-P:P),T=-s[0]*C,R=-s[1]*S;let _=Pt(V,x,w),N=Pt(I,m,b);if(i){let k=0,z=0;l&&A<0?k=Ne(g+A+T,i[0][0]):!l&&A>0&&(k=ke(g+V+T,i[1][0])),u&&P<0?z=Ne(v+P+R,i[0][1]):!u&&P>0&&(z=ke(v+I+R,i[1][1])),_=Math.max(_,k),N=Math.max(N,z)}if(a){let k=0,z=0;l&&A>0?k=ke(g+A,a[0][0]):!l&&A<0&&(k=Ne(g+V,a[1][0])),u&&P>0?z=ke(v+P,a[0][1]):!u&&P<0&&(z=Ne(v+I,a[1][1])),_=Math.max(_,k),N=Math.max(N,z)}if(r){if(h){const k=Pt(V/j,m,b)*j;if(_=Math.max(_,k),i){let z=0;!l&&!u||l&&!u&&f?z=ke(v+R+V/j,i[1][1])*j:z=Ne(v+R+(l?A:-A)/j,i[0][1])*j,_=Math.max(_,z)}if(a){let z=0;!l&&!u||l&&!u&&f?z=Ne(v+V/j,a[1][1])*j:z=ke(v+(l?A:-A)/j,a[0][1])*j,_=Math.max(_,z)}}if(d){const k=Pt(I*j,x,w)/j;if(N=Math.max(N,k),i){let z=0;!l&&!u||u&&!l&&f?z=ke(g+I*j+T,i[1][0])/j:z=Ne(g+(u?P:-P)*j+T,i[0][0])/j,N=Math.max(N,z)}if(a){let z=0;!l&&!u||u&&!l&&f?z=Ne(g+I*j,a[1][0])/j:z=ke(g+(u?P:-P)*j,a[0][0])/j,N=Math.max(N,z)}}}P=P+(P<0?N:-N),A=A+(A<0?_:-_),r&&(f?V>I*j?P=(Ho(l,u)?-A:A)/j:A=(Ho(l,u)?-P:P)*j:h?(P=A/j,u=l):(A=P*j,l=u));const E=l?g+A:g,M=u?v+P:v;return{width:C+(l?-A:A),height:S+(u?-P:P),x:s[0]*A*(l?-1:1)+E,y:s[1]*P*(u?-1:1)+M}}const gi={width:0,height:0,x:0,y:0},Rd={...gi,pointerX:0,pointerY:0,aspectRatio:1};function Ld(e){return[[0,0],[e.measured.width,e.measured.height]]}function Hd(e,t,n){const o=t.position.x+e.position.x,r=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,l=n[1]*i;return[[o-a,r-l],[o+s-a,r+i-l]]}function Vd({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){const s=de(e);let i={controlDirection:Lo("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function a({controlPosition:u,boundaries:h,keepAspectRatio:d,resizeDirection:f,onResizeStart:y,onResize:p,onResizeEnd:x,shouldResize:w}){let m={...gi},b={...Rd};i={boundaries:h,resizeDirection:f,keepAspectRatio:d,controlDirection:Lo(u)};let g,v=null,C=[],S,j,A,P=!1;const V=zr().on("start",I=>{const{nodeLookup:T,transform:R,snapGrid:_,snapToGrid:N,nodeOrigin:E,paneDomNode:M}=n();if(g=T.get(t),!g)return;v=M?.getBoundingClientRect()??null;const{xSnapped:k,ySnapped:z}=ht(I.sourceEvent,{transform:R,snapGrid:_,snapToGrid:N,containerBounds:v});m={width:g.measured.width??0,height:g.measured.height??0,x:g.position.x??0,y:g.position.y??0},b={...m,pointerX:k,pointerY:z,aspectRatio:m.width/m.height},S=void 0,g.parentId&&(g.extent==="parent"||g.expandParent)&&(S=T.get(g.parentId),j=S&&g.extent==="parent"?Ld(S):void 0),C=[],A=void 0;for(const[$,H]of T)if(H.parentId===t&&(C.push({id:$,position:{...H.position},extent:H.extent}),H.extent==="parent"||H.expandParent)){const L=Hd(H,g,H.origin??E);A?A=[[Math.min(L[0][0],A[0][0]),Math.min(L[0][1],A[0][1])],[Math.max(L[1][0],A[1][0]),Math.max(L[1][1],A[1][1])]]:A=L}y?.(I,{...m})}).on("drag",I=>{const{transform:T,snapGrid:R,snapToGrid:_,nodeOrigin:N}=n(),E=ht(I.sourceEvent,{transform:T,snapGrid:R,snapToGrid:_,containerBounds:v}),M=[];if(!g)return;const{x:k,y:z,width:$,height:H}=m,L={},W=g.origin??N,{width:O,height:q,x:J,y:G}=$d(b,i.controlDirection,E,i.boundaries,i.keepAspectRatio,W,j,A),B=O!==$,Y=q!==H,te=J!==k&&B,ee=G!==z&&Y;if(!te&&!ee&&!B&&!Y)return;if((te||ee||W[0]===1||W[1]===1)&&(L.x=te?J:m.x,L.y=ee?G:m.y,m.x=L.x,m.y=L.y,C.length>0)){const ie=J-k,re=G-z;for(const le of C)le.position={x:le.position.x-ie+W[0]*(O-$),y:le.position.y-re+W[1]*(q-H)},M.push(le)}if((B||Y)&&(L.width=B&&(!i.resizeDirection||i.resizeDirection==="horizontal")?O:m.width,L.height=Y&&(!i.resizeDirection||i.resizeDirection==="vertical")?q:m.height,m.width=L.width,m.height=L.height),S&&g.expandParent){const ie=W[0]*(L.width??0);L.x&&L.x<ie&&(m.x=ie,b.x=b.x-(L.x-ie));const re=W[1]*(L.height??0);L.y&&L.y<re&&(m.y=re,b.y=b.y-(L.y-re))}const U=Td({width:m.width,prevWidth:$,height:m.height,prevHeight:H,affectsX:i.controlDirection.affectsX,affectsY:i.controlDirection.affectsY}),K={...m,direction:U};w?.(I,K)!==!1&&(P=!0,p?.(I,K),o(L,M))}).on("end",I=>{P&&(x?.(I,{...m}),r?.({...m}),P=!1)});s.call(V)}function l(){s.on(".drag",null)}return{update:a,destroy:l}}const Bd={},Vo=e=>{let t;const n=new Set,o=(h,d)=>{const f=typeof h=="function"?h(t):h;if(!Object.is(f,t)){const y=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,y))}},r=()=>t,l={setState:o,getState:r,getInitialState:()=>u,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(Bd?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(o,r,l);return l},Od=e=>e?Vo(e):Vo,{useDebugValue:Fd}=Rn,{useSyncExternalStoreWithSelector:Wd}=ya,Xd=e=>e;function mi(e,t=Xd,n){const o=Wd(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Fd(o),o}const Bo=(e,t)=>{const n=Od(e),o=(r,s=t)=>mi(n,r,s);return Object.assign(o,n),o},Yd=(e,t)=>e?Bo(e,t):Bo;function se(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const sn=D.createContext(null),Zd=sn.Provider,yi=we.error001();function ne(e,t){const n=D.useContext(sn);if(n===null)throw new Error(yi);return mi(n,e,t)}function ae(){const e=D.useContext(sn);if(e===null)throw new Error(yi);return D.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Oo={display:"none"},Gd={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},xi="react-flow__node-desc",wi="react-flow__edge-desc",qd="react-flow__aria-live",Ud=e=>e.ariaLiveMessage,Kd=e=>e.ariaLabelConfig;function Qd({rfId:e}){const t=ne(Ud);return c.jsx("div",{id:`${qd}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Gd,children:t})}function Jd({rfId:e,disableKeyboardA11y:t}){const n=ne(Kd);return c.jsxs(c.Fragment,{children:[c.jsx("div",{id:`${xi}-${e}`,style:Oo,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),c.jsx("div",{id:`${wi}-${e}`,style:Oo,children:n["edge.a11yDescription.default"]}),!t&&c.jsx(Qd,{rfId:e})]})}const an=D.forwardRef(({position:e="top-left",children:t,className:n,style:o,...r},s)=>{const i=`${e}`.split("-");return c.jsx("div",{className:ce(["react-flow__panel",n,...i]),style:o,ref:s,...r,children:t})});an.displayName="Panel";function ef({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:c.jsx(an,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:c.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const tf=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},At=e=>e.id;function nf(e,t){return se(e.selectedNodes.map(At),t.selectedNodes.map(At))&&se(e.selectedEdges.map(At),t.selectedEdges.map(At))}function of({onSelectionChange:e}){const t=ae(),{selectedNodes:n,selectedEdges:o}=ne(tf,nf);return D.useEffect(()=>{const r={nodes:n,edges:o};e?.(r),t.getState().onSelectionChangeHandlers.forEach(s=>s(r))},[n,o,e]),null}const rf=e=>!!e.onSelectionChangeHandlers;function sf({onSelectionChange:e}){const t=ne(rf);return e||t?c.jsx(of,{onSelectionChange:e}):null}const vi=[0,0],af={x:0,y:0,zoom:1},cf=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Fo=[...cf,"rfId"],lf=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Wo={translateExtent:mt,nodeOrigin:vi,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function uf(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:l}=ne(lf,se),u=ae();D.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{h.current=Wo,a()}),[]);const h=D.useRef(Wo);return D.useEffect(()=>{for(const d of Fo){const f=e[d],y=h.current[d];f!==y&&(typeof e[d]>"u"||(d==="nodes"?t(f):d==="edges"?n(f):d==="minZoom"?o(f):d==="maxZoom"?r(f):d==="translateExtent"?s(f):d==="nodeExtent"?i(f):d==="ariaLabelConfig"?u.setState({ariaLabelConfig:Qu(f)}):d==="fitView"?u.setState({fitViewQueued:f}):d==="fitViewOptions"?u.setState({fitViewOptions:f}):u.setState({[d]:f})))}h.current=e},Fo.map(d=>e[d])),null}function Xo(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function df(e){const[t,n]=D.useState(e==="system"?null:e);return D.useEffect(()=>{if(e!=="system"){n(e);return}const o=Xo(),r=()=>n(o?.matches?"dark":"light");return r(),o?.addEventListener("change",r),()=>{o?.removeEventListener("change",r)}},[e]),t!==null?t:Xo()?.matches?"dark":"light"}const Yo=typeof document<"u"?document:null;function vt(e=null,t={target:Yo,actInsideInputWithModifier:!0}){const[n,o]=D.useState(!1),r=D.useRef(!1),s=D.useRef(new Set([])),[i,a]=D.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),h=u.reduce((d,f)=>d.concat(...f),[]);return[u,h]}return[[],[]]},[e]);return D.useEffect(()=>{const l=t?.target??Yo,u=t?.actInsideInputWithModifier??!0;if(e!==null){const h=y=>{if(r.current=y.ctrlKey||y.metaKey||y.shiftKey||y.altKey,(!r.current||r.current&&!u)&&Jr(y))return!1;const x=Go(y.code,a);if(s.current.add(y[x]),Zo(i,s.current,!1)){const w=y.composedPath?.()?.[0]||y.target,m=w?.nodeName==="BUTTON"||w?.nodeName==="A";t.preventDefault!==!1&&(r.current||!m)&&y.preventDefault(),o(!0)}},d=y=>{const p=Go(y.code,a);Zo(i,s.current,!0)?(o(!1),s.current.clear()):s.current.delete(y[p]),y.key==="Meta"&&s.current.clear(),r.current=!1},f=()=>{s.current.clear(),o(!1)};return l?.addEventListener("keydown",h),l?.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{l?.removeEventListener("keydown",h),l?.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,o]),n}function Zo(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function Go(e,t){return t.includes(e)?"code":"key"}const ff=()=>{const e=ae();return D.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,r,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??s},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:r,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),l=Xn(t,o,r,s,i,n?.padding??.1);return a?(await a.setViewport(l,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:r,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:l}=i.getBoundingClientRect(),u={x:t.x-a,y:t.y-l},h=n.snapGrid??r,d=n.snapToGrid??s;return Ct(u,o,d,h)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:r,y:s}=o.getBoundingClientRect(),i=qt(t,n);return{x:i.x+r,y:i.y+s}}}),[])};function _i(e,t){const n=[],o=new Map,r=[];for(const s of e)if(s.type==="add"){r.push(s);continue}else if(s.type==="remove"||s.type==="replace")o.set(s.id,[s]);else{const i=o.get(s.id);i?i.push(s):o.set(s.id,[s])}for(const s of t){const i=o.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const l of i)hf(l,a);n.push(a)}return r.length&&r.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function hf(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function pf(e,t){return _i(e,t)}function gf(e,t){return _i(e,t)}function Ae(e,t){return{id:e,type:"select",selected:t}}function Oe(e,t=new Set,n=!1){const o=[];for(const[r,s]of e){const i=t.has(r);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),o.push(Ae(s.id,i)))}return o}function qo({items:e=[],lookup:t}){const n=[],o=new Map(e.map(r=>[r.id,r]));for(const[r,s]of e.entries()){const i=t.get(s.id),a=i?.internals?.userNode??i;a!==void 0&&a!==s&&n.push({id:s.id,item:s,type:"replace"}),a===void 0&&n.push({item:s,type:"add",index:r})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function Uo(e){return{id:e.id,type:"remove"}}const Ko=e=>Ou(e),mf=e=>Xr(e);function bi(e){return D.forwardRef(e)}const yf=typeof window<"u"?D.useLayoutEffect:D.useEffect;function Qo(e){const[t,n]=D.useState(BigInt(0)),[o]=D.useState(()=>xf(()=>n(r=>r+BigInt(1))));return yf(()=>{const r=o.get();r.length&&(e(r),o.reset())},[t]),o}function xf(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Si=D.createContext(null);function wf({children:e}){const t=ae(),n=D.useCallback(a=>{const{nodes:l=[],setNodes:u,hasDefaultNodes:h,onNodesChange:d,nodeLookup:f,fitViewQueued:y,onNodesChangeMiddlewareMap:p}=t.getState();let x=l;for(const m of a)x=typeof m=="function"?m(x):m;let w=qo({items:x,lookup:f});for(const m of p.values())w=m(w);h&&u(x),w.length>0?d?.(w):y&&window.requestAnimationFrame(()=>{const{fitViewQueued:m,nodes:b,setNodes:g}=t.getState();m&&g(b)})},[]),o=Qo(n),r=D.useCallback(a=>{const{edges:l=[],setEdges:u,hasDefaultEdges:h,onEdgesChange:d,edgeLookup:f}=t.getState();let y=l;for(const p of a)y=typeof p=="function"?p(y):p;h?u(y):d&&d(qo({items:y,lookup:f}))},[]),s=Qo(r),i=D.useMemo(()=>({nodeQueue:o,edgeQueue:s}),[]);return c.jsx(Si.Provider,{value:i,children:e})}function vf(){const e=D.useContext(Si);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const _f=e=>!!e.panZoom;function Qn(){const e=ff(),t=ae(),n=vf(),o=ne(_f),r=D.useMemo(()=>{const s=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},a=d=>{n.edgeQueue.push(d)},l=d=>{const{nodeLookup:f,nodeOrigin:y}=t.getState(),p=Ko(d)?d:f.get(d.id),x=p.parentId?Kr(p.position,p.measured,p.parentId,f,y):p.position,w={...p,position:x,width:p.measured?.width??p.width,height:p.measured?.height??p.height};return qe(w)},u=(d,f,y={replace:!1})=>{i(p=>p.map(x=>{if(x.id===d){const w=typeof f=="function"?f(x):f;return y.replace&&Ko(w)?w:{...x,...w}}return x}))},h=(d,f,y={replace:!1})=>{a(p=>p.map(x=>{if(x.id===d){const w=typeof f=="function"?f(x):f;return y.replace&&mf(w)?w:{...x,...w}}return x}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>s(d)?.internals.userNode,getInternalNode:s,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:a,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(y=>[...y,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(y=>[...y,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:y}=t.getState(),[p,x,w]=y;return{nodes:d.map(m=>({...m})),edges:f.map(m=>({...m})),viewport:{x:p,y:x,zoom:w}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:y,edges:p,onNodesDelete:x,onEdgesDelete:w,triggerNodeChanges:m,triggerEdgeChanges:b,onDelete:g,onBeforeDelete:v}=t.getState(),{nodes:C,edges:S}=await Zu({nodesToRemove:d,edgesToRemove:f,nodes:y,edges:p,onBeforeDelete:v}),j=S.length>0,A=C.length>0;if(j){const P=S.map(Uo);w?.(S),b(P)}if(A){const P=C.map(Uo);x?.(C),m(P)}return(A||j)&&g?.({nodes:C,edges:S}),{deletedNodes:C,deletedEdges:S}},getIntersectingNodes:(d,f=!0,y)=>{const p=No(d),x=p?d:l(d),w=y!==void 0;return x?(y||t.getState().nodes).filter(m=>{const b=t.getState().nodeLookup.get(m.id);if(b&&!p&&(m.id===d.id||!b.internals.positionAbsolute))return!1;const g=qe(w?m:b),v=xt(g,x);return f&&v>0||v>=g.width*g.height||v>=x.width*x.height}):[]},isNodeIntersecting:(d,f,y=!0)=>{const x=No(d)?d:l(d);if(!x)return!1;const w=xt(x,f);return y&&w>0||w>=f.width*f.height||w>=x.width*x.height},updateNode:u,updateNodeData:(d,f,y={replace:!1})=>{u(d,p=>{const x=typeof f=="function"?f(p):f;return y.replace?{...p,data:x}:{...p,data:{...p.data,...x}}},y)},updateEdge:h,updateEdgeData:(d,f,y={replace:!1})=>{h(d,p=>{const x=typeof f=="function"?f(p):f;return y.replace?{...p,data:x}:{...p,data:{...p.data,...x}}},y)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:y}=t.getState();return Fu(d,{nodeLookup:f,nodeOrigin:y})},getHandleConnections:({type:d,id:f,nodeId:y})=>Array.from(t.getState().connectionLookup.get(`${y}-${d}${f?`-${f}`:""}`)?.values()??[]),getNodeConnections:({type:d,handleId:f,nodeId:y})=>Array.from(t.getState().connectionLookup.get(`${y}${d?f?`-${d}-${f}`:`-${d}`:""}`)?.values()??[]),fitView:async d=>{const f=t.getState().fitViewResolver??Ku();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:f}),n.nodeQueue.push(y=>[...y]),f.promise}}},[]);return D.useMemo(()=>({...r,...e,viewportInitialized:o}),[o])}const Jo=e=>e.selected,bf=typeof window<"u"?window:void 0;function Sf({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ae(),{deleteElements:o}=Qn(),r=vt(e,{actInsideInputWithModifier:!1}),s=vt(t,{target:bf});D.useEffect(()=>{if(r){const{edges:i,nodes:a}=n.getState();o({nodes:a.filter(Jo),edges:i.filter(Jo)}),n.setState({nodesSelectionActive:!1})}},[r]),D.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function Ef(e){const t=ae();D.useEffect(()=>{const n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const o=Yn(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",we.error004()),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const cn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Cf=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function jf({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:s=De.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:u,minZoom:h,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:y=!0,children:p,noWheelClassName:x,noPanClassName:w,onViewportChange:m,isControlledViewport:b,paneClickDistance:g,selectionOnDrag:v}){const C=ae(),S=D.useRef(null),{userSelectionActive:j,lib:A,connectionInProgress:P}=ne(Cf,se),V=vt(f),I=D.useRef();Ef(S);const T=D.useCallback(R=>{m?.({x:R[0],y:R[1],zoom:R[2]}),b||C.setState({transform:R})},[m,b]);return D.useEffect(()=>{if(S.current){I.current=Dd({domNode:S.current,minZoom:h,maxZoom:d,translateExtent:u,viewport:l,onDraggingChange:E=>C.setState({paneDragging:E}),onPanZoomStart:(E,M)=>{const{onViewportChangeStart:k,onMoveStart:z}=C.getState();z?.(E,M),k?.(M)},onPanZoom:(E,M)=>{const{onViewportChange:k,onMove:z}=C.getState();z?.(E,M),k?.(M)},onPanZoomEnd:(E,M)=>{const{onViewportChangeEnd:k,onMoveEnd:z}=C.getState();z?.(E,M),k?.(M)}});const{x:R,y:_,zoom:N}=I.current.getViewport();return C.setState({panZoom:I.current,transform:[R,_,N],domNode:S.current.closest(".react-flow")}),()=>{I.current?.destroy()}}},[]),D.useEffect(()=>{I.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:V,preventScrolling:y,noPanClassName:w,userSelectionActive:j,noWheelClassName:x,lib:A,onTransformChange:T,connectionInProgress:P,selectionOnDrag:v,paneClickDistance:g})},[e,t,n,o,r,s,i,a,V,y,w,j,x,A,T,P,v,g]),c.jsx("div",{className:"react-flow__renderer",ref:S,style:cn,children:p})}const Nf=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function kf(){const{userSelectionActive:e,userSelectionRect:t}=ne(Nf,se);return e&&t?c.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const _n=(e,t)=>n=>{n.target===t.current&&e?.(n)},Mf=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function If({isSelecting:e,selectionKeyPressed:t,selectionMode:n=yt.Full,panOnDrag:o,paneClickDistance:r,selectionOnDrag:s,onSelectionStart:i,onSelectionEnd:a,onPaneClick:l,onPaneContextMenu:u,onPaneScroll:h,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:y,children:p}){const x=ae(),{userSelectionActive:w,elementsSelectable:m,dragging:b,connectionInProgress:g}=ne(Mf,se),v=m&&(e||w),C=D.useRef(null),S=D.useRef(),j=D.useRef(new Set),A=D.useRef(new Set),P=D.useRef(!1),V=k=>{if(P.current||g){P.current=!1;return}l?.(k),x.getState().resetSelectedElements(),x.setState({nodesSelectionActive:!1})},I=k=>{if(Array.isArray(o)&&o?.includes(2)){k.preventDefault();return}u?.(k)},T=h?k=>h(k):void 0,R=k=>{P.current&&(k.stopPropagation(),P.current=!1)},_=k=>{const{domNode:z}=x.getState();if(S.current=z?.getBoundingClientRect(),!S.current)return;const $=k.target===C.current;if(!$&&!!k.target.closest(".nokey")||!e||!(s&&$||t)||k.button!==0||!k.isPrimary)return;k.target?.setPointerCapture?.(k.pointerId),P.current=!1;const{x:W,y:O}=me(k.nativeEvent,S.current);x.setState({userSelectionRect:{width:0,height:0,startX:W,startY:O,x:W,y:O}}),$||(k.stopPropagation(),k.preventDefault())},N=k=>{const{userSelectionRect:z,transform:$,nodeLookup:H,edgeLookup:L,connectionLookup:W,triggerNodeChanges:O,triggerEdgeChanges:q,defaultEdgeOptions:J,resetSelectedElements:G}=x.getState();if(!S.current||!z)return;const{x:B,y:Y}=me(k.nativeEvent,S.current),{startX:te,startY:ee}=z;if(!P.current){const re=t?0:r;if(Math.hypot(B-te,Y-ee)<=re)return;G(),i?.(k)}P.current=!0;const U={startX:te,startY:ee,x:B<te?B:te,y:Y<ee?Y:ee,width:Math.abs(B-te),height:Math.abs(Y-ee)},K=j.current,oe=A.current;j.current=new Set(Wn(H,U,$,n===yt.Partial,!0).map(re=>re.id)),A.current=new Set;const ie=J?.selectable??!0;for(const re of j.current){const le=W.get(re);if(le)for(const{edgeId:je}of le.values()){const _e=L.get(je);_e&&(_e.selectable??ie)&&A.current.add(je)}}if(!ko(K,j.current)){const re=Oe(H,j.current,!0);O(re)}if(!ko(oe,A.current)){const re=Oe(L,A.current);q(re)}x.setState({userSelectionRect:U,userSelectionActive:!0,nodesSelectionActive:!1})},E=k=>{k.button===0&&(k.target?.releasePointerCapture?.(k.pointerId),!w&&k.target===C.current&&x.getState().userSelectionRect&&V?.(k),x.setState({userSelectionActive:!1,userSelectionRect:null}),P.current&&(a?.(k),x.setState({nodesSelectionActive:j.current.size>0})))},M=o===!0||Array.isArray(o)&&o.includes(0);return c.jsxs("div",{className:ce(["react-flow__pane",{draggable:M,dragging:b,selection:e}]),onClick:v?void 0:_n(V,C),onContextMenu:_n(I,C),onWheel:_n(T,C),onPointerEnter:v?void 0:d,onPointerMove:v?N:f,onPointerUp:v?E:void 0,onPointerDownCapture:v?_:void 0,onClickCapture:v?R:void 0,onPointerLeave:y,ref:C,style:cn,children:[p,c.jsx(kf,{})]})}function Tn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:l}=t.getState(),u=a.get(e);if(!u){l?.("012",we.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&i)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([e])}function Ei({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:s,nodeClickDistance:i}){const a=ae(),[l,u]=D.useState(!1),h=D.useRef();return D.useEffect(()=>{h.current=vd({getStoreItems:()=>a.getState(),onNodeMouseDown:d=>{Tn({id:d,store:a,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),D.useEffect(()=>{if(t)h.current?.destroy();else if(e.current)return h.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:s,nodeId:r,nodeClickDistance:i}),()=>{h.current?.destroy()}},[n,o,t,s,e,r]),l}const zf=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Ci(){const e=ae();return D.useCallback(n=>{const{nodeExtent:o,snapToGrid:r,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:l,nodeLookup:u,nodeOrigin:h}=e.getState(),d=new Map,f=zf(i),y=r?s[0]:5,p=r?s[1]:5,x=n.direction.x*y*n.factor,w=n.direction.y*p*n.factor;for(const[,m]of u){if(!f(m))continue;let b={x:m.internals.positionAbsolute.x+x,y:m.internals.positionAbsolute.y+w};r&&(b=Et(b,s));const{position:g,positionAbsolute:v}=Yr({nodeId:m.id,nextPosition:b,nodeLookup:u,nodeExtent:o,nodeOrigin:h,onError:a});m.position=g,m.internals.positionAbsolute=v,d.set(m.id,m)}l(d)},[])}const Jn=D.createContext(null),Pf=Jn.Provider;Jn.Consumer;const ji=()=>D.useContext(Jn),Af=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Df=(e,t,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:s,connection:i}=o,{fromHandle:a,toHandle:l,isValid:u}=i,h=l?.nodeId===e&&l?.id===t&&l?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:h,clickConnecting:r?.nodeId===e&&r?.id===t&&r?.type===n,isPossibleEndHandle:s===Ze.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:h&&u}};function Tf({type:e="source",position:t=X.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:l,className:u,onMouseDown:h,onTouchStart:d,...f},y){const p=i||null,x=e==="target",w=ae(),m=ji(),{connectOnClick:b,noPanClassName:g,rfId:v}=ne(Af,se),{connectingFrom:C,connectingTo:S,clickConnecting:j,isPossibleEndHandle:A,connectionInProcess:P,clickConnectionInProcess:V,valid:I}=ne(Df(m,p,e),se);m||w.getState().onError?.("010",we.error010());const T=N=>{const{defaultEdgeOptions:E,onConnect:M,hasDefaultEdges:k}=w.getState(),z={...E,...N};if(k){const{edges:$,setEdges:H}=w.getState();H(rd(z,$))}M?.(z),a?.(z)},R=N=>{if(!m)return;const E=ei(N.nativeEvent);if(r&&(E&&N.button===0||!E)){const M=w.getState();Dn.onPointerDown(N.nativeEvent,{handleDomNode:N.currentTarget,autoPanOnConnect:M.autoPanOnConnect,connectionMode:M.connectionMode,connectionRadius:M.connectionRadius,domNode:M.domNode,nodeLookup:M.nodeLookup,lib:M.lib,isTarget:x,handleId:p,nodeId:m,flowId:M.rfId,panBy:M.panBy,cancelConnection:M.cancelConnection,onConnectStart:M.onConnectStart,onConnectEnd:M.onConnectEnd,updateConnection:M.updateConnection,onConnect:T,isValidConnection:n||M.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:M.autoPanSpeed,dragThreshold:M.connectionDragThreshold})}E?h?.(N):d?.(N)},_=N=>{const{onClickConnectStart:E,onClickConnectEnd:M,connectionClickStartHandle:k,connectionMode:z,isValidConnection:$,lib:H,rfId:L,nodeLookup:W,connection:O}=w.getState();if(!m||!k&&!r)return;if(!k){E?.(N.nativeEvent,{nodeId:m,handleId:p,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:m,type:e,id:p}});return}const q=Qr(N.target),J=n||$,{connection:G,isValid:B}=Dn.isValid(N.nativeEvent,{handle:{nodeId:m,id:p,type:e},connectionMode:z,fromNodeId:k.nodeId,fromHandleId:k.id||null,fromType:k.type,isValidConnection:J,flowId:L,doc:q,lib:H,nodeLookup:W});B&&G&&T(G);const Y=structuredClone(O);delete Y.inProgress,Y.toPosition=Y.toHandle?Y.toHandle.position:null,M?.(N,Y),w.setState({connectionClickStartHandle:null})};return c.jsx("div",{"data-handleid":p,"data-nodeid":m,"data-handlepos":t,"data-id":`${v}-${m}-${p}-${e}`,className:ce(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",g,u,{source:!x,target:x,connectable:o,connectablestart:r,connectableend:s,clickconnecting:j,connectingfrom:C,connectingto:S,valid:I,connectionindicator:o&&(!P||A)&&(P||V?s:r)}]),onMouseDown:R,onTouchStart:R,onClick:b?_:void 0,ref:y,...f,children:l})}const Qe=D.memo(bi(Tf));function $f({data:e,isConnectable:t,sourcePosition:n=X.Bottom}){return c.jsxs(c.Fragment,{children:[e?.label,c.jsx(Qe,{type:"source",position:n,isConnectable:t})]})}function Rf({data:e,isConnectable:t,targetPosition:n=X.Top,sourcePosition:o=X.Bottom}){return c.jsxs(c.Fragment,{children:[c.jsx(Qe,{type:"target",position:n,isConnectable:t}),e?.label,c.jsx(Qe,{type:"source",position:o,isConnectable:t})]})}function Lf(){return null}function Hf({data:e,isConnectable:t,targetPosition:n=X.Top}){return c.jsxs(c.Fragment,{children:[c.jsx(Qe,{type:"target",position:n,isConnectable:t}),e?.label]})}const Ut={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},er={input:$f,default:Rf,output:Hf,group:Lf};function Vf(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const Bf=e=>{const{width:t,height:n,x:o,y:r}=St(e.nodeLookup,{filter:s=>!!s.selected});return{width:ge(t)?t:null,height:ge(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function Of({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ae(),{width:r,height:s,transformString:i,userSelectionActive:a}=ne(Bf,se),l=Ci(),u=D.useRef(null);if(D.useEffect(()=>{n||u.current?.focus({preventScroll:!0})},[n]),Ei({nodeRef:u}),a||!r||!s)return null;const h=e?f=>{const y=o.getState().nodes.filter(p=>p.selected);e(f,y)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(Ut,f.key)&&(f.preventDefault(),l({direction:Ut[f.key],factor:f.shiftKey?4:1}))};return c.jsx("div",{className:ce(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:c.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:r,height:s}})})}const tr=typeof window<"u"?window:void 0,Ff=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Ni({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:u,selectionOnDrag:h,selectionMode:d,onSelectionStart:f,onSelectionEnd:y,multiSelectionKeyCode:p,panActivationKeyCode:x,zoomActivationKeyCode:w,elementsSelectable:m,zoomOnScroll:b,zoomOnPinch:g,panOnScroll:v,panOnScrollSpeed:C,panOnScrollMode:S,zoomOnDoubleClick:j,panOnDrag:A,defaultViewport:P,translateExtent:V,minZoom:I,maxZoom:T,preventScrolling:R,onSelectionContextMenu:_,noWheelClassName:N,noPanClassName:E,disableKeyboardA11y:M,onViewportChange:k,isControlledViewport:z}){const{nodesSelectionActive:$,userSelectionActive:H}=ne(Ff,se),L=vt(u,{target:tr}),W=vt(x,{target:tr}),O=W||A,q=W||v,J=h&&O!==!0,G=L||H||J;return Sf({deleteKeyCode:l,multiSelectionKeyCode:p}),c.jsx(jf,{onPaneContextMenu:s,elementsSelectable:m,zoomOnScroll:b,zoomOnPinch:g,panOnScroll:q,panOnScrollSpeed:C,panOnScrollMode:S,zoomOnDoubleClick:j,panOnDrag:!L&&O,defaultViewport:P,translateExtent:V,minZoom:I,maxZoom:T,zoomActivationKeyCode:w,preventScrolling:R,noWheelClassName:N,noPanClassName:E,onViewportChange:k,isControlledViewport:z,paneClickDistance:a,selectionOnDrag:J,children:c.jsxs(If,{onSelectionStart:f,onSelectionEnd:y,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:O,isSelecting:!!G,selectionMode:d,selectionKeyPressed:L,paneClickDistance:a,selectionOnDrag:J,children:[e,$&&c.jsx(Of,{onSelectionContextMenu:_,noPanClassName:E,disableKeyboardA11y:M})]})})}Ni.displayName="FlowRenderer";const Wf=D.memo(Ni),Xf=e=>t=>e?Wn(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Yf(e){return ne(D.useCallback(Xf(e),[e]),se)}const Zf=e=>e.updateNodeInternals;function Gf(){const e=ne(Zf),[t]=D.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(r=>{const s=r.target.getAttribute("data-id");o.set(s,{id:s,nodeElement:r.target,force:!0})}),e(o)}));return D.useEffect(()=>()=>{t?.disconnect()},[t]),t}function qf({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const r=ae(),s=D.useRef(null),i=D.useRef(null),a=D.useRef(e.sourcePosition),l=D.useRef(e.targetPosition),u=D.useRef(t),h=n&&!!e.internals.handleBounds;return D.useEffect(()=>{s.current&&!e.hidden&&(!h||i.current!==s.current)&&(i.current&&o?.unobserve(i.current),o?.observe(s.current),i.current=s.current)},[h,e.hidden]),D.useEffect(()=>()=>{i.current&&(o?.unobserve(i.current),i.current=null)},[]),D.useEffect(()=>{if(s.current){const d=u.current!==t,f=a.current!==e.sourcePosition,y=l.current!==e.targetPosition;(d||f||y)&&(u.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function Uf({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:l,nodesConnectable:u,nodesFocusable:h,resizeObserver:d,noDragClassName:f,noPanClassName:y,disableKeyboardA11y:p,rfId:x,nodeTypes:w,nodeClickDistance:m,onError:b}){const{node:g,internals:v,isParent:C}=ne(B=>{const Y=B.nodeLookup.get(e),te=B.parentLookup.has(e);return{node:Y,internals:Y.internals,isParent:te}},se);let S=g.type||"default",j=w?.[S]||er[S];j===void 0&&(b?.("003",we.error003(S)),S="default",j=w?.default||er.default);const A=!!(g.draggable||a&&typeof g.draggable>"u"),P=!!(g.selectable||l&&typeof g.selectable>"u"),V=!!(g.connectable||u&&typeof g.connectable>"u"),I=!!(g.focusable||h&&typeof g.focusable>"u"),T=ae(),R=Ur(g),_=qf({node:g,nodeType:S,hasDimensions:R,resizeObserver:d}),N=Ei({nodeRef:_,disabled:g.hidden||!A,noDragClassName:f,handleSelector:g.dragHandle,nodeId:e,isSelectable:P,nodeClickDistance:m}),E=Ci();if(g.hidden)return null;const M=Ce(g),k=Vf(g),z=P||A||t||n||o||r,$=n?B=>n(B,{...v.userNode}):void 0,H=o?B=>o(B,{...v.userNode}):void 0,L=r?B=>r(B,{...v.userNode}):void 0,W=s?B=>s(B,{...v.userNode}):void 0,O=i?B=>i(B,{...v.userNode}):void 0,q=B=>{const{selectNodesOnDrag:Y,nodeDragThreshold:te}=T.getState();P&&(!Y||!A||te>0)&&Tn({id:e,store:T,nodeRef:_}),t&&t(B,{...v.userNode})},J=B=>{if(!(Jr(B.nativeEvent)||p)){if(Br.includes(B.key)&&P){const Y=B.key==="Escape";Tn({id:e,store:T,unselect:Y,nodeRef:_})}else if(A&&g.selected&&Object.prototype.hasOwnProperty.call(Ut,B.key)){B.preventDefault();const{ariaLabelConfig:Y}=T.getState();T.setState({ariaLiveMessage:Y["node.a11yDescription.ariaLiveMessage"]({direction:B.key.replace("Arrow","").toLowerCase(),x:~~v.positionAbsolute.x,y:~~v.positionAbsolute.y})}),E({direction:Ut[B.key],factor:B.shiftKey?4:1})}}},G=()=>{if(p||!_.current?.matches(":focus-visible"))return;const{transform:B,width:Y,height:te,autoPanOnNodeFocus:ee,setCenter:U}=T.getState();if(!ee)return;Wn(new Map([[e,g]]),{x:0,y:0,width:Y,height:te},B,!0).length>0||U(g.position.x+M.width/2,g.position.y+M.height/2,{zoom:B[2]})};return c.jsx("div",{className:ce(["react-flow__node",`react-flow__node-${S}`,{[y]:A},g.className,{selected:g.selected,selectable:P,parent:C,draggable:A,dragging:N}]),ref:_,style:{zIndex:v.z,transform:`translate(${v.positionAbsolute.x}px,${v.positionAbsolute.y}px)`,pointerEvents:z?"all":"none",visibility:R?"visible":"hidden",...g.style,...k},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:$,onMouseMove:H,onMouseLeave:L,onContextMenu:W,onClick:q,onDoubleClick:O,onKeyDown:I?J:void 0,tabIndex:I?0:void 0,onFocus:I?G:void 0,role:g.ariaRole??(I?"group":void 0),"aria-roledescription":"node","aria-describedby":p?void 0:`${xi}-${x}`,"aria-label":g.ariaLabel,...g.domAttributes,children:c.jsx(Pf,{value:e,children:c.jsx(j,{id:e,data:g.data,type:S,positionAbsoluteX:v.positionAbsolute.x,positionAbsoluteY:v.positionAbsolute.y,selected:g.selected??!1,selectable:P,draggable:A,deletable:g.deletable??!0,isConnectable:V,sourcePosition:g.sourcePosition,targetPosition:g.targetPosition,dragging:N,dragHandle:g.dragHandle,zIndex:v.z,parentId:g.parentId,...M})})})}var Kf=D.memo(Uf);const Qf=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function ki(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:s}=ne(Qf,se),i=Yf(e.onlyRenderVisibleElements),a=Gf();return c.jsx("div",{className:"react-flow__nodes",style:cn,children:i.map(l=>c.jsx(Kf,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:s},l))})}ki.displayName="NodeRenderer";const Jf=D.memo(ki);function eh(e){return ne(D.useCallback(n=>{if(!e)return n.edges.map(r=>r.id);const o=[];if(n.width&&n.height)for(const r of n.edges){const s=n.nodeLookup.get(r.source),i=n.nodeLookup.get(r.target);s&&i&&td({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[e]),se)}const th=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return c.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},nh=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return c.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},nr={[Zt.Arrow]:th,[Zt.ArrowClosed]:nh};function oh(e){const t=ae();return D.useMemo(()=>Object.prototype.hasOwnProperty.call(nr,e)?nr[e]:(t.getState().onError?.("009",we.error009(e)),null),[e])}const rh=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const l=oh(t);return l?c.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:c.jsx(l,{color:n,strokeWidth:i})}):null},Mi=({defaultColor:e,rfId:t})=>{const n=ne(s=>s.edges),o=ne(s=>s.defaultEdgeOptions),r=D.useMemo(()=>ld(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return r.length?c.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:c.jsx("defs",{children:r.map(s=>c.jsx(rh,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Mi.displayName="MarkerDefinitions";var ih=D.memo(Mi);function Ii({x:e,y:t,label:n,labelStyle:o,labelShowBg:r=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:l,className:u,...h}){const[d,f]=D.useState({x:1,y:0,width:0,height:0}),y=ce(["react-flow__edge-textwrapper",u]),p=D.useRef(null);return D.useEffect(()=>{if(p.current){const x=p.current.getBBox();f({x:x.x,y:x.y,width:x.width,height:x.height})}},[n]),n?c.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:y,visibility:d.width?"visible":"hidden",...h,children:[r&&c.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),c.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:p,style:o,children:n}),l]}):null}Ii.displayName="EdgeText";const sh=D.memo(Ii);function ln({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:u=20,...h}){return c.jsxs(c.Fragment,{children:[c.jsx("path",{...h,d:e,fill:"none",className:ce(["react-flow__edge-path",h.className])}),u?c.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,o&&ge(t)&&ge(n)?c.jsx(sh,{x:t,y:n,label:o,labelStyle:r,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function or({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===X.Left||e===X.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function zi({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:s=X.Top}){const[i,a]=or({pos:n,x1:e,y1:t,x2:o,y2:r}),[l,u]=or({pos:s,x1:o,y1:r,x2:e,y2:t}),[h,d,f,y]=ti({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:i,sourceControlY:a,targetControlX:l,targetControlY:u});return[`M${e},${t} C${i},${a} ${l},${u} ${o},${r}`,h,d,f,y]}function Pi(e){return D.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,sourcePosition:i,targetPosition:a,label:l,labelStyle:u,labelShowBg:h,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:y,style:p,markerEnd:x,markerStart:w,interactionWidth:m})=>{const[b,g,v]=zi({sourceX:n,sourceY:o,sourcePosition:i,targetX:r,targetY:s,targetPosition:a}),C=e.isInternal?void 0:t;return c.jsx(ln,{id:C,path:b,labelX:g,labelY:v,label:l,labelStyle:u,labelShowBg:h,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:y,style:p,markerEnd:x,markerStart:w,interactionWidth:m})})}const ah=Pi({isInternal:!1}),Ai=Pi({isInternal:!0});ah.displayName="SimpleBezierEdge";Ai.displayName="SimpleBezierEdgeInternal";function Di(e){return D.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:d,style:f,sourcePosition:y=X.Bottom,targetPosition:p=X.Top,markerEnd:x,markerStart:w,pathOptions:m,interactionWidth:b})=>{const[g,v,C]=zn({sourceX:n,sourceY:o,sourcePosition:y,targetX:r,targetY:s,targetPosition:p,borderRadius:m?.borderRadius,offset:m?.offset,stepPosition:m?.stepPosition}),S=e.isInternal?void 0:t;return c.jsx(ln,{id:S,path:g,labelX:v,labelY:C,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:x,markerStart:w,interactionWidth:b})})}const Ti=Di({isInternal:!1}),$i=Di({isInternal:!0});Ti.displayName="SmoothStepEdge";$i.displayName="SmoothStepEdgeInternal";function Ri(e){return D.memo(({id:t,...n})=>{const o=e.isInternal?void 0:t;return c.jsx(Ti,{...n,id:o,pathOptions:D.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const ch=Ri({isInternal:!1}),Li=Ri({isInternal:!0});ch.displayName="StepEdge";Li.displayName="StepEdgeInternal";function Hi(e){return D.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:y,markerStart:p,interactionWidth:x})=>{const[w,m,b]=ri({sourceX:n,sourceY:o,targetX:r,targetY:s}),g=e.isInternal?void 0:t;return c.jsx(ln,{id:g,path:w,labelX:m,labelY:b,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:y,markerStart:p,interactionWidth:x})})}const lh=Hi({isInternal:!1}),Vi=Hi({isInternal:!0});lh.displayName="StraightEdge";Vi.displayName="StraightEdgeInternal";function Bi(e){return D.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,sourcePosition:i=X.Bottom,targetPosition:a=X.Top,label:l,labelStyle:u,labelShowBg:h,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:y,style:p,markerEnd:x,markerStart:w,pathOptions:m,interactionWidth:b})=>{const[g,v,C]=ni({sourceX:n,sourceY:o,sourcePosition:i,targetX:r,targetY:s,targetPosition:a,curvature:m?.curvature}),S=e.isInternal?void 0:t;return c.jsx(ln,{id:S,path:g,labelX:v,labelY:C,label:l,labelStyle:u,labelShowBg:h,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:y,style:p,markerEnd:x,markerStart:w,interactionWidth:b})})}const uh=Bi({isInternal:!1}),Oi=Bi({isInternal:!0});uh.displayName="BezierEdge";Oi.displayName="BezierEdgeInternal";const rr={default:Oi,straight:Vi,step:Li,smoothstep:$i,simplebezier:Ai},ir={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},dh=(e,t,n)=>n===X.Left?e-t:n===X.Right?e+t:e,fh=(e,t,n)=>n===X.Top?e-t:n===X.Bottom?e+t:e,sr="react-flow__edgeupdater";function ar({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:s,onMouseOut:i,type:a}){return c.jsx("circle",{onMouseDown:r,onMouseEnter:s,onMouseOut:i,className:ce([sr,`${sr}-${a}`]),cx:dh(t,o,e),cy:fh(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function hh({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:s,targetY:i,sourcePosition:a,targetPosition:l,onReconnect:u,onReconnectStart:h,onReconnectEnd:d,setReconnecting:f,setUpdateHover:y}){const p=ae(),x=(v,C)=>{if(v.button!==0)return;const{autoPanOnConnect:S,domNode:j,isValidConnection:A,connectionMode:P,connectionRadius:V,lib:I,onConnectStart:T,onConnectEnd:R,cancelConnection:_,nodeLookup:N,rfId:E,panBy:M,updateConnection:k}=p.getState(),z=C.type==="target",$=(W,O)=>{f(!1),d?.(W,n,C.type,O)},H=W=>u?.(n,W),L=(W,O)=>{f(!0),h?.(v,n,C.type),T?.(W,O)};Dn.onPointerDown(v.nativeEvent,{autoPanOnConnect:S,connectionMode:P,connectionRadius:V,domNode:j,handleId:C.id,nodeId:C.nodeId,nodeLookup:N,isTarget:z,edgeUpdaterType:C.type,lib:I,flowId:E,cancelConnection:_,panBy:M,isValidConnection:A,onConnect:H,onConnectStart:L,onConnectEnd:R,onReconnectEnd:$,updateConnection:k,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle,dragThreshold:p.getState().connectionDragThreshold,handleDomNode:v.currentTarget})},w=v=>x(v,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),m=v=>x(v,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),b=()=>y(!0),g=()=>y(!1);return c.jsxs(c.Fragment,{children:[(e===!0||e==="source")&&c.jsx(ar,{position:a,centerX:o,centerY:r,radius:t,onMouseDown:w,onMouseEnter:b,onMouseOut:g,type:"source"}),(e===!0||e==="target")&&c.jsx(ar,{position:l,centerX:s,centerY:i,radius:t,onMouseDown:m,onMouseEnter:b,onMouseOut:g,type:"target"})]})}function ph({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:u,reconnectRadius:h,onReconnect:d,onReconnectStart:f,onReconnectEnd:y,rfId:p,edgeTypes:x,noPanClassName:w,onError:m,disableKeyboardA11y:b}){let g=ne(U=>U.edgeLookup.get(e));const v=ne(U=>U.defaultEdgeOptions);g=v?{...v,...g}:g;let C=g.type||"default",S=x?.[C]||rr[C];S===void 0&&(m?.("011",we.error011(C)),C="default",S=x?.default||rr.default);const j=!!(g.focusable||t&&typeof g.focusable>"u"),A=typeof d<"u"&&(g.reconnectable||n&&typeof g.reconnectable>"u"),P=!!(g.selectable||o&&typeof g.selectable>"u"),V=D.useRef(null),[I,T]=D.useState(!1),[R,_]=D.useState(!1),N=ae(),{zIndex:E,sourceX:M,sourceY:k,targetX:z,targetY:$,sourcePosition:H,targetPosition:L}=ne(D.useCallback(U=>{const K=U.nodeLookup.get(g.source),oe=U.nodeLookup.get(g.target);if(!K||!oe)return{zIndex:g.zIndex,...ir};const ie=cd({id:e,sourceNode:K,targetNode:oe,sourceHandle:g.sourceHandle||null,targetHandle:g.targetHandle||null,connectionMode:U.connectionMode,onError:m});return{zIndex:ed({selected:g.selected,zIndex:g.zIndex,sourceNode:K,targetNode:oe,elevateOnSelect:U.elevateEdgesOnSelect,zIndexMode:U.zIndexMode}),...ie||ir}},[g.source,g.target,g.sourceHandle,g.targetHandle,g.selected,g.zIndex]),se),W=D.useMemo(()=>g.markerStart?`url('#${Pn(g.markerStart,p)}')`:void 0,[g.markerStart,p]),O=D.useMemo(()=>g.markerEnd?`url('#${Pn(g.markerEnd,p)}')`:void 0,[g.markerEnd,p]);if(g.hidden||M===null||k===null||z===null||$===null)return null;const q=U=>{const{addSelectedEdges:K,unselectNodesAndEdges:oe,multiSelectionActive:ie}=N.getState();P&&(N.setState({nodesSelectionActive:!1}),g.selected&&ie?(oe({nodes:[],edges:[g]}),V.current?.blur()):K([e])),r&&r(U,g)},J=s?U=>{s(U,{...g})}:void 0,G=i?U=>{i(U,{...g})}:void 0,B=a?U=>{a(U,{...g})}:void 0,Y=l?U=>{l(U,{...g})}:void 0,te=u?U=>{u(U,{...g})}:void 0,ee=U=>{if(!b&&Br.includes(U.key)&&P){const{unselectNodesAndEdges:K,addSelectedEdges:oe}=N.getState();U.key==="Escape"?(V.current?.blur(),K({edges:[g]})):oe([e])}};return c.jsx("svg",{style:{zIndex:E},children:c.jsxs("g",{className:ce(["react-flow__edge",`react-flow__edge-${C}`,g.className,w,{selected:g.selected,animated:g.animated,inactive:!P&&!r,updating:I,selectable:P}]),onClick:q,onDoubleClick:J,onContextMenu:G,onMouseEnter:B,onMouseMove:Y,onMouseLeave:te,onKeyDown:j?ee:void 0,tabIndex:j?0:void 0,role:g.ariaRole??(j?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":g.ariaLabel===null?void 0:g.ariaLabel||`Edge from ${g.source} to ${g.target}`,"aria-describedby":j?`${wi}-${p}`:void 0,ref:V,...g.domAttributes,children:[!R&&c.jsx(S,{id:e,source:g.source,target:g.target,type:g.type,selected:g.selected,animated:g.animated,selectable:P,deletable:g.deletable??!0,label:g.label,labelStyle:g.labelStyle,labelShowBg:g.labelShowBg,labelBgStyle:g.labelBgStyle,labelBgPadding:g.labelBgPadding,labelBgBorderRadius:g.labelBgBorderRadius,sourceX:M,sourceY:k,targetX:z,targetY:$,sourcePosition:H,targetPosition:L,data:g.data,style:g.style,sourceHandleId:g.sourceHandle,targetHandleId:g.targetHandle,markerStart:W,markerEnd:O,pathOptions:"pathOptions"in g?g.pathOptions:void 0,interactionWidth:g.interactionWidth}),A&&c.jsx(hh,{edge:g,isReconnectable:A,reconnectRadius:h,onReconnect:d,onReconnectStart:f,onReconnectEnd:y,sourceX:M,sourceY:k,targetX:z,targetY:$,sourcePosition:H,targetPosition:L,setUpdateHover:T,setReconnecting:_})]})})}var gh=D.memo(ph);const mh=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Fi({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:h,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:y,onReconnectEnd:p,disableKeyboardA11y:x}){const{edgesFocusable:w,edgesReconnectable:m,elementsSelectable:b,onError:g}=ne(mh,se),v=eh(t);return c.jsxs("div",{className:"react-flow__edges",children:[c.jsx(ih,{defaultColor:e,rfId:n}),v.map(C=>c.jsx(gh,{id:C,edgesFocusable:w,edgesReconnectable:m,elementsSelectable:b,noPanClassName:r,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:u,onClick:h,reconnectRadius:d,onDoubleClick:f,onReconnectStart:y,onReconnectEnd:p,rfId:n,onError:g,edgeTypes:o,disableKeyboardA11y:x},C))]})}Fi.displayName="EdgeRenderer";const yh=D.memo(Fi),xh=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function wh({children:e}){const t=ne(xh);return c.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function vh(e){const t=Qn(),n=D.useRef(!1);D.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const _h=e=>e.panZoom?.syncViewport;function bh(e){const t=ne(_h),n=ae();return D.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Sh(e){return e.connection.inProgress?{...e.connection,to:Ct(e.connection.to,e.transform)}:{...e.connection}}function Eh(e){return Sh}function Ch(e){const t=Eh();return ne(t,se)}const jh=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Nh({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:r,width:s,height:i,isValid:a,inProgress:l}=ne(jh,se);return!(s&&r&&l)?null:c.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:c.jsx("g",{className:ce(["react-flow__connection",Wr(a)]),children:c.jsx(Wi,{style:t,type:n,CustomComponent:o,isValid:a})})})}const Wi=({style:e,type:t=Me.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:r,from:s,fromNode:i,fromHandle:a,fromPosition:l,to:u,toNode:h,toHandle:d,toPosition:f,pointer:y}=Ch();if(!r)return;if(n)return c.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:u.x,toY:u.y,fromPosition:l,toPosition:f,connectionStatus:Wr(o),toNode:h,toHandle:d,pointer:y});let p="";const x={sourceX:s.x,sourceY:s.y,sourcePosition:l,targetX:u.x,targetY:u.y,targetPosition:f};switch(t){case Me.Bezier:[p]=ni(x);break;case Me.SimpleBezier:[p]=zi(x);break;case Me.Step:[p]=zn({...x,borderRadius:0});break;case Me.SmoothStep:[p]=zn(x);break;default:[p]=ri(x)}return c.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:e})};Wi.displayName="ConnectionLine";const kh={};function cr(e=kh){D.useRef(e),ae(),D.useEffect(()=>{},[e])}function Mh(){ae(),D.useRef(!1),D.useEffect(()=>{},[])}function Xi({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:u,onNodeContextMenu:h,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:y,connectionLineType:p,connectionLineStyle:x,connectionLineComponent:w,connectionLineContainerStyle:m,selectionKeyCode:b,selectionOnDrag:g,selectionMode:v,multiSelectionKeyCode:C,panActivationKeyCode:S,zoomActivationKeyCode:j,deleteKeyCode:A,onlyRenderVisibleElements:P,elementsSelectable:V,defaultViewport:I,translateExtent:T,minZoom:R,maxZoom:_,preventScrolling:N,defaultMarkerColor:E,zoomOnScroll:M,zoomOnPinch:k,panOnScroll:z,panOnScrollSpeed:$,panOnScrollMode:H,zoomOnDoubleClick:L,panOnDrag:W,onPaneClick:O,onPaneMouseEnter:q,onPaneMouseMove:J,onPaneMouseLeave:G,onPaneScroll:B,onPaneContextMenu:Y,paneClickDistance:te,nodeClickDistance:ee,onEdgeContextMenu:U,onEdgeMouseEnter:K,onEdgeMouseMove:oe,onEdgeMouseLeave:ie,reconnectRadius:re,onReconnect:le,onReconnectStart:je,onReconnectEnd:_e,noDragClassName:ze,noWheelClassName:Je,noPanClassName:et,disableKeyboardA11y:tt,nodeExtent:un,rfId:jt,viewport:He,onViewportChange:nt}){return cr(e),cr(t),Mh(),vh(n),bh(He),c.jsx(Wf,{onPaneClick:O,onPaneMouseEnter:q,onPaneMouseMove:J,onPaneMouseLeave:G,onPaneContextMenu:Y,onPaneScroll:B,paneClickDistance:te,deleteKeyCode:A,selectionKeyCode:b,selectionOnDrag:g,selectionMode:v,onSelectionStart:f,onSelectionEnd:y,multiSelectionKeyCode:C,panActivationKeyCode:S,zoomActivationKeyCode:j,elementsSelectable:V,zoomOnScroll:M,zoomOnPinch:k,zoomOnDoubleClick:L,panOnScroll:z,panOnScrollSpeed:$,panOnScrollMode:H,panOnDrag:W,defaultViewport:I,translateExtent:T,minZoom:R,maxZoom:_,onSelectionContextMenu:d,preventScrolling:N,noDragClassName:ze,noWheelClassName:Je,noPanClassName:et,disableKeyboardA11y:tt,onViewportChange:nt,isControlledViewport:!!He,children:c.jsxs(wh,{children:[c.jsx(yh,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:i,onReconnect:le,onReconnectStart:je,onReconnectEnd:_e,onlyRenderVisibleElements:P,onEdgeContextMenu:U,onEdgeMouseEnter:K,onEdgeMouseMove:oe,onEdgeMouseLeave:ie,reconnectRadius:re,defaultMarkerColor:E,noPanClassName:et,disableKeyboardA11y:tt,rfId:jt}),c.jsx(Nh,{style:x,type:p,component:w,containerStyle:m}),c.jsx("div",{className:"react-flow__edgelabel-renderer"}),c.jsx(Jf,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:u,onNodeContextMenu:h,nodeClickDistance:ee,onlyRenderVisibleElements:P,noPanClassName:et,noDragClassName:ze,disableKeyboardA11y:tt,nodeExtent:un,rfId:jt}),c.jsx("div",{className:"react-flow__viewport-portal"})]})})}Xi.displayName="GraphView";const Ih=D.memo(Xi),lr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:i,fitViewOptions:a,minZoom:l=.5,maxZoom:u=2,nodeOrigin:h,nodeExtent:d,zIndexMode:f="basic"}={})=>{const y=new Map,p=new Map,x=new Map,w=new Map,m=o??t??[],b=n??e??[],g=h??[0,0],v=d??mt;ai(x,w,m);const C=An(b,y,p,{nodeOrigin:g,nodeExtent:v,zIndexMode:f});let S=[0,0,1];if(i&&r&&s){const j=St(y,{filter:I=>!!((I.width||I.initialWidth)&&(I.height||I.initialHeight))}),{x:A,y:P,zoom:V}=Xn(j,r,s,l,u,a?.padding??.1);S=[A,P,V]}return{rfId:"1",width:r??0,height:s??0,transform:S,nodes:b,nodesInitialized:C,nodeLookup:y,parentLookup:p,edges:m,edgeLookup:w,connectionLookup:x,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:l,maxZoom:u,translateExtent:mt,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ze.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:g,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Fr},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Gu,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Or,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},zh=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:u,nodeOrigin:h,nodeExtent:d,zIndexMode:f})=>Yd((y,p)=>{async function x(){const{nodeLookup:w,panZoom:m,fitViewOptions:b,fitViewResolver:g,width:v,height:C,minZoom:S,maxZoom:j}=p();m&&(await Yu({nodes:w,width:v,height:C,panZoom:m,minZoom:S,maxZoom:j},b),g?.resolve(!0),y({fitViewResolver:null}))}return{...lr({nodes:e,edges:t,width:r,height:s,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:u,nodeOrigin:h,nodeExtent:d,defaultNodes:n,defaultEdges:o,zIndexMode:f}),setNodes:w=>{const{nodeLookup:m,parentLookup:b,nodeOrigin:g,elevateNodesOnSelect:v,fitViewQueued:C,zIndexMode:S}=p(),j=An(w,m,b,{nodeOrigin:g,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!0,zIndexMode:S});C&&j?(x(),y({nodes:w,nodesInitialized:j,fitViewQueued:!1,fitViewOptions:void 0})):y({nodes:w,nodesInitialized:j})},setEdges:w=>{const{connectionLookup:m,edgeLookup:b}=p();ai(m,b,w),y({edges:w})},setDefaultNodesAndEdges:(w,m)=>{if(w){const{setNodes:b}=p();b(w),y({hasDefaultNodes:!0})}if(m){const{setEdges:b}=p();b(m),y({hasDefaultEdges:!0})}},updateNodeInternals:w=>{const{triggerNodeChanges:m,nodeLookup:b,parentLookup:g,domNode:v,nodeOrigin:C,nodeExtent:S,debug:j,fitViewQueued:A,zIndexMode:P}=p(),{changes:V,updatedInternals:I}=md(w,b,g,v,C,S,P);I&&(fd(b,g,{nodeOrigin:C,nodeExtent:S,zIndexMode:P}),A?(x(),y({fitViewQueued:!1,fitViewOptions:void 0})):y({}),V?.length>0&&(j&&console.log("React Flow: trigger node changes",V),m?.(V)))},updateNodePositions:(w,m=!1)=>{const b=[];let g=[];const{nodeLookup:v,triggerNodeChanges:C,connection:S,updateConnection:j,onNodesChangeMiddlewareMap:A}=p();for(const[P,V]of w){const I=v.get(P),T=!!(I?.expandParent&&I?.parentId&&V?.position),R={id:P,type:"position",position:T?{x:Math.max(0,V.position.x),y:Math.max(0,V.position.y)}:V.position,dragging:m};if(I&&S.inProgress&&S.fromNode.id===I.id){const _=Re(I,S.fromHandle,X.Left,!0);j({...S,from:_})}T&&I.parentId&&b.push({id:P,parentId:I.parentId,rect:{...V.internals.positionAbsolute,width:V.measured.width??0,height:V.measured.height??0}}),g.push(R)}if(b.length>0){const{parentLookup:P,nodeOrigin:V}=p(),I=Kn(b,v,P,V);g.push(...I)}for(const P of A.values())g=P(g);C(g)},triggerNodeChanges:w=>{const{onNodesChange:m,setNodes:b,nodes:g,hasDefaultNodes:v,debug:C}=p();if(w?.length){if(v){const S=pf(w,g);b(S)}C&&console.log("React Flow: trigger node changes",w),m?.(w)}},triggerEdgeChanges:w=>{const{onEdgesChange:m,setEdges:b,edges:g,hasDefaultEdges:v,debug:C}=p();if(w?.length){if(v){const S=gf(w,g);b(S)}C&&console.log("React Flow: trigger edge changes",w),m?.(w)}},addSelectedNodes:w=>{const{multiSelectionActive:m,edgeLookup:b,nodeLookup:g,triggerNodeChanges:v,triggerEdgeChanges:C}=p();if(m){const S=w.map(j=>Ae(j,!0));v(S);return}v(Oe(g,new Set([...w]),!0)),C(Oe(b))},addSelectedEdges:w=>{const{multiSelectionActive:m,edgeLookup:b,nodeLookup:g,triggerNodeChanges:v,triggerEdgeChanges:C}=p();if(m){const S=w.map(j=>Ae(j,!0));C(S);return}C(Oe(b,new Set([...w]))),v(Oe(g,new Set,!0))},unselectNodesAndEdges:({nodes:w,edges:m}={})=>{const{edges:b,nodes:g,nodeLookup:v,triggerNodeChanges:C,triggerEdgeChanges:S}=p(),j=w||g,A=m||b,P=j.map(I=>{const T=v.get(I.id);return T&&(T.selected=!1),Ae(I.id,!1)}),V=A.map(I=>Ae(I.id,!1));C(P),S(V)},setMinZoom:w=>{const{panZoom:m,maxZoom:b}=p();m?.setScaleExtent([w,b]),y({minZoom:w})},setMaxZoom:w=>{const{panZoom:m,minZoom:b}=p();m?.setScaleExtent([b,w]),y({maxZoom:w})},setTranslateExtent:w=>{p().panZoom?.setTranslateExtent(w),y({translateExtent:w})},resetSelectedElements:()=>{const{edges:w,nodes:m,triggerNodeChanges:b,triggerEdgeChanges:g,elementsSelectable:v}=p();if(!v)return;const C=m.reduce((j,A)=>A.selected?[...j,Ae(A.id,!1)]:j,[]),S=w.reduce((j,A)=>A.selected?[...j,Ae(A.id,!1)]:j,[]);b(C),g(S)},setNodeExtent:w=>{const{nodes:m,nodeLookup:b,parentLookup:g,nodeOrigin:v,elevateNodesOnSelect:C,nodeExtent:S,zIndexMode:j}=p();w[0][0]===S[0][0]&&w[0][1]===S[0][1]&&w[1][0]===S[1][0]&&w[1][1]===S[1][1]||(An(m,b,g,{nodeOrigin:v,nodeExtent:w,elevateNodesOnSelect:C,checkEquality:!1,zIndexMode:j}),y({nodeExtent:w}))},panBy:w=>{const{transform:m,width:b,height:g,panZoom:v,translateExtent:C}=p();return yd({delta:w,panZoom:v,transform:m,translateExtent:C,width:b,height:g})},setCenter:async(w,m,b)=>{const{width:g,height:v,maxZoom:C,panZoom:S}=p();if(!S)return Promise.resolve(!1);const j=typeof b?.zoom<"u"?b.zoom:C;return await S.setViewport({x:g/2-w*j,y:v/2-m*j,zoom:j},{duration:b?.duration,ease:b?.ease,interpolate:b?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{y({connection:{...Fr}})},updateConnection:w=>{y({connection:w})},reset:()=>y({...lr()})}},Object.is);function $n({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:s,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:l,fitView:u,nodeOrigin:h,nodeExtent:d,zIndexMode:f,children:y}){const[p]=D.useState(()=>zh({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:u,minZoom:i,maxZoom:a,fitViewOptions:l,nodeOrigin:h,nodeExtent:d,zIndexMode:f}));return c.jsx(Zd,{value:p,children:c.jsx(wf,{children:y})})}function Ph({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:s,height:i,fitView:a,fitViewOptions:l,minZoom:u,maxZoom:h,nodeOrigin:d,nodeExtent:f,zIndexMode:y}){return D.useContext(sn)?c.jsx(c.Fragment,{children:e}):c.jsx($n,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:s,initialHeight:i,fitView:a,initialFitViewOptions:l,initialMinZoom:u,initialMaxZoom:h,nodeOrigin:d,nodeExtent:f,zIndexMode:y,children:e})}const Ah={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Dh({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:l,onInit:u,onMove:h,onMoveStart:d,onMoveEnd:f,onConnect:y,onConnectStart:p,onConnectEnd:x,onClickConnectStart:w,onClickConnectEnd:m,onNodeMouseEnter:b,onNodeMouseMove:g,onNodeMouseLeave:v,onNodeContextMenu:C,onNodeDoubleClick:S,onNodeDragStart:j,onNodeDrag:A,onNodeDragStop:P,onNodesDelete:V,onEdgesDelete:I,onDelete:T,onSelectionChange:R,onSelectionDragStart:_,onSelectionDrag:N,onSelectionDragStop:E,onSelectionContextMenu:M,onSelectionStart:k,onSelectionEnd:z,onBeforeDelete:$,connectionMode:H,connectionLineType:L=Me.Bezier,connectionLineStyle:W,connectionLineComponent:O,connectionLineContainerStyle:q,deleteKeyCode:J="Backspace",selectionKeyCode:G="Shift",selectionOnDrag:B=!1,selectionMode:Y=yt.Full,panActivationKeyCode:te="Space",multiSelectionKeyCode:ee=wt()?"Meta":"Control",zoomActivationKeyCode:U=wt()?"Meta":"Control",snapToGrid:K,snapGrid:oe,onlyRenderVisibleElements:ie=!1,selectNodesOnDrag:re,nodesDraggable:le,autoPanOnNodeFocus:je,nodesConnectable:_e,nodesFocusable:ze,nodeOrigin:Je=vi,edgesFocusable:et,edgesReconnectable:tt,elementsSelectable:un=!0,defaultViewport:jt=af,minZoom:He=.5,maxZoom:nt=2,translateExtent:eo=mt,preventScrolling:qi=!0,nodeExtent:dn,defaultMarkerColor:Ui="#b1b1b7",zoomOnScroll:Ki=!0,zoomOnPinch:Qi=!0,panOnScroll:Ji=!1,panOnScrollSpeed:es=.5,panOnScrollMode:ts=De.Free,zoomOnDoubleClick:ns=!0,panOnDrag:os=!0,onPaneClick:rs,onPaneMouseEnter:is,onPaneMouseMove:ss,onPaneMouseLeave:as,onPaneScroll:cs,onPaneContextMenu:ls,paneClickDistance:us=1,nodeClickDistance:ds=0,children:fs,onReconnect:hs,onReconnectStart:ps,onReconnectEnd:gs,onEdgeContextMenu:ms,onEdgeDoubleClick:ys,onEdgeMouseEnter:xs,onEdgeMouseMove:ws,onEdgeMouseLeave:vs,reconnectRadius:_s=10,onNodesChange:bs,onEdgesChange:Ss,noDragClassName:Es="nodrag",noWheelClassName:Cs="nowheel",noPanClassName:to="nopan",fitView:no,fitViewOptions:oo,connectOnClick:js,attributionPosition:Ns,proOptions:ks,defaultEdgeOptions:Ms,elevateNodesOnSelect:Is=!0,elevateEdgesOnSelect:zs=!1,disableKeyboardA11y:ro=!1,autoPanOnConnect:Ps,autoPanOnNodeDrag:As,autoPanSpeed:Ds,connectionRadius:Ts,isValidConnection:$s,onError:Rs,style:Ls,id:io,nodeDragThreshold:Hs,connectionDragThreshold:Vs,viewport:Bs,onViewportChange:Os,width:Fs,height:Ws,colorMode:Xs="light",debug:Ys,onScroll:so,ariaLabelConfig:Zs,zIndexMode:ao="basic",...Gs},qs){const fn=io||"1",Us=df(Xs),Ks=D.useCallback(co=>{co.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),so?.(co)},[so]);return c.jsx("div",{"data-testid":"rf__wrapper",...Gs,onScroll:Ks,style:{...Ls,...Ah},ref:qs,className:ce(["react-flow",r,Us]),id:io,role:"application",children:c.jsxs(Ph,{nodes:e,edges:t,width:Fs,height:Ws,fitView:no,fitViewOptions:oo,minZoom:He,maxZoom:nt,nodeOrigin:Je,nodeExtent:dn,zIndexMode:ao,children:[c.jsx(Ih,{onInit:u,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:b,onNodeMouseMove:g,onNodeMouseLeave:v,onNodeContextMenu:C,onNodeDoubleClick:S,nodeTypes:s,edgeTypes:i,connectionLineType:L,connectionLineStyle:W,connectionLineComponent:O,connectionLineContainerStyle:q,selectionKeyCode:G,selectionOnDrag:B,selectionMode:Y,deleteKeyCode:J,multiSelectionKeyCode:ee,panActivationKeyCode:te,zoomActivationKeyCode:U,onlyRenderVisibleElements:ie,defaultViewport:jt,translateExtent:eo,minZoom:He,maxZoom:nt,preventScrolling:qi,zoomOnScroll:Ki,zoomOnPinch:Qi,zoomOnDoubleClick:ns,panOnScroll:Ji,panOnScrollSpeed:es,panOnScrollMode:ts,panOnDrag:os,onPaneClick:rs,onPaneMouseEnter:is,onPaneMouseMove:ss,onPaneMouseLeave:as,onPaneScroll:cs,onPaneContextMenu:ls,paneClickDistance:us,nodeClickDistance:ds,onSelectionContextMenu:M,onSelectionStart:k,onSelectionEnd:z,onReconnect:hs,onReconnectStart:ps,onReconnectEnd:gs,onEdgeContextMenu:ms,onEdgeDoubleClick:ys,onEdgeMouseEnter:xs,onEdgeMouseMove:ws,onEdgeMouseLeave:vs,reconnectRadius:_s,defaultMarkerColor:Ui,noDragClassName:Es,noWheelClassName:Cs,noPanClassName:to,rfId:fn,disableKeyboardA11y:ro,nodeExtent:dn,viewport:Bs,onViewportChange:Os}),c.jsx(uf,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:y,onConnectStart:p,onConnectEnd:x,onClickConnectStart:w,onClickConnectEnd:m,nodesDraggable:le,autoPanOnNodeFocus:je,nodesConnectable:_e,nodesFocusable:ze,edgesFocusable:et,edgesReconnectable:tt,elementsSelectable:un,elevateNodesOnSelect:Is,elevateEdgesOnSelect:zs,minZoom:He,maxZoom:nt,nodeExtent:dn,onNodesChange:bs,onEdgesChange:Ss,snapToGrid:K,snapGrid:oe,connectionMode:H,translateExtent:eo,connectOnClick:js,defaultEdgeOptions:Ms,fitView:no,fitViewOptions:oo,onNodesDelete:V,onEdgesDelete:I,onDelete:T,onNodeDragStart:j,onNodeDrag:A,onNodeDragStop:P,onSelectionDrag:N,onSelectionDragStart:_,onSelectionDragStop:E,onMove:h,onMoveStart:d,onMoveEnd:f,noPanClassName:to,nodeOrigin:Je,rfId:fn,autoPanOnConnect:Ps,autoPanOnNodeDrag:As,autoPanSpeed:Ds,onError:Rs,connectionRadius:Ts,isValidConnection:$s,selectNodesOnDrag:re,nodeDragThreshold:Hs,connectionDragThreshold:Vs,onBeforeDelete:$,debug:Ys,ariaLabelConfig:Zs,zIndexMode:ao}),c.jsx(sf,{onSelectionChange:R}),fs,c.jsx(ef,{proOptions:ks,position:Ns}),c.jsx(Jd,{rfId:fn,disableKeyboardA11y:ro})]})})}var ur=bi(Dh);function Th({dimensions:e,lineWidth:t,variant:n,className:o}){return c.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ce(["react-flow__background-pattern",n,o])})}function $h({radius:e,className:t}){return c.jsx("circle",{cx:e,cy:e,r:e,className:ce(["react-flow__background-pattern","dots",t])})}var Ie;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ie||(Ie={}));const Rh={[Ie.Dots]:1,[Ie.Lines]:1,[Ie.Cross]:6},Lh=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Yi({id:e,variant:t=Ie.Dots,gap:n=20,size:o,lineWidth:r=1,offset:s=0,color:i,bgColor:a,style:l,className:u,patternClassName:h}){const d=D.useRef(null),{transform:f,patternId:y}=ne(Lh,se),p=o||Rh[t],x=t===Ie.Dots,w=t===Ie.Cross,m=Array.isArray(n)?n:[n,n],b=[m[0]*f[2]||1,m[1]*f[2]||1],g=p*f[2],v=Array.isArray(s)?s:[s,s],C=w?[g,g]:b,S=[v[0]*f[2]||1+C[0]/2,v[1]*f[2]||1+C[1]/2],j=`${y}${e||""}`;return c.jsxs("svg",{className:ce(["react-flow__background",u]),style:{...l,...cn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[c.jsx("pattern",{id:j,x:f[0]%b[0],y:f[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:x?c.jsx($h,{radius:g/2,className:h}):c.jsx(Th,{dimensions:C,lineWidth:r,variant:t,className:h})}),c.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${j})`})]})}Yi.displayName="Background";const dr=D.memo(Yi);function Hh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:c.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Vh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:c.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Bh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:c.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Oh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:c.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Fh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:c.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Dt({children:e,className:t,...n}){return c.jsx("button",{type:"button",className:ce(["react-flow__controls-button",t]),...n,children:e})}const Wh=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function Zi({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:l,className:u,children:h,position:d="bottom-left",orientation:f="vertical","aria-label":y}){const p=ae(),{isInteractive:x,minZoomReached:w,maxZoomReached:m,ariaLabelConfig:b}=ne(Wh,se),{zoomIn:g,zoomOut:v,fitView:C}=Qn(),S=()=>{g(),s?.()},j=()=>{v(),i?.()},A=()=>{C(r),a?.()},P=()=>{p.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),l?.(!x)},V=f==="horizontal"?"horizontal":"vertical";return c.jsxs(an,{className:ce(["react-flow__controls",V,u]),position:d,style:e,"data-testid":"rf__controls","aria-label":y??b["controls.ariaLabel"],children:[t&&c.jsxs(c.Fragment,{children:[c.jsx(Dt,{onClick:S,className:"react-flow__controls-zoomin",title:b["controls.zoomIn.ariaLabel"],"aria-label":b["controls.zoomIn.ariaLabel"],disabled:m,children:c.jsx(Hh,{})}),c.jsx(Dt,{onClick:j,className:"react-flow__controls-zoomout",title:b["controls.zoomOut.ariaLabel"],"aria-label":b["controls.zoomOut.ariaLabel"],disabled:w,children:c.jsx(Vh,{})})]}),n&&c.jsx(Dt,{className:"react-flow__controls-fitview",onClick:A,title:b["controls.fitView.ariaLabel"],"aria-label":b["controls.fitView.ariaLabel"],children:c.jsx(Bh,{})}),o&&c.jsx(Dt,{className:"react-flow__controls-interactive",onClick:P,title:b["controls.interactive.ariaLabel"],"aria-label":b["controls.interactive.ariaLabel"],children:x?c.jsx(Fh,{}):c.jsx(Oh,{})}),h]})}Zi.displayName="Controls";const fr=D.memo(Zi);function Xh({id:e,x:t,y:n,width:o,height:r,style:s,color:i,strokeColor:a,strokeWidth:l,className:u,borderRadius:h,shapeRendering:d,selected:f,onClick:y}){const{background:p,backgroundColor:x}=s||{},w=i||p||x;return c.jsx("rect",{className:ce(["react-flow__minimap-node",{selected:f},u]),x:t,y:n,rx:h,ry:h,width:o,height:r,style:{fill:w,stroke:a,strokeWidth:l},shapeRendering:d,onClick:y?m=>y(m,e):void 0})}const Yh=D.memo(Xh),Zh=e=>e.nodes.map(t=>t.id),bn=e=>e instanceof Function?e:()=>e;function Gh({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:s=Yh,onClick:i}){const a=ne(Zh,se),l=bn(t),u=bn(e),h=bn(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return c.jsx(c.Fragment,{children:a.map(f=>c.jsx(Uh,{id:f,nodeColorFunc:l,nodeStrokeColorFunc:u,nodeClassNameFunc:h,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:s,onClick:i,shapeRendering:d},f))})}function qh({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:l}){const{node:u,x:h,y:d,width:f,height:y}=ne(p=>{const{internals:x}=p.nodeLookup.get(e),w=x.userNode,{x:m,y:b}=x.positionAbsolute,{width:g,height:v}=Ce(w);return{node:w,x:m,y:b,width:g,height:v}},se);return!u||u.hidden||!Ur(u)?null:c.jsx(a,{x:h,y:d,width:f,height:y,style:u.style,selected:!!u.selected,className:o(u),color:t(u),borderRadius:r,strokeColor:n(u),strokeWidth:s,shapeRendering:i,onClick:l,id:u.id})}const Uh=D.memo(qh);var Kh=D.memo(Gh);const Qh=200,Jh=150,ep=e=>!e.hidden,tp=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?qr(St(e.nodeLookup,{filter:ep}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},np="react-flow__minimap-desc";function Gi({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:l,maskColor:u,maskStrokeColor:h,maskStrokeWidth:d,position:f="bottom-right",onClick:y,onNodeClick:p,pannable:x=!1,zoomable:w=!1,ariaLabel:m,inversePan:b,zoomStep:g=1,offsetScale:v=5}){const C=ae(),S=D.useRef(null),{boundingRect:j,viewBB:A,rfId:P,panZoom:V,translateExtent:I,flowWidth:T,flowHeight:R,ariaLabelConfig:_}=ne(tp,se),N=e?.width??Qh,E=e?.height??Jh,M=j.width/N,k=j.height/E,z=Math.max(M,k),$=z*N,H=z*E,L=v*z,W=j.x-($-j.width)/2-L,O=j.y-(H-j.height)/2-L,q=$+L*2,J=H+L*2,G=`${np}-${P}`,B=D.useRef(0),Y=D.useRef();B.current=z,D.useEffect(()=>{if(S.current&&V)return Y.current=jd({domNode:S.current,panZoom:V,getTransform:()=>C.getState().transform,getViewScale:()=>B.current}),()=>{Y.current?.destroy()}},[V]),D.useEffect(()=>{Y.current?.update({translateExtent:I,width:T,height:R,inversePan:b,pannable:x,zoomStep:g,zoomable:w})},[x,w,b,g,I,T,R]);const te=y?K=>{const[oe,ie]=Y.current?.pointer(K)||[0,0];y(K,{x:oe,y:ie})}:void 0,ee=p?D.useCallback((K,oe)=>{const ie=C.getState().nodeLookup.get(oe).internals.userNode;p(K,ie)},[]):void 0,U=m??_["minimap.ariaLabel"];return c.jsx(an,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*z:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:ce(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:c.jsxs("svg",{width:N,height:E,viewBox:`${W} ${O} ${q} ${J}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":G,ref:S,onClick:te,children:[U&&c.jsx("title",{id:G,children:U}),c.jsx(Kh,{onClick:ee,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:r,nodeStrokeWidth:i,nodeComponent:a}),c.jsx("path",{className:"react-flow__minimap-mask",d:`M${W-L},${O-L}h${q+L*2}v${J+L*2}h${-q-L*2}z
        M${A.x},${A.y}h${A.width}v${A.height}h${-A.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Gi.displayName="MiniMap";const op=D.memo(Gi),rp=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,ip={[Ke.Line]:"right",[Ke.Handle]:"bottom-right"};function sp({nodeId:e,position:t,variant:n=Ke.Handle,className:o,style:r=void 0,children:s,color:i,minWidth:a=10,minHeight:l=10,maxWidth:u=Number.MAX_VALUE,maxHeight:h=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:f,autoScale:y=!0,shouldResize:p,onResizeStart:x,onResize:w,onResizeEnd:m}){const b=ji(),g=typeof e=="string"?e:b,v=ae(),C=D.useRef(null),S=n===Ke.Handle,j=ne(D.useCallback(rp(S&&y),[S,y]),se),A=D.useRef(null),P=t??ip[n];D.useEffect(()=>{if(!(!C.current||!g))return A.current||(A.current=Vd({domNode:C.current,nodeId:g,getStoreItems:()=>{const{nodeLookup:I,transform:T,snapGrid:R,snapToGrid:_,nodeOrigin:N,domNode:E}=v.getState();return{nodeLookup:I,transform:T,snapGrid:R,snapToGrid:_,nodeOrigin:N,paneDomNode:E}},onChange:(I,T)=>{const{triggerNodeChanges:R,nodeLookup:_,parentLookup:N,nodeOrigin:E}=v.getState(),M=[],k={x:I.x,y:I.y},z=_.get(g);if(z&&z.expandParent&&z.parentId){const $=z.origin??E,H=I.width??z.measured.width??0,L=I.height??z.measured.height??0,W={id:z.id,parentId:z.parentId,rect:{width:H,height:L,...Kr({x:I.x??z.position.x,y:I.y??z.position.y},{width:H,height:L},z.parentId,_,$)}},O=Kn([W],_,N,E);M.push(...O),k.x=I.x?Math.max($[0]*H,I.x):void 0,k.y=I.y?Math.max($[1]*L,I.y):void 0}if(k.x!==void 0&&k.y!==void 0){const $={id:g,type:"position",position:{...k}};M.push($)}if(I.width!==void 0&&I.height!==void 0){const H={id:g,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:I.width,height:I.height}};M.push(H)}for(const $ of T){const H={...$,type:"position"};M.push(H)}R(M)},onEnd:({width:I,height:T})=>{const R={id:g,type:"dimensions",resizing:!1,dimensions:{width:I,height:T}};v.getState().triggerNodeChanges([R])}})),A.current.update({controlPosition:P,boundaries:{minWidth:a,minHeight:l,maxWidth:u,maxHeight:h},keepAspectRatio:d,resizeDirection:f,onResizeStart:x,onResize:w,onResizeEnd:m,shouldResize:p}),()=>{A.current?.destroy()}},[P,a,l,u,h,d,x,w,m,p]);const V=P.split("-");return c.jsx("div",{className:ce(["react-flow__resize-control","nodrag",...V,n,o]),ref:C,style:{...r,scale:j,...i&&{[S?"backgroundColor":"borderColor"]:i}},children:s})}D.memo(sp);const ap=({data:e})=>{const[t,n]=Rn.useState(!1),o=e.deployment,r=l=>{switch(l){case"success":return"success";case"running":return"info";case"failed":return"error";case"pending":return"warning";case"cancelled":return"default";default:return"default"}},s=l=>({success:"",running:"",failed:"",pending:"",cancelled:""})[l]||l,i=()=>{if(!o.jenkins_job||!o.jenkins_server_url)return null;const l=o.jenkins_server_url.replace(/\/$/,"");return o.jenkins_build_number?`${l}/job/${o.jenkins_job}/${o.jenkins_build_number}`:`${l}/job/${o.jenkins_job}`},a=()=>!o.jenkins_job||!o.jenkins_server_url||!o.jenkins_build_number?null:`${o.jenkins_server_url.replace(/\/$/,"")}/job/${o.jenkins_job}/${o.jenkins_build_number}/console`;return c.jsxs(c.Fragment,{children:[c.jsx(Qe,{type:"target",position:X.Left,style:{background:"#555"}}),c.jsx(Qs,{sx:{minWidth:280,maxWidth:320,border:`2px solid ${o.status==="success"?"#4caf50":o.status==="failed"?"#f44336":o.status==="running"?"#2196f3":"#ff9800"}`,borderRadius:2,boxShadow:3},children:c.jsxs(Js,{sx:{p:2,"&:last-child":{pb:2}},children:[c.jsxs(Q,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1.5},children:[c.jsx(F,{variant:"h6",fontWeight:600,sx:{fontSize:"1rem"},children:o.project_name}),c.jsx(he,{label:s(o.status),color:r(o.status),size:"small",sx:{height:24}})]}),o.env_name&&c.jsxs(F,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:[": ",o.env_name]}),o.version&&c.jsxs(F,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:[": ",o.version]}),o.jenkins_job&&c.jsxs(F,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1},children:["Job: ",o.jenkins_job,o.jenkins_build_number&&` #${o.jenkins_build_number}`]}),c.jsx($t,{sx:{my:1}}),c.jsxs(Q,{sx:{display:"flex",gap:.5,justifyContent:"flex-end"},children:[i()&&c.jsx(hn,{title:"Jenkins",children:c.jsx(pn,{size:"small",onClick:()=>{const l=i();l&&window.open(l,"_blank")},sx:{p:.5},children:c.jsx(lo,{fontSize:"small"})})}),a()&&c.jsx(hn,{title:"Jenkins",children:c.jsx(pn,{size:"small",onClick:()=>{const l=a();l&&window.open(l,"_blank")},sx:{p:.5},children:c.jsx(uo,{fontSize:"small"})})}),c.jsx(hn,{title:"",children:c.jsx(pn,{size:"small",onClick:()=>n(!0),sx:{p:.5},children:c.jsx(ea,{fontSize:"small"})})})]})]})}),c.jsx(Qe,{type:"source",position:X.Right,style:{background:"#555"}}),c.jsxs(ta,{open:t,onClose:()=>n(!1),maxWidth:"md",fullWidth:!0,children:[c.jsxs(na,{children:[" - ",o.project_name]}),c.jsx(oa,{children:c.jsxs(ue,{container:!0,spacing:2,sx:{mt:1},children:[c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:"ID"}),c.jsx(F,{variant:"body2",children:o.id})]}),c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(Q,{children:c.jsx(he,{label:s(o.status),color:r(o.status),size:"small"})})]}),c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:o.project_name})]}),o.env_name&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:o.env_name})]}),o.cluster_name&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:o.cluster_name})]}),o.namespace&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:o.namespace})]}),o.version&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:o.version})]}),o.deploy_type&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:o.deploy_type.toUpperCase()})]}),o.jenkins_job&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:"Jenkins Job"}),c.jsxs(F,{variant:"body2",children:[o.jenkins_job,o.jenkins_build_number&&` #${o.jenkins_build_number}`]})]}),o.created_by_name&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:o.created_by_name})]}),o.created_at&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:new Date(o.created_at).toLocaleString("zh-CN")})]}),o.started_at&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:new Date(o.started_at).toLocaleString("zh-CN")})]}),o.completed_at&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:new Date(o.completed_at).toLocaleString("zh-CN")})]}),o.duration&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsxs(F,{variant:"body2",children:[o.duration," "]})]}),o.description&&c.jsxs(ue,{item:!0,xs:12,children:[c.jsx(F,{variant:"caption",color:"text.secondary",children:""}),c.jsx(F,{variant:"body2",children:o.description})]})]})}),c.jsxs(ra,{children:[i()&&c.jsx(Fe,{onClick:()=>{const l=i();l&&window.open(l,"_blank")},startIcon:c.jsx(lo,{}),children:"Jenkins"}),a()&&c.jsx(Fe,{onClick:()=>{const l=a();l&&window.open(l,"_blank")},startIcon:c.jsx(uo,{}),children:""}),c.jsx(Fe,{onClick:()=>n(!1),children:""})]})]})]})},cp={deployment:ap};function lp({deployments:e}){Rn.useEffect(()=>{console.log("DeploymentFlow deployments:",e),console.log("deployments :",e?.length||0)},[e]);const{nodes:t,edges:n}=D.useMemo(()=>{if(console.log("deployments:",e),!e||e.length===0)return console.log(""),{nodes:[],edges:[]};const i=380,a=250,l=4,u=e.map((d,f)=>{const y=Math.floor(f/l),p=f%l,w=Math.min(l,e.length-y*l)*i,m=(l*i-w)/2+50;return{id:d.id,type:"deployment",position:{x:m+p*i,y:y*a+50},data:{deployment:d}}}),h=[];for(let d=0;d<u.length-1;d++)h.push({id:`e${d}-${d+1}`,source:u[d].id,target:u[d+1].id,type:"smoothstep",animated:e[d].status==="running",style:{strokeWidth:3,stroke:e[d].status==="success"?"#4caf50":e[d].status==="failed"?"#f44336":e[d].status==="running"?"#2196f3":"#ff9800"},markerEnd:{type:"arrowclosed",width:20,height:20,color:e[d].status==="success"?"#4caf50":e[d].status==="failed"?"#f44336":e[d].status==="running"?"#2196f3":"#ff9800"},labelStyle:{fill:"#666",fontWeight:500,fontSize:12}});return console.log(":",u.length,":",h.length),{nodes:u,edges:h}},[e]);if(!e||e.length===0)return c.jsxs(Q,{sx:{width:"100%",height:"400px",border:"1px solid #e0e0e0",borderRadius:2,overflow:"hidden",position:"relative",backgroundColor:"#fafafa",display:"flex",alignItems:"center",justifyContent:"center"},children:[c.jsx($n,{children:c.jsxs(ur,{nodes:[],edges:[],fitView:!0,style:{width:"100%",height:"100%"},children:[c.jsx(dr,{color:"#e0e0e0",gap:16}),c.jsx(fr,{})]})}),c.jsx(Q,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"rgba(255, 255, 255, 0.9)",padding:2,borderRadius:1,zIndex:10},children:c.jsx(F,{variant:"body2",color:"text.secondary",children:""})})]});const r=Math.ceil(e.length/4),s=Math.max(500,r*250+100);return console.log(" ReactFlow:",t.length,":",n.length),c.jsxs(Q,{sx:{width:"100%",height:`${s}px`,border:"2px solid #1976d2",borderRadius:2,overflow:"hidden",position:"relative",backgroundColor:"#fafafa",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[c.jsx($n,{children:c.jsxs(ur,{nodes:t,edges:n,nodeTypes:cp,fitView:!0,fitViewOptions:{padding:.3,maxZoom:1.5,minZoom:.5},panOnScroll:!0,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!0,selectNodesOnDrag:!1,style:{width:"100%",height:"100%"},defaultEdgeOptions:{type:"smoothstep",style:{strokeWidth:3}},children:[c.jsx(dr,{color:"#e0e0e0",gap:16,size:1}),c.jsx(fr,{showInteractive:!1}),c.jsx(op,{nodeColor:i=>{const a=i.data?.deployment;if(!a)return"#ccc";switch(a.status){case"success":return"#4caf50";case"failed":return"#f44336";case"running":return"#2196f3";case"pending":return"#ff9800";default:return"#ccc"}},style:{backgroundColor:"#fff",border:"1px solid #ddd"},nodeStrokeWidth:3,pannable:!0,zoomable:!0})]})}),!1]})}const up=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:s,...i}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Ot,{...i,style:{...i.style&&typeof i.style=="object"?i.style:{},width:"100%"}})})},dp=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:s,...i}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Ot.TextArea,{...i,style:{...i.style&&typeof i.style=="object"?i.style:{},width:"100%"}})})},hr=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:s,...i}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Ma,{...i,style:{...i.style&&typeof i.style=="object"?i.style:{},width:"100%"}})})},pr=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:s,...i}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Na,{...i,style:{...i.style&&typeof i.style=="object"?i.style:{},width:"100%"}})})},fp=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:s,...i}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Ia,{...i,style:{...i.style&&typeof i.style=="object"?i.style:{},width:"100%"}})})},hp=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:s,...i}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Sn,{...i,style:{...i.style&&typeof i.style=="object"?i.style:{},width:"100%"}})})},pp=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:s,...i}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(ka,{...i,style:{...i.style&&typeof i.style=="object"?i.style:{},width:"100%"}})})},gp=va({components:{FormItem:go,Input:up,TextArea:dp,Password:fp,Select:hr,FormilySelect:hr,DatePicker:hp,TimePicker:pp,DateRangePicker:Sn.RangePicker||Sn,NumberPicker:pr,InputNumber:pr,Switch:ja,CheckboxGroup:ba.Group,RadioGroup:_a.Group,Slider:Ot,Rate:Ot,Upload:Ca,FormLayout:Ea,FormGrid:Sa,Field:go}});function Tt(e){const{children:t,value:n,index:o,...r}=e;return c.jsx("div",{role:"tabpanel",hidden:n!==o,id:`ticket-tabpanel-${o}`,"aria-labelledby":`ticket-tab-${o}`,...r,children:n===o&&c.jsx(Q,{sx:{py:2},children:t})})}function Ep(){const{id:e}=ia(),t=sa(),n=aa(),[o,r]=D.useState(null),[s,i]=D.useState(!0),[a]=D.useState(()=>xa({readOnly:!0})),[l,u]=D.useState(0),d=(()=>{if(n.state?.from)return n.state.from;const p=document.referrer;if(p){if(p.includes("/daily-workorders")||p.includes("/fill-ticket-form"))return"/daily-workorders";if(p.includes("/my-tickets"))return"/my-tickets";if(p.includes("/all-tickets"))return"/all-tickets"}const x=sessionStorage.getItem("ticket_detail_from");return x||"/my-tickets"})();D.useEffect(()=>{d&&sessionStorage.setItem("ticket_detail_from",d)},[d]);const f=D.useCallback(async()=>{if(e)try{i(!0);const p=await ga.get(Number(e));p.data.code===0?(console.log(":",p.data.data),console.log(":",p.data.data.deployments),console.log(":",p.data.data.deployments?.length||0),console.log("ID:",p.data.data.approval_instance_id),console.log("ID:",p.data.data.deployment_id),console.log(":",p.data.data.form_data),r(p.data.data),p.data.data.form_data&&a.setValues(p.data.data.form_data)):(fo(""),t("/my-tickets"))}catch(p){const x=p;console.error(":",p),fo(x?.response?.data?.message||""),t("/my-tickets")}finally{i(!1)}},[e,t,a]);D.useEffect(()=>{e&&f()},[e,f]);const y=()=>{if(!o?.form_data)return[];const p=o.form_data,x=[];if(p.steps&&Array.isArray(p.steps)&&p.steps.forEach((w,m)=>{const b=w.func_kwargs_json||{},g=String(b.application_name||b.service_name||b.project_name||""),v=String(b.application_id||b.service_id||b.project_id||"");g&&x.push({id:v||`step-${m}`,name:g,env_name:b.env_name?String(b.env_name):w.env_name?String(w.env_name):void 0,env_id:b.env_id?String(b.env_id):w.env_id?String(w.env_id):void 0,step_type:w.step_type?String(w.step_type):void 0,step_name:w.step_name?String(w.step_name):void 0,version:b.version?String(b.version):w.version?String(w.version):void 0})}),x.length===0){const w=String(p.application_name||p.service_name||p.project_name||"");w&&x.push({id:String(p.application_id||p.service_id||p.project_id||"1"),name:w,env_name:p.env_name?String(p.env_name):void 0,env_id:p.env_id?String(p.env_id):void 0})}return x};return s?c.jsx(Q,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:c.jsx(ca,{})}):o?c.jsxs(Q,{sx:{p:3,width:"100%"},children:[c.jsxs(Q,{sx:{display:"flex",alignItems:"center",mb:3},children:[c.jsx(Fe,{startIcon:c.jsx(la,{}),onClick:()=>t(d),sx:{mr:2},children:""}),c.jsx(F,{variant:"h4",component:"h1",children:""})]}),c.jsxs(Q,{sx:{width:"100%",border:1,borderColor:"divider",borderRadius:1,p:4},children:[c.jsx(Q,{sx:{mb:3},children:c.jsx(he,{label:o.type==="deployment"?"":"",color:o.type==="deployment"?"primary":"default",variant:"outlined",sx:{fontWeight:600}})}),o.type==="deployment"&&c.jsxs(c.Fragment,{children:[c.jsxs(Q,{sx:{mb:3},children:[c.jsx(F,{variant:"h5",fontWeight:600,gutterBottom:!0,children:""}),c.jsxs(F,{variant:"body2",color:"text.secondary",children:[new Date(o.created_at).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}),"  1 "]})]}),c.jsx(Q,{sx:{position:"relative",mt:4,mb:4,width:"100%"},children:c.jsxs(Q,{sx:{display:"flex",justifyContent:"space-between",position:"relative",zIndex:1,width:"100%",gap:6},children:[c.jsxs(Q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(Q,{sx:{position:"absolute",top:20,left:"calc(50% + 20px)",width:"calc(100% + 48px)",height:3,backgroundColor:"#e91e63",zIndex:0}}),c.jsx(Q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:"#e91e63",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(F,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),c.jsx(F,{variant:"caption",color:"text.secondary",children:o.applicant_username||o.applicant_name}),c.jsx(F,{variant:"caption",color:"text.secondary",children:new Date(o.created_at).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),c.jsxs(Q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(Q,{sx:{position:"absolute",top:20,left:"calc(50% + 20px)",width:"calc(100% + 48px)",height:3,backgroundColor:o.status!=="draft"?"#e91e63":"#e0e0e0",zIndex:0}}),c.jsx(Q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:o.status!=="draft"?"#e91e63":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(F,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),c.jsx(F,{variant:"caption",color:"text.secondary",children:o.status==="draft"?"":""})]}),c.jsxs(Q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(Q,{sx:{position:"absolute",top:20,left:"calc(50% + 20px)",width:"calc(100% + 48px)",height:3,backgroundColor:o.approval_status==="approved"||o.status==="approved"?"#e91e63":o.approval_status==="rejected"||o.status==="rejected"?"#f44336":o.status==="submitted"?"#e91e63":"#e0e0e0",zIndex:0}}),c.jsx(Q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:o.approval_status==="approved"||o.status==="approved"?"#e91e63":o.approval_status==="rejected"||o.status==="rejected"?"#f44336":o.status==="submitted"?"#e91e63":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(F,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),o.approval_status==="pending"||o.status==="submitted"&&!o.approval_status?c.jsx(F,{variant:"caption",color:"text.secondary",children:""}):o.approval_status==="approved"||o.status==="approved"?c.jsx(F,{variant:"caption",color:"text.secondary",children:o.approvers&&Array.isArray(o.approvers)?o.approvers.join(""):""}):o.approval_status==="rejected"||o.status==="rejected"?c.jsx(F,{variant:"caption",color:"error",children:""}):c.jsx(F,{variant:"caption",color:"text.secondary",children:""})]}),c.jsxs(Q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(Q,{sx:{position:"absolute",top:20,left:"calc(50% + 20px)",width:"calc(100% + 48px)",height:3,backgroundColor:o.deployment_status==="success"?"#e91e63":o.deployment_status==="running"?"#2196f3":o.deployment_status==="failed"?"#f44336":o.approval_status==="approved"||o.status==="approved"?"#e91e63":"#e0e0e0",zIndex:0}}),c.jsx(Q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:o.deployment_status==="success"?"#e91e63":o.deployment_status==="running"?"#2196f3":o.deployment_status==="failed"?"#f44336":o.approval_status==="approved"||o.status==="approved"?"#e91e63":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(F,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),o.deployments&&o.deployments.length>0?c.jsxs(F,{variant:"caption",color:"text.secondary",children:[o.deployments.length," "]}):o.deployment_status?c.jsx(F,{variant:"caption",color:"text.secondary",children:o.deployment_status==="success"?"":o.deployment_status==="running"?"":o.deployment_status==="failed"?"":""}):c.jsx(F,{variant:"caption",color:"text.secondary",children:""})]}),c.jsxs(Q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(Q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:o.deployment_status==="success"&&o.status==="approved"?"#e91e63":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(F,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),c.jsx(F,{variant:"caption",color:"text.secondary",children:o.deployment_status==="success"?"":""})]})]})}),c.jsx($t,{sx:{my:4}})]}),o.type==="daily"&&o.template&&o.template.schema&&c.jsxs(c.Fragment,{children:[c.jsx(F,{variant:"h6",gutterBottom:!0,children:""}),c.jsx($t,{sx:{mb:2}}),c.jsx(Q,{sx:{p:3},children:c.jsx(wa,{form:a,children:c.jsx(gp,{schema:o.template.schema})})}),c.jsx($t,{sx:{my:4}})]}),o.type==="deployment"&&c.jsxs(c.Fragment,{children:[c.jsx(Q,{sx:{borderBottom:1,borderColor:"divider",mb:0},children:c.jsxs(ua,{value:l,onChange:(p,x)=>u(x),sx:{px:3,"& .MuiTab-root":{textTransform:"none",minHeight:64,px:3,mx:1}},children:[o.type==="deployment"&&c.jsxs(c.Fragment,{children:[c.jsx(Nt,{icon:c.jsx(da,{}),iconPosition:"start",label:""}),c.jsx(Nt,{icon:c.jsx(fa,{}),iconPosition:"start",label:""}),c.jsx(Nt,{icon:c.jsx(ha,{}),iconPosition:"start",label:""})]}),c.jsx(Nt,{icon:c.jsx(pa,{}),iconPosition:"start",label:""})]})}),o.type==="deployment"&&c.jsx(Tt,{value:l,index:0,children:c.jsx(Q,{sx:{px:3},children:(()=>{const p=y(),x=o.deployments||[],w=p.map(m=>{const b=x.find(g=>{const v=g;return v.project_name===m.name||v.project_name===m.step_name});return{...m,deployment:b}});return x.forEach(m=>{const b=m;w.some(v=>v.deployment?.id===m.id||v.name===b.project_name)||w.push({id:String(m.id||""),name:b.project_name||"",env_name:b.env_name,env_id:b.env_id,deployment:m})}),w.length>0?c.jsx(it,{children:c.jsxs(st,{children:[c.jsx(at,{children:c.jsxs(xe,{children:[c.jsx(Z,{children:""}),c.jsx(Z,{children:""}),c.jsx(Z,{children:""}),c.jsx(Z,{children:""}),c.jsx(Z,{children:""}),c.jsx(Z,{children:""}),c.jsx(Z,{children:""})]})}),c.jsx(ct,{children:w.map((m,b)=>c.jsxs(xe,{children:[c.jsx(Z,{children:c.jsx(F,{variant:"body2",fontWeight:500,children:m.name})}),c.jsx(Z,{children:String(m.env_name||m.deployment?.env_name||"-")}),c.jsx(Z,{children:String(m.deployment?.version||m.version||"-")}),c.jsx(Z,{children:m.deployment?c.jsx(he,{label:m.deployment.status==="success"?"":m.deployment.status==="running"?"":m.deployment.status==="failed"?"":m.deployment.status==="pending"?"":m.deployment.status,color:m.deployment.status==="success"?"success":m.deployment.status==="running"?"info":m.deployment.status==="failed"?"error":"warning",size:"small"}):c.jsx(he,{label:"",color:"default",size:"small"})}),c.jsx(Z,{children:m.deployment?.deploy_type==="jenkins"?"Jenkins":m.deployment?.deploy_type==="k8s"||m.step_type==="deploy_k8s"?"K8s":m.step_type==="project"?"":m.step_type||"-"}),c.jsx(Z,{children:m.step_type==="deploy_k8s"?"K8s":m.step_type==="project"?"":m.step_type==="sql"?"SQL":m.step_type||"-"}),c.jsx(Z,{children:m.deployment?.created_at?new Date(m.deployment.created_at).toLocaleString("zh-CN"):o.created_at?new Date(o.created_at).toLocaleString("zh-CN"):"-"})]},m.id||`service-${b}`))})]})}):c.jsx(ot,{severity:"info",children:""})})()})}),c.jsx(Tt,{value:l,index:o.type==="deployment"?3:0,children:c.jsxs(Q,{sx:{px:3},children:[c.jsxs(Q,{sx:{mb:3},children:[c.jsx(F,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(Q,{sx:{mt:1},children:c.jsx(he,{label:o.approval_status==="approved"||o.status==="approved"?"":o.approval_status==="rejected"||o.status==="rejected"?"":o.approval_status==="pending"||o.status==="submitted"?"":"",color:o.approval_status==="approved"||o.status==="approved"?"success":o.approval_status==="rejected"||o.status==="rejected"?"error":o.approval_status==="pending"||o.status==="submitted"?"info":"default",size:"medium"})})]}),c.jsxs(Q,{sx:{mb:3},children:[c.jsx(F,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,sx:{mb:2},children:""}),o.approval_steps&&Array.isArray(o.approval_steps)&&o.approval_steps.length>0?c.jsx(it,{component:rt,variant:"outlined",children:c.jsxs(st,{size:"small",children:[c.jsx(at,{children:c.jsxs(xe,{children:[c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""})]})}),c.jsx(ct,{children:o.approval_steps.map((p,x)=>{const w=p.approver||p.approver_name||"-",m=p.status||"pending";let b="",g="default";return m==="approved"?(b="",g="success"):m==="rejected"?(b="",g="error"):(b="",g="default"),c.jsxs(xe,{sx:{"&:hover":{bgcolor:"action.hover"}},children:[c.jsx(Z,{align:"center",children:w}),c.jsx(Z,{align:"center",children:c.jsx(he,{label:b,color:g,size:"small"})}),c.jsx(Z,{align:"center",children:p.comment||p.remark||"-"})]},x)})})]})}):o.approvers&&Array.isArray(o.approvers)&&o.approvers.length>0?c.jsx(it,{component:rt,variant:"outlined",children:c.jsxs(st,{size:"small",children:[c.jsx(at,{children:c.jsxs(xe,{children:[c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""})]})}),c.jsx(ct,{children:o.approvers.map((p,x)=>{const m=o.approval_steps?.find(v=>v.approver===p||v.approver_name===p)?.status||"pending";let b="",g="default";return m==="approved"?(b="",g="success"):m==="rejected"?(b="",g="error"):(b="",g="default"),c.jsxs(xe,{sx:{"&:hover":{bgcolor:"action.hover"}},children:[c.jsx(Z,{align:"center",children:p}),c.jsx(Z,{align:"center",children:c.jsx(he,{label:b,color:g,size:"small"})})]},x)})})]})}):c.jsx(ot,{severity:"info",children:""})]}),o.approval_comment&&c.jsxs(Q,{children:[c.jsx(F,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(rt,{sx:{p:2,mt:1,bgcolor:"background.default"},children:c.jsx(F,{variant:"body2",children:o.approval_comment})})]})]})}),o.type==="deployment"&&c.jsx(Tt,{value:l,index:1,children:c.jsx(Q,{sx:{px:3},children:o.deployments&&o.deployments.length>0?c.jsxs(c.Fragment,{children:[c.jsxs(Q,{sx:{mb:3},children:[c.jsx(F,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(Q,{sx:{mt:2,width:"100%",overflow:"hidden"},children:c.jsx(lp,{deployments:o.deployments})})]}),c.jsxs(Q,{children:[c.jsx(F,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(it,{component:rt,variant:"outlined",sx:{mt:2},children:c.jsxs(st,{children:[c.jsx(at,{children:c.jsxs(xe,{children:[c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""})]})}),c.jsx(ct,{children:o.deployments.map(p=>{const x=p;return c.jsxs(xe,{children:[c.jsx(Z,{align:"center",children:c.jsx(F,{variant:"body2",fontWeight:500,children:x.project_name||"-"})}),c.jsx(Z,{align:"center",children:x.env_name||"-"}),c.jsx(Z,{align:"center",children:x.version||"-"}),c.jsx(Z,{align:"center",children:c.jsx(he,{label:x.deploy_type==="jenkins"?"Jenkins":x.deploy_type==="k8s"?"K8s":x.deploy_type||"",size:"small",color:x.deploy_type==="jenkins"?"primary":"default"})}),c.jsx(Z,{align:"center",children:c.jsx(he,{label:x.status==="success"?"":x.status==="running"?"":x.status==="failed"?"":x.status==="pending"?"":x.status||"-",color:x.status==="success"?"success":x.status==="running"?"info":x.status==="failed"?"error":"warning",size:"small"})}),c.jsx(Z,{align:"center",children:x.started_at?new Date(x.started_at).toLocaleString("zh-CN"):"-"}),c.jsx(Z,{align:"center",children:x.completed_at?new Date(x.completed_at).toLocaleString("zh-CN"):"-"}),c.jsx(Z,{align:"center",children:x.duration?`${x.duration} `:"-"})]},p.id)})})]})})]})]}):c.jsx(ot,{severity:"info",children:""})})}),o.type==="deployment"&&c.jsx(Tt,{value:l,index:2,children:c.jsx(Q,{sx:{px:3},children:o.deployments&&o.deployments.length>0?c.jsx(it,{component:rt,variant:"outlined",children:c.jsxs(st,{children:[c.jsx(at,{children:c.jsxs(xe,{children:[c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""}),c.jsx(Z,{align:"center",children:""})]})}),c.jsx(ct,{children:o.deployments.map(p=>{const x=p;return c.jsxs(xe,{children:[c.jsx(Z,{align:"center",children:c.jsx(F,{variant:"body2",fontWeight:500,children:x.project_name||"-"})}),c.jsx(Z,{align:"center",children:x.version||"-"}),c.jsx(Z,{align:"center",children:c.jsx(he,{label:"",size:"small",color:"primary",variant:"outlined"})}),c.jsx(Z,{align:"center",children:x.env_name||"-"}),c.jsx(Z,{align:"center",children:c.jsx(he,{label:"",color:"default",size:"small"})}),c.jsx(Z,{align:"center",children:c.jsx(Fe,{variant:"outlined",size:"small",color:"warning",disabled:x.status!=="success",children:""})})]},p.id)})})]})}):c.jsx(ot,{severity:"info",children:""})})})]})]})]}):c.jsxs(Q,{sx:{p:3},children:[c.jsx(ot,{severity:"error",children:""}),c.jsx(Fe,{sx:{mt:2},onClick:()=>t("/my-tickets"),children:""})]})}export{Ep as default};

import{b6 as Hn,r as D,j as c,B as q,T as O,w as at,x as ct,D as En,d as pn,I as gn,cF as fo,cn as ho,ci as ea,i as ta,k as na,l as oa,p as ra,a as Fe,bg as sa,ax as ia,b2 as aa,bf as po,C as ca,b as ot,aA as la,P as rt,a3 as ua,a4 as jt,bj as da,dm as fa,ct as ha,dy as pa}from"./index-CJIrazW8.js";import{t as ga}from"./ticketApi-CCnZQOPl.js";import{a as Pe,b as go,c as ma,d as mo,i as mn,u as xa}from"./value-Cn2IHGIU.js";import{C as de}from"./Chip-Bh8gAKTq.js";import{G as ue}from"./GridLegacy-ChU6VyLK.js";import{j as ya,F as wa,k as va,b5 as _a,b6 as ba,b2 as jn,aY as xo,a_ as Sa,aT as Ea,b4 as ja,aX as Ft,aU as Ca,u as Le,aW as Na,b3 as ka,aV as Ma,b1 as Ia}from"./index-Cgn-RpuY.js";import{T as Ct,a as Nt,b as kt,c as Ce,d as G,e as Mt}from"./TableRow-JrGpygSA.js";import"./typeof-QjJsDpFa.js";var yo=180/Math.PI,Cn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xr(e,t,n,o,r,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*o)&&(n-=e*l,o-=t*l),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,l/=a),e*o<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*yo,skewX:Math.atan(l)*yo,scaleX:s,scaleY:a}}var It;function za(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Cn:xr(t.a,t.b,t.c,t.d,t.e,t.f)}function Pa(e){return e==null||(It||(It=document.createElementNS("http://www.w3.org/2000/svg","g")),It.setAttribute("transform",e),!(e=It.transform.baseVal.consolidate()))?Cn:(e=e.matrix,xr(e.a,e.b,e.c,e.d,e.e,e.f))}function yr(e,t,n,o){function r(u){return u.length?u.pop()+" ":""}function i(u,h,d,f,m,p){if(u!==d||h!==f){var y=m.push("translate(",null,t,null,n);p.push({i:y-4,x:Pe(u,d)},{i:y-2,x:Pe(h,f)})}else(d||f)&&m.push("translate("+d+t+f+n)}function s(u,h,d,f){u!==h?(u-h>180?h+=360:h-u>180&&(u+=360),f.push({i:d.push(r(d)+"rotate(",null,o)-2,x:Pe(u,h)})):h&&d.push(r(d)+"rotate("+h+o)}function a(u,h,d,f){u!==h?f.push({i:d.push(r(d)+"skewX(",null,o)-2,x:Pe(u,h)}):h&&d.push(r(d)+"skewX("+h+o)}function l(u,h,d,f,m,p){if(u!==d||h!==f){var y=m.push(r(m)+"scale(",null,",",null,")");p.push({i:y-4,x:Pe(u,d)},{i:y-2,x:Pe(h,f)})}else(d!==1||f!==1)&&m.push(r(m)+"scale("+d+","+f+")")}return function(u,h){var d=[],f=[];return u=e(u),h=e(h),i(u.translateX,u.translateY,h.translateX,h.translateY,d,f),s(u.rotate,h.rotate,d,f),a(u.skewX,h.skewX,d,f),l(u.scaleX,u.scaleY,h.scaleX,h.scaleY,d,f),u=h=null,function(m){for(var p=-1,y=f.length,w;++p<y;)d[(w=f[p]).i]=w.x(m);return d.join("")}}}var Aa=yr(za,"px, ","px)","deg)"),Da=yr(Pa,", ",")",")"),Ta=1e-12;function wo(e){return((e=Math.exp(e))+1/e)/2}function $a(e){return((e=Math.exp(e))-1/e)/2}function Ra(e){return((e=Math.exp(2*e))-1)/(e+1)}const Lt=(function e(t,n,o){function r(i,s){var a=i[0],l=i[1],u=i[2],h=s[0],d=s[1],f=s[2],m=h-a,p=d-l,y=m*m+p*p,w,x;if(y<Ta)x=Math.log(f/u)/t,w=function(C){return[a+C*m,l+C*p,u*Math.exp(t*C*x)]};else{var b=Math.sqrt(y),g=(f*f-u*u+o*y)/(2*u*n*b),v=(f*f-u*u-o*y)/(2*f*n*b),j=Math.log(Math.sqrt(g*g+1)-g),S=Math.log(Math.sqrt(v*v+1)-v);x=(S-j)/t,w=function(C){var A=C*x,P=wo(j),V=u/(n*b)*(P*Ra(t*A+j)-$a(j));return[a+V*m,l+V*p,u*P/wo(t*A+j)]}}return w.duration=x*1e3*t/Math.SQRT2,w}return r.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},r})(Math.SQRT2,2,4);function ce(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=ce(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var La={value:()=>{}};function Qt(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Ht(n)}function Ht(e){this._=e}function Ha(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Ht.prototype=Qt.prototype={constructor:Ht,on:function(e,t){var n=this._,o=Ha(e+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(e=o[i]).type)&&(r=Va(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(r=(e=o[i]).type)n[r]=vo(n[r],e.name,t);else if(t==null)for(r in n)n[r]=vo(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ht(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,r=i.length;o<r;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};function Va(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function vo(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=La,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var Nn="http://www.w3.org/1999/xhtml";const _o={svg:"http://www.w3.org/2000/svg",xhtml:Nn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Jt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),_o.hasOwnProperty(t)?{space:_o[t],local:e}:e}function Ba(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Nn&&t.documentElement.namespaceURI===Nn?t.createElement(e):t.createElementNS(n,e)}}function Oa(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function wr(e){var t=Jt(e);return(t.local?Oa:Ba)(t)}function Fa(){}function Vn(e){return e==null?Fa:function(){return this.querySelector(e)}}function Wa(e){typeof e!="function"&&(e=Vn(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=new Array(s),l,u,h=0;h<s;++h)(l=i[h])&&(u=e.call(l,l.__data__,h,i))&&("__data__"in l&&(u.__data__=l.__data__),a[h]=u);return new he(o,this._parents)}function Xa(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ya(){return[]}function vr(e){return e==null?Ya:function(){return this.querySelectorAll(e)}}function Za(e){return function(){return Xa(e.apply(this,arguments))}}function Ga(e){typeof e=="function"?e=Za(e):e=vr(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,u=0;u<a;++u)(l=s[u])&&(o.push(e.call(l,l.__data__,u,s)),r.push(l));return new he(o,r)}function _r(e){return function(){return this.matches(e)}}function br(e){return function(t){return t.matches(e)}}var qa=Array.prototype.find;function Ua(e){return function(){return qa.call(this.children,e)}}function Ka(){return this.firstElementChild}function Qa(e){return this.select(e==null?Ka:Ua(typeof e=="function"?e:br(e)))}var Ja=Array.prototype.filter;function ec(){return Array.from(this.children)}function tc(e){return function(){return Ja.call(this.children,e)}}function nc(e){return this.selectAll(e==null?ec:tc(typeof e=="function"?e:br(e)))}function oc(e){typeof e!="function"&&(e=_r(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],l,u=0;u<s;++u)(l=i[u])&&e.call(l,l.__data__,u,i)&&a.push(l);return new he(o,this._parents)}function Sr(e){return new Array(e.length)}function rc(){return new he(this._enter||this._groups.map(Sr),this._parents)}function Wt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Wt.prototype={constructor:Wt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function sc(e){return function(){return e}}function ic(e,t,n,o,r,i){for(var s=0,a,l=t.length,u=i.length;s<u;++s)(a=t[s])?(a.__data__=i[s],o[s]=a):n[s]=new Wt(e,i[s]);for(;s<l;++s)(a=t[s])&&(r[s]=a)}function ac(e,t,n,o,r,i,s){var a,l,u=new Map,h=t.length,d=i.length,f=new Array(h),m;for(a=0;a<h;++a)(l=t[a])&&(f[a]=m=s.call(l,l.__data__,a,t)+"",u.has(m)?r[a]=l:u.set(m,l));for(a=0;a<d;++a)m=s.call(e,i[a],a,i)+"",(l=u.get(m))?(o[a]=l,l.__data__=i[a],u.delete(m)):n[a]=new Wt(e,i[a]);for(a=0;a<h;++a)(l=t[a])&&u.get(f[a])===l&&(r[a]=l)}function cc(e){return e.__data__}function lc(e,t){if(!arguments.length)return Array.from(this,cc);var n=t?ac:ic,o=this._parents,r=this._groups;typeof e!="function"&&(e=sc(e));for(var i=r.length,s=new Array(i),a=new Array(i),l=new Array(i),u=0;u<i;++u){var h=o[u],d=r[u],f=d.length,m=uc(e.call(h,h&&h.__data__,u,o)),p=m.length,y=a[u]=new Array(p),w=s[u]=new Array(p),x=l[u]=new Array(f);n(h,d,y,w,x,m,t);for(var b=0,g=0,v,j;b<p;++b)if(v=y[b]){for(b>=g&&(g=b+1);!(j=w[g])&&++g<p;);v._next=j||null}}return s=new he(s,o),s._enter=a,s._exit=l,s}function uc(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dc(){return new he(this._exit||this._groups.map(Sr),this._parents)}function fc(e,t,n){var o=this.enter(),r=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),o&&r?o.merge(r).order():r}function hc(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,s=Math.min(r,i),a=new Array(r),l=0;l<s;++l)for(var u=n[l],h=o[l],d=u.length,f=a[l]=new Array(d),m,p=0;p<d;++p)(m=u[p]||h[p])&&(f[p]=m);for(;l<r;++l)a[l]=n[l];return new he(a,this._parents)}function pc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,i=o[r],s;--r>=0;)(s=o[r])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function gc(e){e||(e=mc);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s=n[i],a=s.length,l=r[i]=new Array(a),u,h=0;h<a;++h)(u=s[h])&&(l[h]=u);l.sort(t)}return new he(r,this._parents).order()}function mc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function xc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function yc(){return Array.from(this)}function wc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null}function vc(){let e=0;for(const t of this)++e;return e}function _c(){return!this.node()}function bc(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],i=0,s=r.length,a;i<s;++i)(a=r[i])&&e.call(a,a.__data__,i,r);return this}function Sc(e){return function(){this.removeAttribute(e)}}function Ec(e){return function(){this.removeAttributeNS(e.space,e.local)}}function jc(e,t){return function(){this.setAttribute(e,t)}}function Cc(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Nc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function kc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Mc(e,t){var n=Jt(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?Ec:Sc:typeof t=="function"?n.local?kc:Nc:n.local?Cc:jc)(n,t))}function Er(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ic(e){return function(){this.style.removeProperty(e)}}function zc(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Pc(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function Ac(e,t,n){return arguments.length>1?this.each((t==null?Ic:typeof t=="function"?Pc:zc)(e,t,n??"")):Xe(this.node(),e)}function Xe(e,t){return e.style.getPropertyValue(t)||Er(e).getComputedStyle(e,null).getPropertyValue(t)}function Dc(e){return function(){delete this[e]}}function Tc(e,t){return function(){this[e]=t}}function $c(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Rc(e,t){return arguments.length>1?this.each((t==null?Dc:typeof t=="function"?$c:Tc)(e,t)):this.node()[e]}function jr(e){return e.trim().split(/^|\s+/)}function Bn(e){return e.classList||new Cr(e)}function Cr(e){this._node=e,this._names=jr(e.getAttribute("class")||"")}Cr.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Nr(e,t){for(var n=Bn(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function kr(e,t){for(var n=Bn(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function Lc(e){return function(){Nr(this,e)}}function Hc(e){return function(){kr(this,e)}}function Vc(e,t){return function(){(t.apply(this,arguments)?Nr:kr)(this,e)}}function Bc(e,t){var n=jr(e+"");if(arguments.length<2){for(var o=Bn(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?Vc:t?Lc:Hc)(n,t))}function Oc(){this.textContent=""}function Fc(e){return function(){this.textContent=e}}function Wc(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Xc(e){return arguments.length?this.each(e==null?Oc:(typeof e=="function"?Wc:Fc)(e)):this.node().textContent}function Yc(){this.innerHTML=""}function Zc(e){return function(){this.innerHTML=e}}function Gc(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function qc(e){return arguments.length?this.each(e==null?Yc:(typeof e=="function"?Gc:Zc)(e)):this.node().innerHTML}function Uc(){this.nextSibling&&this.parentNode.appendChild(this)}function Kc(){return this.each(Uc)}function Qc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Jc(){return this.each(Qc)}function el(e){var t=typeof e=="function"?e:wr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function tl(){return null}function nl(e,t){var n=typeof e=="function"?e:wr(e),o=t==null?tl:typeof t=="function"?t:Vn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function ol(){var e=this.parentNode;e&&e.removeChild(this)}function rl(){return this.each(ol)}function sl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function il(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function al(e){return this.select(e?il:sl)}function cl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ll(e){return function(t){e.call(this,t,this.__data__)}}function ul(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function dl(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function fl(e,t,n){return function(){var o=this.__on,r,i=ll(t);if(o){for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function hl(e,t,n){var o=ul(e+""),r,i=o.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,h;l<u;++l)for(r=0,h=a[l];r<i;++r)if((s=o[r]).type===h.type&&s.name===h.name)return h.value}return}for(a=t?fl:dl,r=0;r<i;++r)this.each(a(o[r],t,n));return this}function Mr(e,t,n){var o=Er(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function pl(e,t){return function(){return Mr(this,e,t)}}function gl(e,t){return function(){return Mr(this,e,t.apply(this,arguments))}}function ml(e,t){return this.each((typeof t=="function"?gl:pl)(e,t))}function*xl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length,s;r<i;++r)(s=o[r])&&(yield s)}var Ir=[null];function he(e,t){this._groups=e,this._parents=t}function wt(){return new he([[document.documentElement]],Ir)}function yl(){return this}he.prototype=wt.prototype={constructor:he,select:Wa,selectAll:Ga,selectChild:Qa,selectChildren:nc,filter:oc,data:lc,enter:rc,exit:dc,join:fc,merge:hc,selection:yl,order:pc,sort:gc,call:xc,nodes:yc,node:wc,size:vc,empty:_c,each:bc,attr:Mc,style:Ac,property:Rc,classed:Bc,text:Xc,html:qc,raise:Kc,lower:Jc,append:el,insert:nl,remove:rl,clone:al,datum:cl,on:hl,dispatch:ml,[Symbol.iterator]:xl};function fe(e){return typeof e=="string"?new he([[document.querySelector(e)]],[document.documentElement]):new he([[e]],Ir)}function wl(e){let t;for(;t=e.sourceEvent;)e=t;return e}function pe(e,t){if(e=wl(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const vl={passive:!1},ft={capture:!0,passive:!1};function xn(e){e.stopImmediatePropagation()}function We(e){e.preventDefault(),e.stopImmediatePropagation()}function zr(e){var t=e.document.documentElement,n=fe(e).on("dragstart.drag",We,ft);"onselectstart"in t?n.on("selectstart.drag",We,ft):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Pr(e,t){var n=e.document.documentElement,o=fe(e).on("dragstart.drag",null);t&&(o.on("click.drag",We,ft),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const zt=e=>()=>e;function kn(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:i,x:s,y:a,dx:l,dy:u,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:h}})}kn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function _l(e){return!e.ctrlKey&&!e.button}function bl(){return this.parentNode}function Sl(e,t){return t??{x:e.x,y:e.y}}function El(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ar(){var e=_l,t=bl,n=Sl,o=El,r={},i=Qt("start","drag","end"),s=0,a,l,u,h,d=0;function f(v){v.on("mousedown.drag",m).filter(o).on("touchstart.drag",w).on("touchmove.drag",x,vl).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(v,j){if(!(h||!e.call(this,v,j))){var S=g(this,t.call(this,v,j),v,j,"mouse");S&&(fe(v.view).on("mousemove.drag",p,ft).on("mouseup.drag",y,ft),zr(v.view),xn(v),u=!1,a=v.clientX,l=v.clientY,S("start",v))}}function p(v){if(We(v),!u){var j=v.clientX-a,S=v.clientY-l;u=j*j+S*S>d}r.mouse("drag",v)}function y(v){fe(v.view).on("mousemove.drag mouseup.drag",null),Pr(v.view,u),We(v),r.mouse("end",v)}function w(v,j){if(e.call(this,v,j)){var S=v.changedTouches,C=t.call(this,v,j),A=S.length,P,V;for(P=0;P<A;++P)(V=g(this,C,v,j,S[P].identifier,S[P]))&&(xn(v),V("start",v,S[P]))}}function x(v){var j=v.changedTouches,S=j.length,C,A;for(C=0;C<S;++C)(A=r[j[C].identifier])&&(We(v),A("drag",v,j[C]))}function b(v){var j=v.changedTouches,S=j.length,C,A;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),C=0;C<S;++C)(A=r[j[C].identifier])&&(xn(v),A("end",v,j[C]))}function g(v,j,S,C,A,P){var V=i.copy(),I=pe(P||S,j),T,R,_;if((_=n.call(v,new kn("beforestart",{sourceEvent:S,target:f,identifier:A,active:s,x:I[0],y:I[1],dx:0,dy:0,dispatch:V}),C))!=null)return T=_.x-I[0]||0,R=_.y-I[1]||0,function N(E,M,k){var z=I,$;switch(E){case"start":r[A]=N,$=s++;break;case"end":delete r[A],--s;case"drag":I=pe(k||M,j),$=s;break}V.call(E,v,new kn(E,{sourceEvent:M,subject:_,target:f,identifier:A,active:$,x:I[0]+T,y:I[1]+R,dx:I[0]-z[0],dy:I[1]-z[1],dispatch:V}),C)}}return f.filter=function(v){return arguments.length?(e=typeof v=="function"?v:zt(!!v),f):e},f.container=function(v){return arguments.length?(t=typeof v=="function"?v:zt(v),f):t},f.subject=function(v){return arguments.length?(n=typeof v=="function"?v:zt(v),f):n},f.touchable=function(v){return arguments.length?(o=typeof v=="function"?v:zt(!!v),f):o},f.on=function(){var v=i.on.apply(i,arguments);return v===i?f:v},f.clickDistance=function(v){return arguments.length?(d=(v=+v)*v,f):Math.sqrt(d)},f}var Ye=0,lt=0,st=0,Dr=1e3,Xt,ut,Yt=0,Te=0,en=0,ht=typeof performance=="object"&&performance.now?performance:Date,Tr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function On(){return Te||(Tr(jl),Te=ht.now()+en)}function jl(){Te=0}function Zt(){this._call=this._time=this._next=null}Zt.prototype=$r.prototype={constructor:Zt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?On():+n)+(t==null?0:+t),!this._next&&ut!==this&&(ut?ut._next=this:Xt=this,ut=this),this._call=e,this._time=n,Mn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Mn())}};function $r(e,t,n){var o=new Zt;return o.restart(e,t,n),o}function Cl(){On(),++Ye;for(var e=Xt,t;e;)(t=Te-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ye}function bo(){Te=(Yt=ht.now())+en,Ye=lt=0;try{Cl()}finally{Ye=0,kl(),Te=0}}function Nl(){var e=ht.now(),t=e-Yt;t>Dr&&(en-=t,Yt=e)}function kl(){for(var e,t=Xt,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Xt=n);ut=e,Mn(o)}function Mn(e){if(!Ye){lt&&(lt=clearTimeout(lt));var t=e-Te;t>24?(e<1/0&&(lt=setTimeout(bo,e-ht.now()-en)),st&&(st=clearInterval(st))):(st||(Yt=ht.now(),st=setInterval(Nl,Dr)),Ye=1,Tr(bo))}}function So(e,t,n){var o=new Zt;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var Ml=Qt("start","end","cancel","interrupt"),Il=[],Rr=0,Eo=1,In=2,Vt=3,jo=4,zn=5,Bt=6;function tn(e,t,n,o,r,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;zl(e,n,{name:t,index:o,group:r,on:Ml,tween:Il,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Rr})}function Fn(e,t){var n=xe(e,t);if(n.state>Rr)throw new Error("too late; already scheduled");return n}function we(e,t){var n=xe(e,t);if(n.state>Vt)throw new Error("too late; already running");return n}function xe(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function zl(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=$r(i,0,n.time);function i(u){n.state=Eo,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var h,d,f,m;if(n.state!==Eo)return l();for(h in o)if(m=o[h],m.name===n.name){if(m.state===Vt)return So(s);m.state===jo?(m.state=Bt,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete o[h]):+h<t&&(m.state=Bt,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete o[h])}if(So(function(){n.state===Vt&&(n.state=jo,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=In,n.on.call("start",e,e.__data__,n.index,n.group),n.state===In){for(n.state=Vt,r=new Array(f=n.tween.length),h=0,d=-1;h<f;++h)(m=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(r[++d]=m);r.length=d+1}}function a(u){for(var h=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=zn,1),d=-1,f=r.length;++d<f;)r[d].call(e,h);n.state===zn&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Bt,n.timer.stop(),delete o[t];for(var u in o)return;delete e.__transition}}function Ot(e,t){var n=e.__transition,o,r,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((o=n[s]).name!==t){i=!1;continue}r=o.state>In&&o.state<zn,o.state=Bt,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[s]}i&&delete e.__transition}}function Pl(e){return this.each(function(){Ot(this,e)})}function Al(e,t){var n,o;return function(){var r=we(this,e),i=r.tween;if(i!==n){o=n=i;for(var s=0,a=o.length;s<a;++s)if(o[s].name===t){o=o.slice(),o.splice(s,1);break}}r.tween=o}}function Dl(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var i=we(this,e),s=i.tween;if(s!==o){r=(o=s).slice();for(var a={name:t,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===t){r[l]=a;break}l===u&&r.push(a)}i.tween=r}}function Tl(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=xe(this.node(),n).tween,r=0,i=o.length,s;r<i;++r)if((s=o[r]).name===e)return s.value;return null}return this.each((t==null?Al:Dl)(n,e,t))}function Wn(e,t,n){var o=e._id;return e.each(function(){var r=we(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return xe(r,o).value[t]}}function Lr(e,t){var n;return(typeof t=="number"?Pe:t instanceof mo?go:(n=mo(t))?(t=n,go):ma)(e,t)}function $l(e){return function(){this.removeAttribute(e)}}function Rl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ll(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttribute(e);return s===r?null:s===o?i:i=t(o=s,n)}}function Hl(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===o?i:i=t(o=s,n)}}function Vl(e,t,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a)))}}function Bl(e,t,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a)))}}function Ol(e,t){var n=Jt(e),o=n==="transform"?Da:Lr;return this.attrTween(e,typeof t=="function"?(n.local?Bl:Vl)(n,o,Wn(this,"attr."+e,t)):t==null?(n.local?Rl:$l)(n):(n.local?Hl:Ll)(n,o,t))}function Fl(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Wl(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Xl(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&Wl(e,i)),n}return r._value=t,r}function Yl(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&Fl(e,i)),n}return r._value=t,r}function Zl(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=Jt(e);return this.tween(n,(o.local?Xl:Yl)(o,t))}function Gl(e,t){return function(){Fn(this,e).delay=+t.apply(this,arguments)}}function ql(e,t){return t=+t,function(){Fn(this,e).delay=t}}function Ul(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Gl:ql)(t,e)):xe(this.node(),t).delay}function Kl(e,t){return function(){we(this,e).duration=+t.apply(this,arguments)}}function Ql(e,t){return t=+t,function(){we(this,e).duration=t}}function Jl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Kl:Ql)(t,e)):xe(this.node(),t).duration}function eu(e,t){if(typeof t!="function")throw new Error;return function(){we(this,e).ease=t}}function tu(e){var t=this._id;return arguments.length?this.each(eu(t,e)):xe(this.node(),t).ease}function nu(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;we(this,e).ease=n}}function ou(e){if(typeof e!="function")throw new Error;return this.each(nu(this._id,e))}function ru(e){typeof e!="function"&&(e=_r(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],l,u=0;u<s;++u)(l=i[u])&&e.call(l,l.__data__,u,i)&&a.push(l);return new Se(o,this._parents,this._name,this._id)}function su(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),s=new Array(o),a=0;a<i;++a)for(var l=t[a],u=n[a],h=l.length,d=s[a]=new Array(h),f,m=0;m<h;++m)(f=l[m]||u[m])&&(d[m]=f);for(;a<o;++a)s[a]=t[a];return new Se(s,this._parents,this._name,this._id)}function iu(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function au(e,t,n){var o,r,i=iu(t)?Fn:we;return function(){var s=i(this,e),a=s.on;a!==o&&(r=(o=a).copy()).on(t,n),s.on=r}}function cu(e,t){var n=this._id;return arguments.length<2?xe(this.node(),n).on.on(e):this.each(au(n,e,t))}function lu(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function uu(){return this.on("end.remove",lu(this._id))}function du(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Vn(e));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var a=o[s],l=a.length,u=i[s]=new Array(l),h,d,f=0;f<l;++f)(h=a[f])&&(d=e.call(h,h.__data__,f,a))&&("__data__"in h&&(d.__data__=h.__data__),u[f]=d,tn(u[f],t,n,f,u,xe(h,n)));return new Se(i,this._parents,t,n)}function fu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=vr(e));for(var o=this._groups,r=o.length,i=[],s=[],a=0;a<r;++a)for(var l=o[a],u=l.length,h,d=0;d<u;++d)if(h=l[d]){for(var f=e.call(h,h.__data__,d,l),m,p=xe(h,n),y=0,w=f.length;y<w;++y)(m=f[y])&&tn(m,t,n,y,f,p);i.push(f),s.push(h)}return new Se(i,s,t,n)}var hu=wt.prototype.constructor;function pu(){return new hu(this._groups,this._parents)}function gu(e,t){var n,o,r;return function(){var i=Xe(this,e),s=(this.style.removeProperty(e),Xe(this,e));return i===s?null:i===n&&s===o?r:r=t(n=i,o=s)}}function Hr(e){return function(){this.style.removeProperty(e)}}function mu(e,t,n){var o,r=n+"",i;return function(){var s=Xe(this,e);return s===r?null:s===o?i:i=t(o=s,n)}}function xu(e,t,n){var o,r,i;return function(){var s=Xe(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),Xe(this,e))),s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a))}}function yu(e,t){var n,o,r,i="style."+t,s="end."+i,a;return function(){var l=we(this,e),u=l.on,h=l.value[i]==null?a||(a=Hr(t)):void 0;(u!==n||r!==h)&&(o=(n=u).copy()).on(s,r=h),l.on=o}}function wu(e,t,n){var o=(e+="")=="transform"?Aa:Lr;return t==null?this.styleTween(e,gu(e,o)).on("end.style."+e,Hr(e)):typeof t=="function"?this.styleTween(e,xu(e,o,Wn(this,"style."+e,t))).each(yu(this._id,e)):this.styleTween(e,mu(e,o,t),n).on("end.style."+e,null)}function vu(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function _u(e,t,n){var o,r;function i(){var s=t.apply(this,arguments);return s!==r&&(o=(r=s)&&vu(e,s,n)),o}return i._value=t,i}function bu(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,_u(e,t,n??""))}function Su(e){return function(){this.textContent=e}}function Eu(e){return function(){var t=e(this);this.textContent=t??""}}function ju(e){return this.tween("text",typeof e=="function"?Eu(Wn(this,"text",e)):Su(e==null?"":e+""))}function Cu(e){return function(t){this.textContent=e.call(this,t)}}function Nu(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Cu(r)),t}return o._value=e,o}function ku(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Nu(e))}function Mu(){for(var e=this._name,t=this._id,n=Vr(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,u=0;u<a;++u)if(l=s[u]){var h=xe(l,t);tn(l,e,n,u,s,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Se(o,this._parents,e,n)}function Iu(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--r===0&&i()}};n.each(function(){var u=we(this,o),h=u.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),u.on=t}),r===0&&i()})}var zu=0;function Se(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function Vr(){return++zu}var _e=wt.prototype;Se.prototype={constructor:Se,select:du,selectAll:fu,selectChild:_e.selectChild,selectChildren:_e.selectChildren,filter:ru,merge:su,selection:pu,transition:Mu,call:_e.call,nodes:_e.nodes,node:_e.node,size:_e.size,empty:_e.empty,each:_e.each,on:cu,attr:Ol,attrTween:Zl,style:wu,styleTween:bu,text:ju,textTween:ku,remove:uu,tween:Tl,delay:Ul,duration:Jl,ease:tu,easeVarying:ou,end:Iu,[Symbol.iterator]:_e[Symbol.iterator]};function Pu(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Au={time:null,delay:0,duration:250,ease:Pu};function Du(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Tu(e){var t,n;e instanceof Se?(t=e._id,e=e._name):(t=Vr(),(n=Au).time=On(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,u=0;u<a;++u)(l=s[u])&&tn(l,e,t,u,s,n||Du(l,t));return new Se(o,this._parents,e,t)}wt.prototype.interrupt=Pl;wt.prototype.transition=Tu;const Pt=e=>()=>e;function $u(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function be(e,t,n){this.k=e,this.x=t,this.y=n}be.prototype={constructor:be,scale:function(e){return e===1?this:new be(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new be(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var nn=new be(1,0,0);Br.prototype=be.prototype;function Br(e){for(;!e.__zoom;)if(!(e=e.parentNode))return nn;return e.__zoom}function yn(e){e.stopImmediatePropagation()}function it(e){e.preventDefault(),e.stopImmediatePropagation()}function Ru(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Lu(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Co(){return this.__zoom||nn}function Hu(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Vu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Bu(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Or(){var e=Ru,t=Lu,n=Bu,o=Hu,r=Vu,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=Lt,u=Qt("start","zoom","end"),h,d,f,m=500,p=150,y=0,w=10;function x(_){_.property("__zoom",Co).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",V).filter(r).on("touchstart.zoom",I).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(_,N,E,M){var k=_.selection?_.selection():_;k.property("__zoom",Co),_!==k?j(_,N,E,M):k.interrupt().each(function(){S(this,arguments).event(M).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},x.scaleBy=function(_,N,E,M){x.scaleTo(_,function(){var k=this.__zoom.k,z=typeof N=="function"?N.apply(this,arguments):N;return k*z},E,M)},x.scaleTo=function(_,N,E,M){x.transform(_,function(){var k=t.apply(this,arguments),z=this.__zoom,$=E==null?v(k):typeof E=="function"?E.apply(this,arguments):E,H=z.invert($),L=typeof N=="function"?N.apply(this,arguments):N;return n(g(b(z,L),$,H),k,s)},E,M)},x.translateBy=function(_,N,E,M){x.transform(_,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof E=="function"?E.apply(this,arguments):E),t.apply(this,arguments),s)},null,M)},x.translateTo=function(_,N,E,M,k){x.transform(_,function(){var z=t.apply(this,arguments),$=this.__zoom,H=M==null?v(z):typeof M=="function"?M.apply(this,arguments):M;return n(nn.translate(H[0],H[1]).scale($.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof E=="function"?-E.apply(this,arguments):-E),z,s)},M,k)};function b(_,N){return N=Math.max(i[0],Math.min(i[1],N)),N===_.k?_:new be(N,_.x,_.y)}function g(_,N,E){var M=N[0]-E[0]*_.k,k=N[1]-E[1]*_.k;return M===_.x&&k===_.y?_:new be(_.k,M,k)}function v(_){return[(+_[0][0]+ +_[1][0])/2,(+_[0][1]+ +_[1][1])/2]}function j(_,N,E,M){_.on("start.zoom",function(){S(this,arguments).event(M).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(M).end()}).tween("zoom",function(){var k=this,z=arguments,$=S(k,z).event(M),H=t.apply(k,z),L=E==null?v(H):typeof E=="function"?E.apply(k,z):E,W=Math.max(H[1][0]-H[0][0],H[1][1]-H[0][1]),F=k.__zoom,U=typeof N=="function"?N.apply(k,z):N,J=l(F.invert(L).concat(W/F.k),U.invert(L).concat(W/U.k));return function(Z){if(Z===1)Z=U;else{var B=J(Z),Y=W/B[2];Z=new be(Y,L[0]-B[0]*Y,L[1]-B[1]*Y)}$.zoom(null,Z)}})}function S(_,N,E){return!E&&_.__zooming||new C(_,N)}function C(_,N){this.that=_,this.args=N,this.active=0,this.sourceEvent=null,this.extent=t.apply(_,N),this.taps=0}C.prototype={event:function(_){return _&&(this.sourceEvent=_),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(_,N){return this.mouse&&_!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&_!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&_!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(_){var N=fe(this.that).datum();u.call(_,this.that,new $u(_,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:u}),N)}};function A(_,...N){if(!e.apply(this,arguments))return;var E=S(this,N).event(_),M=this.__zoom,k=Math.max(i[0],Math.min(i[1],M.k*Math.pow(2,o.apply(this,arguments)))),z=pe(_);if(E.wheel)(E.mouse[0][0]!==z[0]||E.mouse[0][1]!==z[1])&&(E.mouse[1]=M.invert(E.mouse[0]=z)),clearTimeout(E.wheel);else{if(M.k===k)return;E.mouse=[z,M.invert(z)],Ot(this),E.start()}it(_),E.wheel=setTimeout($,p),E.zoom("mouse",n(g(b(M,k),E.mouse[0],E.mouse[1]),E.extent,s));function $(){E.wheel=null,E.end()}}function P(_,...N){if(f||!e.apply(this,arguments))return;var E=_.currentTarget,M=S(this,N,!0).event(_),k=fe(_.view).on("mousemove.zoom",L,!0).on("mouseup.zoom",W,!0),z=pe(_,E),$=_.clientX,H=_.clientY;zr(_.view),yn(_),M.mouse=[z,this.__zoom.invert(z)],Ot(this),M.start();function L(F){if(it(F),!M.moved){var U=F.clientX-$,J=F.clientY-H;M.moved=U*U+J*J>y}M.event(F).zoom("mouse",n(g(M.that.__zoom,M.mouse[0]=pe(F,E),M.mouse[1]),M.extent,s))}function W(F){k.on("mousemove.zoom mouseup.zoom",null),Pr(F.view,M.moved),it(F),M.event(F).end()}}function V(_,...N){if(e.apply(this,arguments)){var E=this.__zoom,M=pe(_.changedTouches?_.changedTouches[0]:_,this),k=E.invert(M),z=E.k*(_.shiftKey?.5:2),$=n(g(b(E,z),M,k),t.apply(this,N),s);it(_),a>0?fe(this).transition().duration(a).call(j,$,M,_):fe(this).call(x.transform,$,M,_)}}function I(_,...N){if(e.apply(this,arguments)){var E=_.touches,M=E.length,k=S(this,N,_.changedTouches.length===M).event(_),z,$,H,L;for(yn(_),$=0;$<M;++$)H=E[$],L=pe(H,this),L=[L,this.__zoom.invert(L),H.identifier],k.touch0?!k.touch1&&k.touch0[2]!==L[2]&&(k.touch1=L,k.taps=0):(k.touch0=L,z=!0,k.taps=1+!!h);h&&(h=clearTimeout(h)),z&&(k.taps<2&&(d=L[0],h=setTimeout(function(){h=null},m)),Ot(this),k.start())}}function T(_,...N){if(this.__zooming){var E=S(this,N).event(_),M=_.changedTouches,k=M.length,z,$,H,L;for(it(_),z=0;z<k;++z)$=M[z],H=pe($,this),E.touch0&&E.touch0[2]===$.identifier?E.touch0[0]=H:E.touch1&&E.touch1[2]===$.identifier&&(E.touch1[0]=H);if($=E.that.__zoom,E.touch1){var W=E.touch0[0],F=E.touch0[1],U=E.touch1[0],J=E.touch1[1],Z=(Z=U[0]-W[0])*Z+(Z=U[1]-W[1])*Z,B=(B=J[0]-F[0])*B+(B=J[1]-F[1])*B;$=b($,Math.sqrt(Z/B)),H=[(W[0]+U[0])/2,(W[1]+U[1])/2],L=[(F[0]+J[0])/2,(F[1]+J[1])/2]}else if(E.touch0)H=E.touch0[0],L=E.touch0[1];else return;E.zoom("touch",n(g($,H,L),E.extent,s))}}function R(_,...N){if(this.__zooming){var E=S(this,N).event(_),M=_.changedTouches,k=M.length,z,$;for(yn(_),f&&clearTimeout(f),f=setTimeout(function(){f=null},m),z=0;z<k;++z)$=M[z],E.touch0&&E.touch0[2]===$.identifier?delete E.touch0:E.touch1&&E.touch1[2]===$.identifier&&delete E.touch1;if(E.touch1&&!E.touch0&&(E.touch0=E.touch1,delete E.touch1),E.touch0)E.touch0[1]=this.__zoom.invert(E.touch0[0]);else if(E.end(),E.taps===2&&($=pe($,this),Math.hypot(d[0]-$[0],d[1]-$[1])<w)){var H=fe(this).on("dblclick.zoom");H&&H.apply(this,arguments)}}}return x.wheelDelta=function(_){return arguments.length?(o=typeof _=="function"?_:Pt(+_),x):o},x.filter=function(_){return arguments.length?(e=typeof _=="function"?_:Pt(!!_),x):e},x.touchable=function(_){return arguments.length?(r=typeof _=="function"?_:Pt(!!_),x):r},x.extent=function(_){return arguments.length?(t=typeof _=="function"?_:Pt([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),x):t},x.scaleExtent=function(_){return arguments.length?(i[0]=+_[0],i[1]=+_[1],x):[i[0],i[1]]},x.translateExtent=function(_){return arguments.length?(s[0][0]=+_[0][0],s[1][0]=+_[1][0],s[0][1]=+_[0][1],s[1][1]=+_[1][1],x):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},x.constrain=function(_){return arguments.length?(n=_,x):n},x.duration=function(_){return arguments.length?(a=+_,x):a},x.interpolate=function(_){return arguments.length?(l=_,x):l},x.on=function(){var _=u.on.apply(u,arguments);return _===u?x:_},x.clickDistance=function(_){return arguments.length?(y=(_=+_)*_,x):Math.sqrt(y)},x.tapDistance=function(_){return arguments.length?(w=+_,x):w},x}const ye={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},pt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Fr=["Enter"," ","Escape"],Wr={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Ze;(function(e){e.Strict="strict",e.Loose="loose"})(Ze||(Ze={}));var De;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(De||(De={}));var gt;(function(e){e.Partial="partial",e.Full="full"})(gt||(gt={}));const Xr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Me;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Me||(Me={}));var Gt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Gt||(Gt={}));var X;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(X||(X={}));const No={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top};function Yr(e){return e===null?null:e?"valid":"invalid"}const Zr=e=>"id"in e&&"source"in e&&"target"in e,Ou=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Xn=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),vt=(e,t=[0,0])=>{const{width:n,height:o}=Ee(e),r=e.origin??t,i=n*r[0],s=o*r[1];return{x:e.position.x-i,y:e.position.y-s}},Fu=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,r)=>{const i=typeof r=="string";let s=!t.nodeLookup&&!i?r:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(r):Xn(r)?r:t.nodeLookup.get(r.id));const a=s?qt(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return on(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return rn(n)},_t=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(r=>{(t.filter===void 0||t.filter(r))&&(n=on(n,qt(r)),o=!0)}),o?rn(n):{x:0,y:0,width:0,height:0}},Yn=(e,t,[n,o,r]=[0,0,1],i=!1,s=!1)=>{const a={...St(t,[n,o,r]),width:t.width/r,height:t.height/r},l=[];for(const u of e.values()){const{measured:h,selectable:d=!0,hidden:f=!1}=u;if(s&&!d||f)continue;const m=h.width??u.width??u.initialWidth??null,p=h.height??u.height??u.initialHeight??null,y=mt(a,qe(u)),w=(m??0)*(p??0),x=i&&y>0;(!u.internals.handleBounds||x||y>=w||u.dragging)&&l.push(u)}return l},Wu=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Xu(e,t){const n=new Map,o=t?.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&(t?.includeHiddenNodes||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function Yu({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:i},s){if(e.size===0)return Promise.resolve(!0);const a=Xu(e,s),l=_t(a),u=Zn(l,t,n,s?.minZoom??r,s?.maxZoom??i,s?.padding??.1);return await o.setViewport(u,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)}function Gr({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:i}){const s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:l,y:u}=a?a.internals.positionAbsolute:{x:0,y:0},h=s.origin??o;let d=s.extent||r;if(s.extent==="parent"&&!s.expandParent)if(!a)i?.("005",ye.error005());else{const m=a.measured.width,p=a.measured.height;m&&p&&(d=[[l,u],[l+m,u+p]])}else a&&Ue(s.extent)&&(d=[[s.extent[0][0]+l,s.extent[0][1]+u],[s.extent[1][0]+l,s.extent[1][1]+u]]);const f=Ue(d)?$e(t,d,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",ye.error015()),{position:{x:f.x-l+(s.measured.width??0)*h[0],y:f.y-u+(s.measured.height??0)*h[1]},positionAbsolute:f}}async function Zu({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){const i=new Set(e.map(f=>f.id)),s=[];for(const f of n){if(f.deletable===!1)continue;const m=i.has(f.id),p=!m&&f.parentId&&s.find(y=>y.id===f.parentId);(m||p)&&s.push(f)}const a=new Set(t.map(f=>f.id)),l=o.filter(f=>f.deletable!==!1),h=Wu(s,l);for(const f of l)a.has(f.id)&&!h.find(p=>p.id===f.id)&&h.push(f);if(!r)return{edges:h,nodes:s};const d=await r({nodes:s,edges:h});return typeof d=="boolean"?d?{edges:h,nodes:s}:{edges:[],nodes:[]}:d}const Ge=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),$e=(e={x:0,y:0},t,n)=>({x:Ge(e.x,t[0][0],t[1][0]-(n?.width??0)),y:Ge(e.y,t[0][1],t[1][1]-(n?.height??0))});function qr(e,t,n){const{width:o,height:r}=Ee(n),{x:i,y:s}=n.internals.positionAbsolute;return $e(e,[[i,s],[i+o,s+r]],t)}const ko=(e,t,n)=>e<t?Ge(Math.abs(e-t),1,t)/t:e>n?-Ge(Math.abs(e-n),1,t)/t:0,Ur=(e,t,n=15,o=40)=>{const r=ko(e.x,o,t.width-o)*n,i=ko(e.y,o,t.height-o)*n;return[r,i]},on=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Pn=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),rn=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),qe=(e,t=[0,0])=>{const{x:n,y:o}=Xn(e)?e.internals.positionAbsolute:vt(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},qt=(e,t=[0,0])=>{const{x:n,y:o}=Xn(e)?e.internals.positionAbsolute:vt(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},Kr=(e,t)=>rn(on(Pn(e),Pn(t))),mt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Mo=e=>ge(e.width)&&ge(e.height)&&ge(e.x)&&ge(e.y),ge=e=>!isNaN(e)&&isFinite(e),Gu=(e,t)=>{},bt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),St=({x:e,y:t},[n,o,r],i=!1,s=[1,1])=>{const a={x:(e-n)/r,y:(t-o)/r};return i?bt(a,s):a},Ut=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function Ve(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function qu(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Ve(e,n),r=Ve(e,t);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof e=="object"){const o=Ve(e.top??e.y??0,n),r=Ve(e.bottom??e.y??0,n),i=Ve(e.left??e.x??0,t),s=Ve(e.right??e.x??0,t);return{top:o,right:s,bottom:r,left:i,x:i+s,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Uu(e,t,n,o,r,i){const{x:s,y:a}=Ut(e,[t,n,o]),{x:l,y:u}=Ut({x:e.x+e.width,y:e.y+e.height},[t,n,o]),h=r-l,d=i-u;return{left:Math.floor(s),top:Math.floor(a),right:Math.floor(h),bottom:Math.floor(d)}}const Zn=(e,t,n,o,r,i)=>{const s=qu(i,t,n),a=(t-s.x)/e.width,l=(n-s.y)/e.height,u=Math.min(a,l),h=Ge(u,o,r),d=e.x+e.width/2,f=e.y+e.height/2,m=t/2-d*h,p=n/2-f*h,y=Uu(e,m,p,h,t,n),w={left:Math.min(y.left-s.left,0),top:Math.min(y.top-s.top,0),right:Math.min(y.right-s.right,0),bottom:Math.min(y.bottom-s.bottom,0)};return{x:m-w.left+w.right,y:p-w.top+w.bottom,zoom:h}},xt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Ue(e){return e!=null&&e!=="parent"}function Ee(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Qr(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function Jr(e,t={width:0,height:0},n,o,r){const i={...e},s=o.get(n);if(s){const a=s.origin||r;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function Io(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Ku(){let e,t;return{promise:new Promise((o,r)=>{e=o,t=r}),resolve:e,reject:t}}function Qu(e){return{...Wr,...e||{}}}function dt(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:i,y:s}=me(e),a=St({x:i-(r?.left??0),y:s-(r?.top??0)},o),{x:l,y:u}=n?bt(a,t):a;return{xSnapped:l,ySnapped:u,...a}}const Gn=e=>({width:e.offsetWidth,height:e.offsetHeight}),es=e=>e?.getRootNode?.()||window?.document,Ju=["INPUT","SELECT","TEXTAREA"];function ts(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Ju.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ns=e=>"clientX"in e,me=(e,t)=>{const n=ns(e),o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},zo=(e,t,n,o,r)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{const a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:r,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...Gn(s)}})};function os({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:s,targetControlY:a}){const l=e*.125+r*.375+s*.375+n*.125,u=t*.125+i*.375+a*.375+o*.125,h=Math.abs(l-e),d=Math.abs(u-t);return[l,u,h,d]}function At(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Po({pos:e,x1:t,y1:n,x2:o,y2:r,c:i}){switch(e){case X.Left:return[t-At(t-o,i),n];case X.Right:return[t+At(o-t,i),n];case X.Top:return[t,n-At(n-r,i)];case X.Bottom:return[t,n+At(r-n,i)]}}function rs({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:i=X.Top,curvature:s=.25}){const[a,l]=Po({pos:n,x1:e,y1:t,x2:o,y2:r,c:s}),[u,h]=Po({pos:i,x1:o,y1:r,x2:e,y2:t,c:s}),[d,f,m,p]=os({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:u,targetControlY:h});return[`M${e},${t} C${a},${l} ${u},${h} ${o},${r}`,d,f,m,p]}function ss({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,i=n<e?n+r:n-r,s=Math.abs(o-t)/2,a=o<t?o+s:o-s;return[i,a,r,s]}function ed({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1,zIndexMode:i="basic"}){if(i==="manual")return o;const s=r&&n?o+1e3:o,a=Math.max(e.parentId||r&&e.selected?e.internals.z:0,t.parentId||r&&t.selected?t.internals.z:0);return s+a}function td({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){const i=on(qt(e),qt(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return mt(s,rn(i))>0}const nd=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,od=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),rd=(e,t,n={})=>{if(!e.source||!e.target)return t;const o=n.getEdgeId||nd;let r;return Zr(e)?r={...e}:r={...e,id:o(e)},od(r,t)?t:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,t.concat(r))};function is({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,i,s,a]=ss({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,i,s,a]}const Ao={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}},sd=({source:e,sourcePosition:t=X.Bottom,target:n})=>t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Do=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function id({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:o=X.Top,center:r,offset:i,stepPosition:s}){const a=Ao[t],l=Ao[o],u={x:e.x+a.x*i,y:e.y+a.y*i},h={x:n.x+l.x*i,y:n.y+l.y*i},d=sd({source:u,sourcePosition:t,target:h}),f=d.x!==0?"x":"y",m=d[f];let p=[],y,w;const x={x:0,y:0},b={x:0,y:0},[,,g,v]=ss({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[f]*l[f]===-1){f==="x"?(y=r.x??u.x+(h.x-u.x)*s,w=r.y??(u.y+h.y)/2):(y=r.x??(u.x+h.x)/2,w=r.y??u.y+(h.y-u.y)*s);const S=[{x:y,y:u.y},{x:y,y:h.y}],C=[{x:u.x,y:w},{x:h.x,y:w}];a[f]===m?p=f==="x"?S:C:p=f==="x"?C:S}else{const S=[{x:u.x,y:h.y}],C=[{x:h.x,y:u.y}];if(f==="x"?p=a.x===m?C:S:p=a.y===m?S:C,t===o){const T=Math.abs(e[f]-n[f]);if(T<=i){const R=Math.min(i-1,i-T);a[f]===m?x[f]=(u[f]>e[f]?-1:1)*R:b[f]=(h[f]>n[f]?-1:1)*R}}if(t!==o){const T=f==="x"?"y":"x",R=a[f]===l[T],_=u[T]>h[T],N=u[T]<h[T];(a[f]===1&&(!R&&_||R&&N)||a[f]!==1&&(!R&&N||R&&_))&&(p=f==="x"?S:C)}const A={x:u.x+x.x,y:u.y+x.y},P={x:h.x+b.x,y:h.y+b.y},V=Math.max(Math.abs(A.x-p[0].x),Math.abs(P.x-p[0].x)),I=Math.max(Math.abs(A.y-p[0].y),Math.abs(P.y-p[0].y));V>=I?(y=(A.x+P.x)/2,w=p[0].y):(y=p[0].x,w=(A.y+P.y)/2)}return[[e,{x:u.x+x.x,y:u.y+x.y},...p,{x:h.x+b.x,y:h.y+b.y},n],y,w,g,v]}function ad(e,t,n,o){const r=Math.min(Do(e,t)/2,Do(t,n)/2,o),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const u=e.x<n.x?-1:1,h=e.y<n.y?1:-1;return`L ${i+r*u},${s}Q ${i},${s} ${i},${s+r*h}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${s+r*l}Q ${i},${s} ${i+r*a},${s}`}function An({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:i=X.Top,borderRadius:s=5,centerX:a,centerY:l,offset:u=20,stepPosition:h=.5}){const[d,f,m,p,y]=id({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:a,y:l},offset:u,stepPosition:h});return[d.reduce((x,b,g)=>{let v="";return g>0&&g<d.length-1?v=ad(d[g-1],b,d[g+1],s):v=`${g===0?"M":"L"}${b.x} ${b.y}`,x+=v,x},""),f,m,p,y]}function To(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function cd(e){const{sourceNode:t,targetNode:n}=e;if(!To(t)||!To(n))return null;const o=t.internals.handleBounds||$o(t.handles),r=n.internals.handleBounds||$o(n.handles),i=Ro(o?.source??[],e.sourceHandle),s=Ro(e.connectionMode===Ze.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",ye.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=i?.position||X.Bottom,l=s?.position||X.Top,u=Re(t,i,a),h=Re(n,s,l);return{sourceX:u.x,sourceY:u.y,targetX:h.x,targetY:h.y,sourcePosition:a,targetPosition:l}}function $o(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Re(e,t,n=X.Left,o=!1){const r=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??Ee(e);if(o)return{x:r+s/2,y:i+a/2};switch(t?.position??n){case X.Top:return{x:r+s/2,y:i};case X.Right:return{x:r+s,y:i+a/2};case X.Bottom:return{x:r+s/2,y:i+a};case X.Left:return{x:r,y:i+a/2}}}function Ro(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Dn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function ld(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const i=new Set;return e.reduce((s,a)=>([a.markerStart||o,a.markerEnd||r].forEach(l=>{if(l&&typeof l=="object"){const u=Dn(l,t);i.has(u)||(s.push({id:u,color:l.color||n,...l}),i.add(u))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}const as=1e3,ud=10,qn={nodeOrigin:[0,0],nodeExtent:pt,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},dd={...qn,checkEquality:!0};function Un(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function fd(e,t,n){const o=Un(qn,n);for(const r of e.values())if(r.parentId)Qn(r,e,t,o);else{const i=vt(r,o.nodeOrigin),s=Ue(r.extent)?r.extent:o.nodeExtent,a=$e(i,s,Ee(r));r.internals.positionAbsolute=a}}function hd(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],o=[];for(const r of e.handles){const i={id:r.id,width:r.width??1,height:r.height??1,nodeId:e.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(i):r.type==="target"&&o.push(i)}return{source:n,target:o}}function Kn(e){return e==="manual"}function Tn(e,t,n,o={}){const r=Un(dd,o),i={i:0},s=new Map(t),a=r?.elevateNodesOnSelect&&!Kn(r.zIndexMode)?as:0;let l=e.length>0;t.clear(),n.clear();for(const u of e){let h=s.get(u.id);if(r.checkEquality&&u===h?.internals.userNode)t.set(u.id,h);else{const d=vt(u,r.nodeOrigin),f=Ue(u.extent)?u.extent:r.nodeExtent,m=$e(d,f,Ee(u));h={...r.defaults,...u,measured:{width:u.measured?.width,height:u.measured?.height},internals:{positionAbsolute:m,handleBounds:hd(u,h),z:cs(u,a,r.zIndexMode),userNode:u}},t.set(u.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(l=!1),u.parentId&&Qn(h,t,n,o,i)}return l}function pd(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Qn(e,t,n,o,r){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:a,zIndexMode:l}=Un(qn,o),u=e.parentId,h=t.get(u);if(!h){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}pd(e,n),r&&!h.parentId&&h.internals.rootParentIndex===void 0&&l==="auto"&&(h.internals.rootParentIndex=++r.i,h.internals.z=h.internals.z+r.i*ud),r&&h.internals.rootParentIndex!==void 0&&(r.i=h.internals.rootParentIndex);const d=i&&!Kn(l)?as:0,{x:f,y:m,z:p}=gd(e,h,s,a,d,l),{positionAbsolute:y}=e.internals,w=f!==y.x||m!==y.y;(w||p!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:w?{x:f,y:m}:y,z:p}})}function cs(e,t,n){const o=ge(e.zIndex)?e.zIndex:0;return Kn(n)?o:o+(e.selected?t:0)}function gd(e,t,n,o,r,i){const{x:s,y:a}=t.internals.positionAbsolute,l=Ee(e),u=vt(e,n),h=Ue(e.extent)?$e(u,e.extent,l):u;let d=$e({x:s+h.x,y:a+h.y},o,l);e.extent==="parent"&&(d=qr(d,l,t));const f=cs(e,r,i),m=t.internals.z??0;return{x:d.x,y:d.y,z:m>=f?m+1:f}}function Jn(e,t,n,o=[0,0]){const r=[],i=new Map;for(const s of e){const a=t.get(s.parentId);if(!a)continue;const l=i.get(s.parentId)?.expandedRect??qe(a),u=Kr(l,s.rect);i.set(s.parentId,{expandedRect:u,parent:a})}return i.size>0&&i.forEach(({expandedRect:s,parent:a},l)=>{const u=a.internals.positionAbsolute,h=Ee(a),d=a.origin??o,f=s.x<u.x?Math.round(Math.abs(u.x-s.x)):0,m=s.y<u.y?Math.round(Math.abs(u.y-s.y)):0,p=Math.max(h.width,Math.round(s.width)),y=Math.max(h.height,Math.round(s.height)),w=(p-h.width)*d[0],x=(y-h.height)*d[1];(f>0||m>0||w||x)&&(r.push({id:l,type:"position",position:{x:a.position.x-f+w,y:a.position.y-m+x}}),n.get(l)?.forEach(b=>{e.some(g=>g.id===b.id)||r.push({id:b.id,type:"position",position:{x:b.position.x+f,y:b.position.y+m}})})),(h.width<s.width||h.height<s.height||f||m)&&r.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:p+(f?d[0]*f-w:0),height:y+(m?d[1]*m-x:0)}})}),r}function md(e,t,n,o,r,i,s){const a=o?.querySelector(".xyflow__viewport");let l=!1;if(!a)return{changes:[],updatedInternals:l};const u=[],h=window.getComputedStyle(a),{m22:d}=new window.DOMMatrixReadOnly(h.transform),f=[];for(const m of e.values()){const p=t.get(m.id);if(!p)continue;if(p.hidden){t.set(p.id,{...p,internals:{...p.internals,handleBounds:void 0}}),l=!0;continue}const y=Gn(m.nodeElement),w=p.measured.width!==y.width||p.measured.height!==y.height;if(!!(y.width&&y.height&&(w||!p.internals.handleBounds||m.force))){const b=m.nodeElement.getBoundingClientRect(),g=Ue(p.extent)?p.extent:i;let{positionAbsolute:v}=p.internals;p.parentId&&p.extent==="parent"?v=qr(v,y,t.get(p.parentId)):g&&(v=$e(v,g,y));const j={...p,measured:y,internals:{...p.internals,positionAbsolute:v,handleBounds:{source:zo("source",m.nodeElement,b,d,p.id),target:zo("target",m.nodeElement,b,d,p.id)}}};t.set(p.id,j),p.parentId&&Qn(j,t,n,{nodeOrigin:r,zIndexMode:s}),l=!0,w&&(u.push({id:p.id,type:"dimensions",dimensions:y}),p.expandParent&&p.parentId&&f.push({id:p.id,parentId:p.parentId,rect:qe(j,r)}))}}if(f.length>0){const m=Jn(f,t,n,r);u.push(...m)}return{changes:u,updatedInternals:l}}async function xd({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],o),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function Lo(e,t,n,o,r,i){let s=r;const a=o.get(s)||new Map;o.set(s,a.set(n,t)),s=`${r}-${e}`;const l=o.get(s)||new Map;if(o.set(s,l.set(n,t)),i){s=`${r}-${e}-${i}`;const u=o.get(s)||new Map;o.set(s,u.set(n,t))}}function ls(e,t,n){e.clear(),t.clear();for(const o of n){const{source:r,target:i,sourceHandle:s=null,targetHandle:a=null}=o,l={edgeId:o.id,source:r,target:i,sourceHandle:s,targetHandle:a},u=`${r}-${s}--${i}-${a}`,h=`${i}-${a}--${r}-${s}`;Lo("source",l,h,e,r,s),Lo("target",l,u,e,i,a),t.set(o.id,o)}}function us(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:us(n,t):!1}function Ho(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function yd(e,t,n,o){const r=new Map;for(const[i,s]of e)if((s.selected||s.id===o)&&(!s.parentId||!us(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const a=e.get(i);a&&r.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function wn({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){const r=[];for(const[s,a]of t){const l=n.get(s)?.internals.userNode;l&&r.push({...l,position:a.position,dragging:o})}if(!e)return[r[0],r];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:o}:r[0],r]}function wd({dragItems:e,snapGrid:t,x:n,y:o}){const r=e.values().next().value;if(!r)return null;const i={x:n-r.distance.x,y:o-r.distance.y},s=bt(i,t);return{x:s.x-i.x,y:s.y-i.y}}function vd({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let i={x:null,y:null},s=0,a=new Map,l=!1,u={x:0,y:0},h=null,d=!1,f=null,m=!1,p=!1,y=null;function w({noDragClassName:b,handleSelector:g,domNode:v,isSelectable:j,nodeId:S,nodeClickDistance:C=0}){f=fe(v);function A({x:T,y:R}){const{nodeLookup:_,nodeExtent:N,snapGrid:E,snapToGrid:M,nodeOrigin:k,onNodeDrag:z,onSelectionDrag:$,onError:H,updateNodePositions:L}=t();i={x:T,y:R};let W=!1;const F=a.size>1,U=F&&N?Pn(_t(a)):null,J=F&&M?wd({dragItems:a,snapGrid:E,x:T,y:R}):null;for(const[Z,B]of a){if(!_.has(Z))continue;let Y={x:T-B.distance.x,y:R-B.distance.y};M&&(Y=J?{x:Math.round(Y.x+J.x),y:Math.round(Y.y+J.y)}:bt(Y,E));let te=null;if(F&&N&&!B.extent&&U){const{positionAbsolute:Q}=B.internals,oe=Q.x-U.x+N[0][0],se=Q.x+B.measured.width-U.x2+N[1][0],re=Q.y-U.y+N[0][1],le=Q.y+B.measured.height-U.y2+N[1][1];te=[[oe,re],[se,le]]}const{position:ee,positionAbsolute:K}=Gr({nodeId:Z,nextPosition:Y,nodeLookup:_,nodeExtent:te||N,nodeOrigin:k,onError:H});W=W||B.position.x!==ee.x||B.position.y!==ee.y,B.position=ee,B.internals.positionAbsolute=K}if(p=p||W,!!W&&(L(a,!0),y&&(o||z||!S&&$))){const[Z,B]=wn({nodeId:S,dragItems:a,nodeLookup:_});o?.(y,a,Z,B),z?.(y,Z,B),S||$?.(y,B)}}async function P(){if(!h)return;const{transform:T,panBy:R,autoPanSpeed:_,autoPanOnNodeDrag:N}=t();if(!N){l=!1,cancelAnimationFrame(s);return}const[E,M]=Ur(u,h,_);(E!==0||M!==0)&&(i.x=(i.x??0)-E/T[2],i.y=(i.y??0)-M/T[2],await R({x:E,y:M})&&A(i)),s=requestAnimationFrame(P)}function V(T){const{nodeLookup:R,multiSelectionActive:_,nodesDraggable:N,transform:E,snapGrid:M,snapToGrid:k,selectNodesOnDrag:z,onNodeDragStart:$,onSelectionDragStart:H,unselectNodesAndEdges:L}=t();d=!0,(!z||!j)&&!_&&S&&(R.get(S)?.selected||L()),j&&z&&S&&e?.(S);const W=dt(T.sourceEvent,{transform:E,snapGrid:M,snapToGrid:k,containerBounds:h});if(i=W,a=yd(R,N,W,S),a.size>0&&(n||$||!S&&H)){const[F,U]=wn({nodeId:S,dragItems:a,nodeLookup:R});n?.(T.sourceEvent,a,F,U),$?.(T.sourceEvent,F,U),S||H?.(T.sourceEvent,U)}}const I=Ar().clickDistance(C).on("start",T=>{const{domNode:R,nodeDragThreshold:_,transform:N,snapGrid:E,snapToGrid:M}=t();h=R?.getBoundingClientRect()||null,m=!1,p=!1,y=T.sourceEvent,_===0&&V(T),i=dt(T.sourceEvent,{transform:N,snapGrid:E,snapToGrid:M,containerBounds:h}),u=me(T.sourceEvent,h)}).on("drag",T=>{const{autoPanOnNodeDrag:R,transform:_,snapGrid:N,snapToGrid:E,nodeDragThreshold:M,nodeLookup:k}=t(),z=dt(T.sourceEvent,{transform:_,snapGrid:N,snapToGrid:E,containerBounds:h});if(y=T.sourceEvent,(T.sourceEvent.type==="touchmove"&&T.sourceEvent.touches.length>1||S&&!k.has(S))&&(m=!0),!m){if(!l&&R&&d&&(l=!0,P()),!d){const $=me(T.sourceEvent,h),H=$.x-u.x,L=$.y-u.y;Math.sqrt(H*H+L*L)>M&&V(T)}(i.x!==z.xSnapped||i.y!==z.ySnapped)&&a&&d&&(u=me(T.sourceEvent,h),A(z))}}).on("end",T=>{if(!(!d||m)&&(l=!1,d=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:R,updateNodePositions:_,onNodeDragStop:N,onSelectionDragStop:E}=t();if(p&&(_(a,!1),p=!1),r||N||!S&&E){const[M,k]=wn({nodeId:S,dragItems:a,nodeLookup:R,dragging:!1});r?.(T.sourceEvent,a,M,k),N?.(T.sourceEvent,M,k),S||E?.(T.sourceEvent,k)}}}).filter(T=>{const R=T.target;return!T.button&&(!b||!Ho(R,`.${b}`,v))&&(!g||Ho(R,g,v))});f.call(I)}function x(){f?.on(".drag",null)}return{update:w,destroy:x}}function _d(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())mt(r,qe(i))>0&&o.push(i);return o}const bd=250;function Sd(e,t,n,o){let r=[],i=1/0;const s=_d(e,n,t+bd);for(const a of s){const l=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(const u of l){if(o.nodeId===u.nodeId&&o.type===u.type&&o.id===u.id)continue;const{x:h,y:d}=Re(a,u,u.position,!0),f=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(d-e.y,2));f>t||(f<i?(r=[{...u,x:h,y:d}],i=f):f===i&&r.push({...u,x:h,y:d}))}}if(!r.length)return null;if(r.length>1){const a=o.type==="source"?"target":"source";return r.find(l=>l.type===a)??r[0]}return r[0]}function ds(e,t,n,o,r,i=!1){const s=o.get(e);if(!s)return null;const a=r==="strict"?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],l=(n?a?.find(u=>u.id===n):a?.[0])??null;return l&&i?{...l,...Re(s,l,l.position,!0)}:l}function fs(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Ed(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const hs=()=>!0;function jd(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:l,lib:u,autoPanOnConnect:h,flowId:d,panBy:f,cancelConnection:m,onConnectStart:p,onConnect:y,onConnectEnd:w,isValidConnection:x=hs,onReconnectEnd:b,updateConnection:g,getTransform:v,getFromHandle:j,autoPanSpeed:S,dragThreshold:C=1,handleDomNode:A}){const P=es(e.target);let V=0,I;const{x:T,y:R}=me(e),_=fs(i,A),N=a?.getBoundingClientRect();let E=!1;if(!N||!_)return;const M=ds(r,_,o,l,t);if(!M)return;let k=me(e,N),z=!1,$=null,H=!1,L=null;function W(){if(!h||!N)return;const[ee,K]=Ur(k,N,S);f({x:ee,y:K}),V=requestAnimationFrame(W)}const F={...M,nodeId:r,type:_,position:M.position},U=l.get(r);let Z={inProgress:!0,isValid:null,from:Re(U,F,X.Left,!0),fromHandle:F,fromPosition:F.position,fromNode:U,to:k,toHandle:null,toPosition:No[F.position],toNode:null,pointer:k};function B(){E=!0,g(Z),p?.(e,{nodeId:r,handleId:o,handleType:_})}C===0&&B();function Y(ee){if(!E){const{x:le,y:je}=me(ee),ve=le-T,ze=je-R;if(!(ve*ve+ze*ze>C*C))return;B()}if(!j()||!F){te(ee);return}const K=v();k=me(ee,N),I=Sd(St(k,K,!1,[1,1]),n,l,F),z||(W(),z=!0);const Q=ps(ee,{handle:I,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:s?"target":"source",isValidConnection:x,doc:P,lib:u,flowId:d,nodeLookup:l});L=Q.handleDomNode,$=Q.connection,H=Ed(!!I,Q.isValid);const oe=l.get(r),se=oe?Re(oe,F,X.Left,!0):Z.from,re={...Z,from:se,isValid:H,to:Q.toHandle&&H?Ut({x:Q.toHandle.x,y:Q.toHandle.y},K):k,toHandle:Q.toHandle,toPosition:H&&Q.toHandle?Q.toHandle.position:No[F.position],toNode:Q.toHandle?l.get(Q.toHandle.nodeId):null,pointer:k};g(re),Z=re}function te(ee){if(!("touches"in ee&&ee.touches.length>0)){if(E){(I||L)&&$&&H&&y?.($);const{inProgress:K,...Q}=Z,oe={...Q,toPosition:Z.toHandle?Z.toPosition:null};w?.(ee,oe),i&&b?.(ee,oe)}m(),cancelAnimationFrame(V),z=!1,H=!1,$=null,L=null,P.removeEventListener("mousemove",Y),P.removeEventListener("mouseup",te),P.removeEventListener("touchmove",Y),P.removeEventListener("touchend",te)}}P.addEventListener("mousemove",Y),P.addEventListener("mouseup",te),P.addEventListener("touchmove",Y),P.addEventListener("touchend",te)}function ps(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:i,doc:s,lib:a,flowId:l,isValidConnection:u=hs,nodeLookup:h}){const d=i==="target",f=t?s.querySelector(`.${a}-flow__handle[data-id="${l}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:m,y:p}=me(e),y=s.elementFromPoint(m,p),w=y?.classList.contains(`${a}-flow__handle`)?y:f,x={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){const b=fs(void 0,w),g=w.getAttribute("data-nodeid"),v=w.getAttribute("data-handleid"),j=w.classList.contains("connectable"),S=w.classList.contains("connectableend");if(!g||!b)return x;const C={source:d?g:o,sourceHandle:d?v:r,target:d?o:g,targetHandle:d?r:v};x.connection=C;const P=j&&S&&(n===Ze.Strict?d&&b==="source"||!d&&b==="target":g!==o||v!==r);x.isValid=P&&u(C),x.toHandle=ds(g,b,v,h,n,!0)}return x}const $n={onPointerDown:jd,isValid:ps};function Cd({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const r=fe(e);function i({translateExtent:a,width:l,height:u,zoomStep:h=1,pannable:d=!0,zoomable:f=!0,inversePan:m=!1}){const p=g=>{if(g.sourceEvent.type!=="wheel"||!t)return;const v=n(),j=g.sourceEvent.ctrlKey&&xt()?10:1,S=-g.sourceEvent.deltaY*(g.sourceEvent.deltaMode===1?.05:g.sourceEvent.deltaMode?1:.002)*h,C=v[2]*Math.pow(2,S*j);t.scaleTo(C)};let y=[0,0];const w=g=>{(g.sourceEvent.type==="mousedown"||g.sourceEvent.type==="touchstart")&&(y=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY])},x=g=>{const v=n();if(g.sourceEvent.type!=="mousemove"&&g.sourceEvent.type!=="touchmove"||!t)return;const j=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY],S=[j[0]-y[0],j[1]-y[1]];y=j;const C=o()*Math.max(v[2],Math.log(v[2]))*(m?-1:1),A={x:v[0]-S[0]*C,y:v[1]-S[1]*C},P=[[0,0],[l,u]];t.setViewportConstrained({x:A.x,y:A.y,zoom:v[2]},P,a)},b=Or().on("start",w).on("zoom",d?x:null).on("zoom.wheel",f?p:null);r.call(b,{})}function s(){r.on("zoom",null)}return{update:i,destroy:s,pointer:pe}}const sn=e=>({x:e.x,y:e.y,zoom:e.k}),vn=({x:e,y:t,zoom:n})=>nn.translate(e,t).scale(n),Be=(e,t)=>e.target.closest(`.${t}`),gs=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Nd=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,_n=(e,t=0,n=Nd,o=()=>{})=>{const r=typeof t=="number"&&t>0;return r||o(),r?e.transition().duration(t).ease(n).on("end",o):e},ms=e=>{const t=e.ctrlKey&&xt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function kd({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:u}){return h=>{if(Be(h,t))return h.ctrlKey&&h.preventDefault(),!1;h.preventDefault(),h.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(h.ctrlKey&&s){const w=pe(h),x=ms(h),b=d*Math.pow(2,x);o.scaleTo(n,b,w,h);return}const f=h.deltaMode===1?20:1;let m=r===De.Vertical?0:h.deltaX*f,p=r===De.Horizontal?0:h.deltaY*f;!xt()&&h.shiftKey&&r!==De.Vertical&&(m=h.deltaY*f,p=0),o.translateBy(n,-(m/d)*i,-(p/d)*i,{internal:!0});const y=sn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(l?.(h,y),e.panScrollTimeout=setTimeout(()=>{u?.(h,y),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,a?.(h,y))}}function Md({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){const i=o.type==="wheel",s=!t&&i&&!o.ctrlKey,a=Be(o,e);if(o.ctrlKey&&i&&a&&o.preventDefault(),s||a)return null;o.preventDefault(),n.call(this,o,r)}}function Id({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const r=sn(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,r)}}function zd({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return i=>{e.usedRightMouseButton=!!(n&&gs(t,e.mouseButton??0)),i.sourceEvent?.sync||o([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,sn(i.transform))}}function Pd({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&gs(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,o(!1),r)){const a=sn(s.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(s.sourceEvent,a)},n?150:0)}}}function Ad({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:l,lib:u,connectionInProgress:h}){return d=>{const f=e||t,m=n&&d.ctrlKey,p=d.type==="wheel";if(d.button===1&&d.type==="mousedown"&&(Be(d,`${u}-flow__node`)||Be(d,`${u}-flow__edge`)))return!0;if(!o&&!f&&!r&&!i&&!n||s||h&&!p||Be(d,a)&&p||Be(d,l)&&(!p||r&&p&&!e)||!n&&d.ctrlKey&&p)return!1;if(!n&&d.type==="touchstart"&&d.touches?.length>1)return d.preventDefault(),!1;if(!f&&!r&&!m&&p||!o&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(o)&&!o.includes(d.button)&&d.type==="mousedown")return!1;const y=Array.isArray(o)&&o.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||p)&&y}}function Dd({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:r,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:a,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),d=Or().scaleExtent([t,n]).translateExtent(o),f=fe(e).call(d);b({x:r.x,y:r.y,zoom:Ge(r.zoom,t,n)},[[0,0],[h.width,h.height]],o);const m=f.on("wheel.zoom"),p=f.on("dblclick.zoom");d.wheelDelta(ms);function y(I,T){return f?new Promise(R=>{d?.interpolate(T?.interpolate==="linear"?mn:Lt).transform(_n(f,T?.duration,T?.ease,()=>R(!0)),I)}):Promise.resolve(!1)}function w({noWheelClassName:I,noPanClassName:T,onPaneContextMenu:R,userSelectionActive:_,panOnScroll:N,panOnDrag:E,panOnScrollMode:M,panOnScrollSpeed:k,preventScrolling:z,zoomOnPinch:$,zoomOnScroll:H,zoomOnDoubleClick:L,zoomActivationKeyPressed:W,lib:F,onTransformChange:U,connectionInProgress:J,paneClickDistance:Z,selectionOnDrag:B}){_&&!u.isZoomingOrPanning&&x();const Y=N&&!W&&!_;d.clickDistance(B?1/0:!ge(Z)||Z<0?0:Z);const te=Y?kd({zoomPanValues:u,noWheelClassName:I,d3Selection:f,d3Zoom:d,panOnScrollMode:M,panOnScrollSpeed:k,zoomOnPinch:$,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:a}):Md({noWheelClassName:I,preventScrolling:z,d3ZoomHandler:m});if(f.on("wheel.zoom",te,{passive:!1}),!_){const K=Id({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});d.on("start",K);const Q=zd({zoomPanValues:u,panOnDrag:E,onPaneContextMenu:!!R,onPanZoom:i,onTransformChange:U});d.on("zoom",Q);const oe=Pd({zoomPanValues:u,panOnDrag:E,panOnScroll:N,onPaneContextMenu:R,onPanZoomEnd:a,onDraggingChange:l});d.on("end",oe)}const ee=Ad({zoomActivationKeyPressed:W,panOnDrag:E,zoomOnScroll:H,panOnScroll:N,zoomOnDoubleClick:L,zoomOnPinch:$,userSelectionActive:_,noPanClassName:T,noWheelClassName:I,lib:F,connectionInProgress:J});d.filter(ee),L?f.on("dblclick.zoom",p):f.on("dblclick.zoom",null)}function x(){d.on("zoom",null)}async function b(I,T,R){const _=vn(I),N=d?.constrain()(_,T,R);return N&&await y(N),new Promise(E=>E(N))}async function g(I,T){const R=vn(I);return await y(R,T),new Promise(_=>_(R))}function v(I){if(f){const T=vn(I),R=f.property("__zoom");(R.k!==I.zoom||R.x!==I.x||R.y!==I.y)&&d?.transform(f,T,null,{sync:!0})}}function j(){const I=f?Br(f.node()):{x:0,y:0,k:1};return{x:I.x,y:I.y,zoom:I.k}}function S(I,T){return f?new Promise(R=>{d?.interpolate(T?.interpolate==="linear"?mn:Lt).scaleTo(_n(f,T?.duration,T?.ease,()=>R(!0)),I)}):Promise.resolve(!1)}function C(I,T){return f?new Promise(R=>{d?.interpolate(T?.interpolate==="linear"?mn:Lt).scaleBy(_n(f,T?.duration,T?.ease,()=>R(!0)),I)}):Promise.resolve(!1)}function A(I){d?.scaleExtent(I)}function P(I){d?.translateExtent(I)}function V(I){const T=!ge(I)||I<0?0:I;d?.clickDistance(T)}return{update:w,destroy:x,setViewport:g,setViewportConstrained:b,getViewport:j,scaleTo:S,scaleBy:C,setScaleExtent:A,setTranslateExtent:P,syncViewport:v,setClickDistance:V}}var Ke;(function(e){e.Line="line",e.Handle="handle"})(Ke||(Ke={}));function Td({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:i}){const s=e-t,a=n-o,l=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&r&&(l[0]=l[0]*-1),a&&i&&(l[1]=l[1]*-1),l}function Vo(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:r}}function Ne(e,t){return Math.max(0,t-e)}function ke(e,t){return Math.max(0,e-t)}function Dt(e,t,n){return Math.max(0,t-e,e-n)}function Bo(e,t){return e?!t:t}function $d(e,t,n,o,r,i,s,a){let{affectsX:l,affectsY:u}=t;const{isHorizontal:h,isVertical:d}=t,f=h&&d,{xSnapped:m,ySnapped:p}=n,{minWidth:y,maxWidth:w,minHeight:x,maxHeight:b}=o,{x:g,y:v,width:j,height:S,aspectRatio:C}=e;let A=Math.floor(h?m-e.pointerX:0),P=Math.floor(d?p-e.pointerY:0);const V=j+(l?-A:A),I=S+(u?-P:P),T=-i[0]*j,R=-i[1]*S;let _=Dt(V,y,w),N=Dt(I,x,b);if(s){let k=0,z=0;l&&A<0?k=Ne(g+A+T,s[0][0]):!l&&A>0&&(k=ke(g+V+T,s[1][0])),u&&P<0?z=Ne(v+P+R,s[0][1]):!u&&P>0&&(z=ke(v+I+R,s[1][1])),_=Math.max(_,k),N=Math.max(N,z)}if(a){let k=0,z=0;l&&A>0?k=ke(g+A,a[0][0]):!l&&A<0&&(k=Ne(g+V,a[1][0])),u&&P>0?z=ke(v+P,a[0][1]):!u&&P<0&&(z=Ne(v+I,a[1][1])),_=Math.max(_,k),N=Math.max(N,z)}if(r){if(h){const k=Dt(V/C,x,b)*C;if(_=Math.max(_,k),s){let z=0;!l&&!u||l&&!u&&f?z=ke(v+R+V/C,s[1][1])*C:z=Ne(v+R+(l?A:-A)/C,s[0][1])*C,_=Math.max(_,z)}if(a){let z=0;!l&&!u||l&&!u&&f?z=Ne(v+V/C,a[1][1])*C:z=ke(v+(l?A:-A)/C,a[0][1])*C,_=Math.max(_,z)}}if(d){const k=Dt(I*C,y,w)/C;if(N=Math.max(N,k),s){let z=0;!l&&!u||u&&!l&&f?z=ke(g+I*C+T,s[1][0])/C:z=Ne(g+(u?P:-P)*C+T,s[0][0])/C,N=Math.max(N,z)}if(a){let z=0;!l&&!u||u&&!l&&f?z=Ne(g+I*C,a[1][0])/C:z=ke(g+(u?P:-P)*C,a[0][0])/C,N=Math.max(N,z)}}}P=P+(P<0?N:-N),A=A+(A<0?_:-_),r&&(f?V>I*C?P=(Bo(l,u)?-A:A)/C:A=(Bo(l,u)?-P:P)*C:h?(P=A/C,u=l):(A=P*C,l=u));const E=l?g+A:g,M=u?v+P:v;return{width:j+(l?-A:A),height:S+(u?-P:P),x:i[0]*A*(l?-1:1)+E,y:i[1]*P*(u?-1:1)+M}}const xs={width:0,height:0,x:0,y:0},Rd={...xs,pointerX:0,pointerY:0,aspectRatio:1};function Ld(e){return[[0,0],[e.measured.width,e.measured.height]]}function Hd(e,t,n){const o=t.position.x+e.position.x,r=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,l=n[1]*s;return[[o-a,r-l],[o+i-a,r+s-l]]}function Vd({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){const i=fe(e);let s={controlDirection:Vo("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function a({controlPosition:u,boundaries:h,keepAspectRatio:d,resizeDirection:f,onResizeStart:m,onResize:p,onResizeEnd:y,shouldResize:w}){let x={...xs},b={...Rd};s={boundaries:h,resizeDirection:f,keepAspectRatio:d,controlDirection:Vo(u)};let g,v=null,j=[],S,C,A,P=!1;const V=Ar().on("start",I=>{const{nodeLookup:T,transform:R,snapGrid:_,snapToGrid:N,nodeOrigin:E,paneDomNode:M}=n();if(g=T.get(t),!g)return;v=M?.getBoundingClientRect()??null;const{xSnapped:k,ySnapped:z}=dt(I.sourceEvent,{transform:R,snapGrid:_,snapToGrid:N,containerBounds:v});x={width:g.measured.width??0,height:g.measured.height??0,x:g.position.x??0,y:g.position.y??0},b={...x,pointerX:k,pointerY:z,aspectRatio:x.width/x.height},S=void 0,g.parentId&&(g.extent==="parent"||g.expandParent)&&(S=T.get(g.parentId),C=S&&g.extent==="parent"?Ld(S):void 0),j=[],A=void 0;for(const[$,H]of T)if(H.parentId===t&&(j.push({id:$,position:{...H.position},extent:H.extent}),H.extent==="parent"||H.expandParent)){const L=Hd(H,g,H.origin??E);A?A=[[Math.min(L[0][0],A[0][0]),Math.min(L[0][1],A[0][1])],[Math.max(L[1][0],A[1][0]),Math.max(L[1][1],A[1][1])]]:A=L}m?.(I,{...x})}).on("drag",I=>{const{transform:T,snapGrid:R,snapToGrid:_,nodeOrigin:N}=n(),E=dt(I.sourceEvent,{transform:T,snapGrid:R,snapToGrid:_,containerBounds:v}),M=[];if(!g)return;const{x:k,y:z,width:$,height:H}=x,L={},W=g.origin??N,{width:F,height:U,x:J,y:Z}=$d(b,s.controlDirection,E,s.boundaries,s.keepAspectRatio,W,C,A),B=F!==$,Y=U!==H,te=J!==k&&B,ee=Z!==z&&Y;if(!te&&!ee&&!B&&!Y)return;if((te||ee||W[0]===1||W[1]===1)&&(L.x=te?J:x.x,L.y=ee?Z:x.y,x.x=L.x,x.y=L.y,j.length>0)){const se=J-k,re=Z-z;for(const le of j)le.position={x:le.position.x-se+W[0]*(F-$),y:le.position.y-re+W[1]*(U-H)},M.push(le)}if((B||Y)&&(L.width=B&&(!s.resizeDirection||s.resizeDirection==="horizontal")?F:x.width,L.height=Y&&(!s.resizeDirection||s.resizeDirection==="vertical")?U:x.height,x.width=L.width,x.height=L.height),S&&g.expandParent){const se=W[0]*(L.width??0);L.x&&L.x<se&&(x.x=se,b.x=b.x-(L.x-se));const re=W[1]*(L.height??0);L.y&&L.y<re&&(x.y=re,b.y=b.y-(L.y-re))}const K=Td({width:x.width,prevWidth:$,height:x.height,prevHeight:H,affectsX:s.controlDirection.affectsX,affectsY:s.controlDirection.affectsY}),Q={...x,direction:K};w?.(I,Q)!==!1&&(P=!0,p?.(I,Q),o(L,M))}).on("end",I=>{P&&(y?.(I,{...x}),r?.({...x}),P=!1)});i.call(V)}function l(){i.on(".drag",null)}return{update:a,destroy:l}}const Bd={},Oo=e=>{let t;const n=new Set,o=(h,d)=>{const f=typeof h=="function"?h(t):h;if(!Object.is(f,t)){const m=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,m))}},r=()=>t,l={setState:o,getState:r,getInitialState:()=>u,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(Bd?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(o,r,l);return l},Od=e=>e?Oo(e):Oo,{useDebugValue:Fd}=Hn,{useSyncExternalStoreWithSelector:Wd}=xa,Xd=e=>e;function ys(e,t=Xd,n){const o=Wd(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Fd(o),o}const Fo=(e,t)=>{const n=Od(e),o=(r,i=t)=>ys(n,r,i);return Object.assign(o,n),o},Yd=(e,t)=>e?Fo(e,t):Fo;function ie(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const an=D.createContext(null),Zd=an.Provider,ws=ye.error001();function ne(e,t){const n=D.useContext(an);if(n===null)throw new Error(ws);return ys(n,e,t)}function ae(){const e=D.useContext(an);if(e===null)throw new Error(ws);return D.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Wo={display:"none"},Gd={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},vs="react-flow__node-desc",_s="react-flow__edge-desc",qd="react-flow__aria-live",Ud=e=>e.ariaLiveMessage,Kd=e=>e.ariaLabelConfig;function Qd({rfId:e}){const t=ne(Ud);return c.jsx("div",{id:`${qd}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Gd,children:t})}function Jd({rfId:e,disableKeyboardA11y:t}){const n=ne(Kd);return c.jsxs(c.Fragment,{children:[c.jsx("div",{id:`${vs}-${e}`,style:Wo,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),c.jsx("div",{id:`${_s}-${e}`,style:Wo,children:n["edge.a11yDescription.default"]}),!t&&c.jsx(Qd,{rfId:e})]})}const cn=D.forwardRef(({position:e="top-left",children:t,className:n,style:o,...r},i)=>{const s=`${e}`.split("-");return c.jsx("div",{className:ce(["react-flow__panel",n,...s]),style:o,ref:i,...r,children:t})});cn.displayName="Panel";function ef({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:c.jsx(cn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:c.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const tf=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},Tt=e=>e.id;function nf(e,t){return ie(e.selectedNodes.map(Tt),t.selectedNodes.map(Tt))&&ie(e.selectedEdges.map(Tt),t.selectedEdges.map(Tt))}function of({onSelectionChange:e}){const t=ae(),{selectedNodes:n,selectedEdges:o}=ne(tf,nf);return D.useEffect(()=>{const r={nodes:n,edges:o};e?.(r),t.getState().onSelectionChangeHandlers.forEach(i=>i(r))},[n,o,e]),null}const rf=e=>!!e.onSelectionChangeHandlers;function sf({onSelectionChange:e}){const t=ne(rf);return e||t?c.jsx(of,{onSelectionChange:e}):null}const bs=[0,0],af={x:0,y:0,zoom:1},cf=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Xo=[...cf,"rfId"],lf=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Yo={translateExtent:pt,nodeOrigin:bs,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function uf(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:l}=ne(lf,ie),u=ae();D.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{h.current=Yo,a()}),[]);const h=D.useRef(Yo);return D.useEffect(()=>{for(const d of Xo){const f=e[d],m=h.current[d];f!==m&&(typeof e[d]>"u"||(d==="nodes"?t(f):d==="edges"?n(f):d==="minZoom"?o(f):d==="maxZoom"?r(f):d==="translateExtent"?i(f):d==="nodeExtent"?s(f):d==="ariaLabelConfig"?u.setState({ariaLabelConfig:Qu(f)}):d==="fitView"?u.setState({fitViewQueued:f}):d==="fitViewOptions"?u.setState({fitViewOptions:f}):u.setState({[d]:f})))}h.current=e},Xo.map(d=>e[d])),null}function Zo(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function df(e){const[t,n]=D.useState(e==="system"?null:e);return D.useEffect(()=>{if(e!=="system"){n(e);return}const o=Zo(),r=()=>n(o?.matches?"dark":"light");return r(),o?.addEventListener("change",r),()=>{o?.removeEventListener("change",r)}},[e]),t!==null?t:Zo()?.matches?"dark":"light"}const Go=typeof document<"u"?document:null;function yt(e=null,t={target:Go,actInsideInputWithModifier:!0}){const[n,o]=D.useState(!1),r=D.useRef(!1),i=D.useRef(new Set([])),[s,a]=D.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),h=u.reduce((d,f)=>d.concat(...f),[]);return[u,h]}return[[],[]]},[e]);return D.useEffect(()=>{const l=t?.target??Go,u=t?.actInsideInputWithModifier??!0;if(e!==null){const h=m=>{if(r.current=m.ctrlKey||m.metaKey||m.shiftKey||m.altKey,(!r.current||r.current&&!u)&&ts(m))return!1;const y=Uo(m.code,a);if(i.current.add(m[y]),qo(s,i.current,!1)){const w=m.composedPath?.()?.[0]||m.target,x=w?.nodeName==="BUTTON"||w?.nodeName==="A";t.preventDefault!==!1&&(r.current||!x)&&m.preventDefault(),o(!0)}},d=m=>{const p=Uo(m.code,a);qo(s,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(m[p]),m.key==="Meta"&&i.current.clear(),r.current=!1},f=()=>{i.current.clear(),o(!1)};return l?.addEventListener("keydown",h),l?.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{l?.removeEventListener("keydown",h),l?.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,o]),n}function qo(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function Uo(e,t){return t.includes(e)?"code":"key"}const ff=()=>{const e=ae();return D.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,r,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:r,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),l=Zn(t,o,r,i,s,n?.padding??.1);return a?(await a.setViewport(l,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:r,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;const{x:a,y:l}=s.getBoundingClientRect(),u={x:t.x-a,y:t.y-l},h=n.snapGrid??r,d=n.snapToGrid??i;return St(u,o,d,h)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:r,y:i}=o.getBoundingClientRect(),s=Ut(t,n);return{x:s.x+r,y:s.y+i}}}),[])};function Ss(e,t){const n=[],o=new Map,r=[];for(const i of e)if(i.type==="add"){r.push(i);continue}else if(i.type==="remove"||i.type==="replace")o.set(i.id,[i]);else{const s=o.get(i.id);s?s.push(i):o.set(i.id,[i])}for(const i of t){const s=o.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}const a={...i};for(const l of s)hf(l,a);n.push(a)}return r.length&&r.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function hf(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function pf(e,t){return Ss(e,t)}function gf(e,t){return Ss(e,t)}function Ae(e,t){return{id:e,type:"select",selected:t}}function Oe(e,t=new Set,n=!1){const o=[];for(const[r,i]of e){const s=t.has(r);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),o.push(Ae(i.id,s)))}return o}function Ko({items:e=[],lookup:t}){const n=[],o=new Map(e.map(r=>[r.id,r]));for(const[r,i]of e.entries()){const s=t.get(i.id),a=s?.internals?.userNode??s;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:"replace"}),a===void 0&&n.push({item:i,type:"add",index:r})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function Qo(e){return{id:e.id,type:"remove"}}const Jo=e=>Ou(e),mf=e=>Zr(e);function Es(e){return D.forwardRef(e)}const xf=typeof window<"u"?D.useLayoutEffect:D.useEffect;function er(e){const[t,n]=D.useState(BigInt(0)),[o]=D.useState(()=>yf(()=>n(r=>r+BigInt(1))));return xf(()=>{const r=o.get();r.length&&(e(r),o.reset())},[t]),o}function yf(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const js=D.createContext(null);function wf({children:e}){const t=ae(),n=D.useCallback(a=>{const{nodes:l=[],setNodes:u,hasDefaultNodes:h,onNodesChange:d,nodeLookup:f,fitViewQueued:m,onNodesChangeMiddlewareMap:p}=t.getState();let y=l;for(const x of a)y=typeof x=="function"?x(y):x;let w=Ko({items:y,lookup:f});for(const x of p.values())w=x(w);h&&u(y),w.length>0?d?.(w):m&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:b,setNodes:g}=t.getState();x&&g(b)})},[]),o=er(n),r=D.useCallback(a=>{const{edges:l=[],setEdges:u,hasDefaultEdges:h,onEdgesChange:d,edgeLookup:f}=t.getState();let m=l;for(const p of a)m=typeof p=="function"?p(m):p;h?u(m):d&&d(Ko({items:m,lookup:f}))},[]),i=er(r),s=D.useMemo(()=>({nodeQueue:o,edgeQueue:i}),[]);return c.jsx(js.Provider,{value:s,children:e})}function vf(){const e=D.useContext(js);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const _f=e=>!!e.panZoom;function eo(){const e=ff(),t=ae(),n=vf(),o=ne(_f),r=D.useMemo(()=>{const i=d=>t.getState().nodeLookup.get(d),s=d=>{n.nodeQueue.push(d)},a=d=>{n.edgeQueue.push(d)},l=d=>{const{nodeLookup:f,nodeOrigin:m}=t.getState(),p=Jo(d)?d:f.get(d.id),y=p.parentId?Jr(p.position,p.measured,p.parentId,f,m):p.position,w={...p,position:y,width:p.measured?.width??p.width,height:p.measured?.height??p.height};return qe(w)},u=(d,f,m={replace:!1})=>{s(p=>p.map(y=>{if(y.id===d){const w=typeof f=="function"?f(y):f;return m.replace&&Jo(w)?w:{...y,...w}}return y}))},h=(d,f,m={replace:!1})=>{a(p=>p.map(y=>{if(y.id===d){const w=typeof f=="function"?f(y):f;return m.replace&&mf(w)?w:{...y,...w}}return y}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>i(d)?.internals.userNode,getInternalNode:i,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:s,setEdges:a,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(m=>[...m,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(m=>[...m,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:m}=t.getState(),[p,y,w]=m;return{nodes:d.map(x=>({...x})),edges:f.map(x=>({...x})),viewport:{x:p,y,zoom:w}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:m,edges:p,onNodesDelete:y,onEdgesDelete:w,triggerNodeChanges:x,triggerEdgeChanges:b,onDelete:g,onBeforeDelete:v}=t.getState(),{nodes:j,edges:S}=await Zu({nodesToRemove:d,edgesToRemove:f,nodes:m,edges:p,onBeforeDelete:v}),C=S.length>0,A=j.length>0;if(C){const P=S.map(Qo);w?.(S),b(P)}if(A){const P=j.map(Qo);y?.(j),x(P)}return(A||C)&&g?.({nodes:j,edges:S}),{deletedNodes:j,deletedEdges:S}},getIntersectingNodes:(d,f=!0,m)=>{const p=Mo(d),y=p?d:l(d),w=m!==void 0;return y?(m||t.getState().nodes).filter(x=>{const b=t.getState().nodeLookup.get(x.id);if(b&&!p&&(x.id===d.id||!b.internals.positionAbsolute))return!1;const g=qe(w?x:b),v=mt(g,y);return f&&v>0||v>=g.width*g.height||v>=y.width*y.height}):[]},isNodeIntersecting:(d,f,m=!0)=>{const y=Mo(d)?d:l(d);if(!y)return!1;const w=mt(y,f);return m&&w>0||w>=f.width*f.height||w>=y.width*y.height},updateNode:u,updateNodeData:(d,f,m={replace:!1})=>{u(d,p=>{const y=typeof f=="function"?f(p):f;return m.replace?{...p,data:y}:{...p,data:{...p.data,...y}}},m)},updateEdge:h,updateEdgeData:(d,f,m={replace:!1})=>{h(d,p=>{const y=typeof f=="function"?f(p):f;return m.replace?{...p,data:y}:{...p,data:{...p.data,...y}}},m)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:m}=t.getState();return Fu(d,{nodeLookup:f,nodeOrigin:m})},getHandleConnections:({type:d,id:f,nodeId:m})=>Array.from(t.getState().connectionLookup.get(`${m}-${d}${f?`-${f}`:""}`)?.values()??[]),getNodeConnections:({type:d,handleId:f,nodeId:m})=>Array.from(t.getState().connectionLookup.get(`${m}${d?f?`-${d}-${f}`:`-${d}`:""}`)?.values()??[]),fitView:async d=>{const f=t.getState().fitViewResolver??Ku();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:f}),n.nodeQueue.push(m=>[...m]),f.promise}}},[]);return D.useMemo(()=>({...r,...e,viewportInitialized:o}),[o])}const tr=e=>e.selected,bf=typeof window<"u"?window:void 0;function Sf({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ae(),{deleteElements:o}=eo(),r=yt(e,{actInsideInputWithModifier:!1}),i=yt(t,{target:bf});D.useEffect(()=>{if(r){const{edges:s,nodes:a}=n.getState();o({nodes:a.filter(tr),edges:s.filter(tr)}),n.setState({nodesSelectionActive:!1})}},[r]),D.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function Ef(e){const t=ae();D.useEffect(()=>{const n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const o=Gn(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",ye.error004()),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const ln={position:"absolute",width:"100%",height:"100%",top:0,left:0},jf=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Cf({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:i=De.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:u,minZoom:h,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:m=!0,children:p,noWheelClassName:y,noPanClassName:w,onViewportChange:x,isControlledViewport:b,paneClickDistance:g,selectionOnDrag:v}){const j=ae(),S=D.useRef(null),{userSelectionActive:C,lib:A,connectionInProgress:P}=ne(jf,ie),V=yt(f),I=D.useRef();Ef(S);const T=D.useCallback(R=>{x?.({x:R[0],y:R[1],zoom:R[2]}),b||j.setState({transform:R})},[x,b]);return D.useEffect(()=>{if(S.current){I.current=Dd({domNode:S.current,minZoom:h,maxZoom:d,translateExtent:u,viewport:l,onDraggingChange:E=>j.setState({paneDragging:E}),onPanZoomStart:(E,M)=>{const{onViewportChangeStart:k,onMoveStart:z}=j.getState();z?.(E,M),k?.(M)},onPanZoom:(E,M)=>{const{onViewportChange:k,onMove:z}=j.getState();z?.(E,M),k?.(M)},onPanZoomEnd:(E,M)=>{const{onViewportChangeEnd:k,onMoveEnd:z}=j.getState();z?.(E,M),k?.(M)}});const{x:R,y:_,zoom:N}=I.current.getViewport();return j.setState({panZoom:I.current,transform:[R,_,N],domNode:S.current.closest(".react-flow")}),()=>{I.current?.destroy()}}},[]),D.useEffect(()=>{I.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:V,preventScrolling:m,noPanClassName:w,userSelectionActive:C,noWheelClassName:y,lib:A,onTransformChange:T,connectionInProgress:P,selectionOnDrag:v,paneClickDistance:g})},[e,t,n,o,r,i,s,a,V,m,w,C,y,A,T,P,v,g]),c.jsx("div",{className:"react-flow__renderer",ref:S,style:ln,children:p})}const Nf=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function kf(){const{userSelectionActive:e,userSelectionRect:t}=ne(Nf,ie);return e&&t?c.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const bn=(e,t)=>n=>{n.target===t.current&&e?.(n)},Mf=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function If({isSelecting:e,selectionKeyPressed:t,selectionMode:n=gt.Full,panOnDrag:o,paneClickDistance:r,selectionOnDrag:i,onSelectionStart:s,onSelectionEnd:a,onPaneClick:l,onPaneContextMenu:u,onPaneScroll:h,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:m,children:p}){const y=ae(),{userSelectionActive:w,elementsSelectable:x,dragging:b,connectionInProgress:g}=ne(Mf,ie),v=x&&(e||w),j=D.useRef(null),S=D.useRef(),C=D.useRef(new Set),A=D.useRef(new Set),P=D.useRef(!1),V=k=>{if(P.current||g){P.current=!1;return}l?.(k),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},I=k=>{if(Array.isArray(o)&&o?.includes(2)){k.preventDefault();return}u?.(k)},T=h?k=>h(k):void 0,R=k=>{P.current&&(k.stopPropagation(),P.current=!1)},_=k=>{const{domNode:z}=y.getState();if(S.current=z?.getBoundingClientRect(),!S.current)return;const $=k.target===j.current;if(!$&&!!k.target.closest(".nokey")||!e||!(i&&$||t)||k.button!==0||!k.isPrimary)return;k.target?.setPointerCapture?.(k.pointerId),P.current=!1;const{x:W,y:F}=me(k.nativeEvent,S.current);y.setState({userSelectionRect:{width:0,height:0,startX:W,startY:F,x:W,y:F}}),$||(k.stopPropagation(),k.preventDefault())},N=k=>{const{userSelectionRect:z,transform:$,nodeLookup:H,edgeLookup:L,connectionLookup:W,triggerNodeChanges:F,triggerEdgeChanges:U,defaultEdgeOptions:J,resetSelectedElements:Z}=y.getState();if(!S.current||!z)return;const{x:B,y:Y}=me(k.nativeEvent,S.current),{startX:te,startY:ee}=z;if(!P.current){const re=t?0:r;if(Math.hypot(B-te,Y-ee)<=re)return;Z(),s?.(k)}P.current=!0;const K={startX:te,startY:ee,x:B<te?B:te,y:Y<ee?Y:ee,width:Math.abs(B-te),height:Math.abs(Y-ee)},Q=C.current,oe=A.current;C.current=new Set(Yn(H,K,$,n===gt.Partial,!0).map(re=>re.id)),A.current=new Set;const se=J?.selectable??!0;for(const re of C.current){const le=W.get(re);if(le)for(const{edgeId:je}of le.values()){const ve=L.get(je);ve&&(ve.selectable??se)&&A.current.add(je)}}if(!Io(Q,C.current)){const re=Oe(H,C.current,!0);F(re)}if(!Io(oe,A.current)){const re=Oe(L,A.current);U(re)}y.setState({userSelectionRect:K,userSelectionActive:!0,nodesSelectionActive:!1})},E=k=>{k.button===0&&(k.target?.releasePointerCapture?.(k.pointerId),!w&&k.target===j.current&&y.getState().userSelectionRect&&V?.(k),y.setState({userSelectionActive:!1,userSelectionRect:null}),P.current&&(a?.(k),y.setState({nodesSelectionActive:C.current.size>0})))},M=o===!0||Array.isArray(o)&&o.includes(0);return c.jsxs("div",{className:ce(["react-flow__pane",{draggable:M,dragging:b,selection:e}]),onClick:v?void 0:bn(V,j),onContextMenu:bn(I,j),onWheel:bn(T,j),onPointerEnter:v?void 0:d,onPointerMove:v?N:f,onPointerUp:v?E:void 0,onPointerDownCapture:v?_:void 0,onClickCapture:v?R:void 0,onPointerLeave:m,ref:j,style:ln,children:[p,c.jsx(kf,{})]})}function Rn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:l}=t.getState(),u=a.get(e);if(!u){l?.("012",ye.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&s)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([e])}function Cs({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:i,nodeClickDistance:s}){const a=ae(),[l,u]=D.useState(!1),h=D.useRef();return D.useEffect(()=>{h.current=vd({getStoreItems:()=>a.getState(),onNodeMouseDown:d=>{Rn({id:d,store:a,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),D.useEffect(()=>{if(t)h.current?.destroy();else if(e.current)return h.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:i,nodeId:r,nodeClickDistance:s}),()=>{h.current?.destroy()}},[n,o,t,i,e,r]),l}const zf=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Ns(){const e=ae();return D.useCallback(n=>{const{nodeExtent:o,snapToGrid:r,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:l,nodeLookup:u,nodeOrigin:h}=e.getState(),d=new Map,f=zf(s),m=r?i[0]:5,p=r?i[1]:5,y=n.direction.x*m*n.factor,w=n.direction.y*p*n.factor;for(const[,x]of u){if(!f(x))continue;let b={x:x.internals.positionAbsolute.x+y,y:x.internals.positionAbsolute.y+w};r&&(b=bt(b,i));const{position:g,positionAbsolute:v}=Gr({nodeId:x.id,nextPosition:b,nodeLookup:u,nodeExtent:o,nodeOrigin:h,onError:a});x.position=g,x.internals.positionAbsolute=v,d.set(x.id,x)}l(d)},[])}const to=D.createContext(null),Pf=to.Provider;to.Consumer;const ks=()=>D.useContext(to),Af=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Df=(e,t,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:i,connection:s}=o,{fromHandle:a,toHandle:l,isValid:u}=s,h=l?.nodeId===e&&l?.id===t&&l?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:h,clickConnecting:r?.nodeId===e&&r?.id===t&&r?.type===n,isPossibleEndHandle:i===Ze.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:h&&u}};function Tf({type:e="source",position:t=X.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:l,className:u,onMouseDown:h,onTouchStart:d,...f},m){const p=s||null,y=e==="target",w=ae(),x=ks(),{connectOnClick:b,noPanClassName:g,rfId:v}=ne(Af,ie),{connectingFrom:j,connectingTo:S,clickConnecting:C,isPossibleEndHandle:A,connectionInProcess:P,clickConnectionInProcess:V,valid:I}=ne(Df(x,p,e),ie);x||w.getState().onError?.("010",ye.error010());const T=N=>{const{defaultEdgeOptions:E,onConnect:M,hasDefaultEdges:k}=w.getState(),z={...E,...N};if(k){const{edges:$,setEdges:H}=w.getState();H(rd(z,$))}M?.(z),a?.(z)},R=N=>{if(!x)return;const E=ns(N.nativeEvent);if(r&&(E&&N.button===0||!E)){const M=w.getState();$n.onPointerDown(N.nativeEvent,{handleDomNode:N.currentTarget,autoPanOnConnect:M.autoPanOnConnect,connectionMode:M.connectionMode,connectionRadius:M.connectionRadius,domNode:M.domNode,nodeLookup:M.nodeLookup,lib:M.lib,isTarget:y,handleId:p,nodeId:x,flowId:M.rfId,panBy:M.panBy,cancelConnection:M.cancelConnection,onConnectStart:M.onConnectStart,onConnectEnd:M.onConnectEnd,updateConnection:M.updateConnection,onConnect:T,isValidConnection:n||M.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:M.autoPanSpeed,dragThreshold:M.connectionDragThreshold})}E?h?.(N):d?.(N)},_=N=>{const{onClickConnectStart:E,onClickConnectEnd:M,connectionClickStartHandle:k,connectionMode:z,isValidConnection:$,lib:H,rfId:L,nodeLookup:W,connection:F}=w.getState();if(!x||!k&&!r)return;if(!k){E?.(N.nativeEvent,{nodeId:x,handleId:p,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:x,type:e,id:p}});return}const U=es(N.target),J=n||$,{connection:Z,isValid:B}=$n.isValid(N.nativeEvent,{handle:{nodeId:x,id:p,type:e},connectionMode:z,fromNodeId:k.nodeId,fromHandleId:k.id||null,fromType:k.type,isValidConnection:J,flowId:L,doc:U,lib:H,nodeLookup:W});B&&Z&&T(Z);const Y=structuredClone(F);delete Y.inProgress,Y.toPosition=Y.toHandle?Y.toHandle.position:null,M?.(N,Y),w.setState({connectionClickStartHandle:null})};return c.jsx("div",{"data-handleid":p,"data-nodeid":x,"data-handlepos":t,"data-id":`${v}-${x}-${p}-${e}`,className:ce(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",g,u,{source:!y,target:y,connectable:o,connectablestart:r,connectableend:i,clickconnecting:C,connectingfrom:j,connectingto:S,valid:I,connectionindicator:o&&(!P||A)&&(P||V?i:r)}]),onMouseDown:R,onTouchStart:R,onClick:b?_:void 0,ref:m,...f,children:l})}const Qe=D.memo(Es(Tf));function $f({data:e,isConnectable:t,sourcePosition:n=X.Bottom}){return c.jsxs(c.Fragment,{children:[e?.label,c.jsx(Qe,{type:"source",position:n,isConnectable:t})]})}function Rf({data:e,isConnectable:t,targetPosition:n=X.Top,sourcePosition:o=X.Bottom}){return c.jsxs(c.Fragment,{children:[c.jsx(Qe,{type:"target",position:n,isConnectable:t}),e?.label,c.jsx(Qe,{type:"source",position:o,isConnectable:t})]})}function Lf(){return null}function Hf({data:e,isConnectable:t,targetPosition:n=X.Top}){return c.jsxs(c.Fragment,{children:[c.jsx(Qe,{type:"target",position:n,isConnectable:t}),e?.label]})}const Kt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},nr={input:$f,default:Rf,output:Hf,group:Lf};function Vf(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const Bf=e=>{const{width:t,height:n,x:o,y:r}=_t(e.nodeLookup,{filter:i=>!!i.selected});return{width:ge(t)?t:null,height:ge(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function Of({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ae(),{width:r,height:i,transformString:s,userSelectionActive:a}=ne(Bf,ie),l=Ns(),u=D.useRef(null);if(D.useEffect(()=>{n||u.current?.focus({preventScroll:!0})},[n]),Cs({nodeRef:u}),a||!r||!i)return null;const h=e?f=>{const m=o.getState().nodes.filter(p=>p.selected);e(f,m)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(Kt,f.key)&&(f.preventDefault(),l({direction:Kt[f.key],factor:f.shiftKey?4:1}))};return c.jsx("div",{className:ce(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:c.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:r,height:i}})})}const or=typeof window<"u"?window:void 0,Ff=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Ms({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:u,selectionOnDrag:h,selectionMode:d,onSelectionStart:f,onSelectionEnd:m,multiSelectionKeyCode:p,panActivationKeyCode:y,zoomActivationKeyCode:w,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:g,panOnScroll:v,panOnScrollSpeed:j,panOnScrollMode:S,zoomOnDoubleClick:C,panOnDrag:A,defaultViewport:P,translateExtent:V,minZoom:I,maxZoom:T,preventScrolling:R,onSelectionContextMenu:_,noWheelClassName:N,noPanClassName:E,disableKeyboardA11y:M,onViewportChange:k,isControlledViewport:z}){const{nodesSelectionActive:$,userSelectionActive:H}=ne(Ff,ie),L=yt(u,{target:or}),W=yt(y,{target:or}),F=W||A,U=W||v,J=h&&F!==!0,Z=L||H||J;return Sf({deleteKeyCode:l,multiSelectionKeyCode:p}),c.jsx(Cf,{onPaneContextMenu:i,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:g,panOnScroll:U,panOnScrollSpeed:j,panOnScrollMode:S,zoomOnDoubleClick:C,panOnDrag:!L&&F,defaultViewport:P,translateExtent:V,minZoom:I,maxZoom:T,zoomActivationKeyCode:w,preventScrolling:R,noWheelClassName:N,noPanClassName:E,onViewportChange:k,isControlledViewport:z,paneClickDistance:a,selectionOnDrag:J,children:c.jsxs(If,{onSelectionStart:f,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:F,isSelecting:!!Z,selectionMode:d,selectionKeyPressed:L,paneClickDistance:a,selectionOnDrag:J,children:[e,$&&c.jsx(Of,{onSelectionContextMenu:_,noPanClassName:E,disableKeyboardA11y:M})]})})}Ms.displayName="FlowRenderer";const Wf=D.memo(Ms),Xf=e=>t=>e?Yn(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Yf(e){return ne(D.useCallback(Xf(e),[e]),ie)}const Zf=e=>e.updateNodeInternals;function Gf(){const e=ne(Zf),[t]=D.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(r=>{const i=r.target.getAttribute("data-id");o.set(i,{id:i,nodeElement:r.target,force:!0})}),e(o)}));return D.useEffect(()=>()=>{t?.disconnect()},[t]),t}function qf({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const r=ae(),i=D.useRef(null),s=D.useRef(null),a=D.useRef(e.sourcePosition),l=D.useRef(e.targetPosition),u=D.useRef(t),h=n&&!!e.internals.handleBounds;return D.useEffect(()=>{i.current&&!e.hidden&&(!h||s.current!==i.current)&&(s.current&&o?.unobserve(s.current),o?.observe(i.current),s.current=i.current)},[h,e.hidden]),D.useEffect(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),D.useEffect(()=>{if(i.current){const d=u.current!==t,f=a.current!==e.sourcePosition,m=l.current!==e.targetPosition;(d||f||m)&&(u.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function Uf({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:l,nodesConnectable:u,nodesFocusable:h,resizeObserver:d,noDragClassName:f,noPanClassName:m,disableKeyboardA11y:p,rfId:y,nodeTypes:w,nodeClickDistance:x,onError:b}){const{node:g,internals:v,isParent:j}=ne(B=>{const Y=B.nodeLookup.get(e),te=B.parentLookup.has(e);return{node:Y,internals:Y.internals,isParent:te}},ie);let S=g.type||"default",C=w?.[S]||nr[S];C===void 0&&(b?.("003",ye.error003(S)),S="default",C=w?.default||nr.default);const A=!!(g.draggable||a&&typeof g.draggable>"u"),P=!!(g.selectable||l&&typeof g.selectable>"u"),V=!!(g.connectable||u&&typeof g.connectable>"u"),I=!!(g.focusable||h&&typeof g.focusable>"u"),T=ae(),R=Qr(g),_=qf({node:g,nodeType:S,hasDimensions:R,resizeObserver:d}),N=Cs({nodeRef:_,disabled:g.hidden||!A,noDragClassName:f,handleSelector:g.dragHandle,nodeId:e,isSelectable:P,nodeClickDistance:x}),E=Ns();if(g.hidden)return null;const M=Ee(g),k=Vf(g),z=P||A||t||n||o||r,$=n?B=>n(B,{...v.userNode}):void 0,H=o?B=>o(B,{...v.userNode}):void 0,L=r?B=>r(B,{...v.userNode}):void 0,W=i?B=>i(B,{...v.userNode}):void 0,F=s?B=>s(B,{...v.userNode}):void 0,U=B=>{const{selectNodesOnDrag:Y,nodeDragThreshold:te}=T.getState();P&&(!Y||!A||te>0)&&Rn({id:e,store:T,nodeRef:_}),t&&t(B,{...v.userNode})},J=B=>{if(!(ts(B.nativeEvent)||p)){if(Fr.includes(B.key)&&P){const Y=B.key==="Escape";Rn({id:e,store:T,unselect:Y,nodeRef:_})}else if(A&&g.selected&&Object.prototype.hasOwnProperty.call(Kt,B.key)){B.preventDefault();const{ariaLabelConfig:Y}=T.getState();T.setState({ariaLiveMessage:Y["node.a11yDescription.ariaLiveMessage"]({direction:B.key.replace("Arrow","").toLowerCase(),x:~~v.positionAbsolute.x,y:~~v.positionAbsolute.y})}),E({direction:Kt[B.key],factor:B.shiftKey?4:1})}}},Z=()=>{if(p||!_.current?.matches(":focus-visible"))return;const{transform:B,width:Y,height:te,autoPanOnNodeFocus:ee,setCenter:K}=T.getState();if(!ee)return;Yn(new Map([[e,g]]),{x:0,y:0,width:Y,height:te},B,!0).length>0||K(g.position.x+M.width/2,g.position.y+M.height/2,{zoom:B[2]})};return c.jsx("div",{className:ce(["react-flow__node",`react-flow__node-${S}`,{[m]:A},g.className,{selected:g.selected,selectable:P,parent:j,draggable:A,dragging:N}]),ref:_,style:{zIndex:v.z,transform:`translate(${v.positionAbsolute.x}px,${v.positionAbsolute.y}px)`,pointerEvents:z?"all":"none",visibility:R?"visible":"hidden",...g.style,...k},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:$,onMouseMove:H,onMouseLeave:L,onContextMenu:W,onClick:U,onDoubleClick:F,onKeyDown:I?J:void 0,tabIndex:I?0:void 0,onFocus:I?Z:void 0,role:g.ariaRole??(I?"group":void 0),"aria-roledescription":"node","aria-describedby":p?void 0:`${vs}-${y}`,"aria-label":g.ariaLabel,...g.domAttributes,children:c.jsx(Pf,{value:e,children:c.jsx(C,{id:e,data:g.data,type:S,positionAbsoluteX:v.positionAbsolute.x,positionAbsoluteY:v.positionAbsolute.y,selected:g.selected??!1,selectable:P,draggable:A,deletable:g.deletable??!0,isConnectable:V,sourcePosition:g.sourcePosition,targetPosition:g.targetPosition,dragging:N,dragHandle:g.dragHandle,zIndex:v.z,parentId:g.parentId,...M})})})}var Kf=D.memo(Uf);const Qf=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Is(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:i}=ne(Qf,ie),s=Yf(e.onlyRenderVisibleElements),a=Gf();return c.jsx("div",{className:"react-flow__nodes",style:ln,children:s.map(l=>c.jsx(Kf,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:i},l))})}Is.displayName="NodeRenderer";const Jf=D.memo(Is);function eh(e){return ne(D.useCallback(n=>{if(!e)return n.edges.map(r=>r.id);const o=[];if(n.width&&n.height)for(const r of n.edges){const i=n.nodeLookup.get(r.source),s=n.nodeLookup.get(r.target);i&&s&&td({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[e]),ie)}const th=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return c.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},nh=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return c.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},rr={[Gt.Arrow]:th,[Gt.ArrowClosed]:nh};function oh(e){const t=ae();return D.useMemo(()=>Object.prototype.hasOwnProperty.call(rr,e)?rr[e]:(t.getState().onError?.("009",ye.error009(e)),null),[e])}const rh=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const l=oh(t);return l?c.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:c.jsx(l,{color:n,strokeWidth:s})}):null},zs=({defaultColor:e,rfId:t})=>{const n=ne(i=>i.edges),o=ne(i=>i.defaultEdgeOptions),r=D.useMemo(()=>ld(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return r.length?c.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:c.jsx("defs",{children:r.map(i=>c.jsx(rh,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};zs.displayName="MarkerDefinitions";var sh=D.memo(zs);function Ps({x:e,y:t,label:n,labelStyle:o,labelShowBg:r=!0,labelBgStyle:i,labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:u,...h}){const[d,f]=D.useState({x:1,y:0,width:0,height:0}),m=ce(["react-flow__edge-textwrapper",u]),p=D.useRef(null);return D.useEffect(()=>{if(p.current){const y=p.current.getBBox();f({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),n?c.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:m,visibility:d.width?"visible":"hidden",...h,children:[r&&c.jsx("rect",{width:d.width+2*s[0],x:-s[0],y:-s[1],height:d.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),c.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:p,style:o,children:n}),l]}):null}Ps.displayName="EdgeText";const ih=D.memo(Ps);function un({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:u=20,...h}){return c.jsxs(c.Fragment,{children:[c.jsx("path",{...h,d:e,fill:"none",className:ce(["react-flow__edge-path",h.className])}),u?c.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,o&&ge(t)&&ge(n)?c.jsx(ih,{x:t,y:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function sr({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===X.Left||e===X.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function As({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:i=X.Top}){const[s,a]=sr({pos:n,x1:e,y1:t,x2:o,y2:r}),[l,u]=sr({pos:i,x1:o,y1:r,x2:e,y2:t}),[h,d,f,m]=os({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${a} ${l},${u} ${o},${r}`,h,d,f,m]}function Ds(e){return D.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s,targetPosition:a,label:l,labelStyle:u,labelShowBg:h,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:m,style:p,markerEnd:y,markerStart:w,interactionWidth:x})=>{const[b,g,v]=As({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a}),j=e.isInternal?void 0:t;return c.jsx(un,{id:j,path:b,labelX:g,labelY:v,label:l,labelStyle:u,labelShowBg:h,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:m,style:p,markerEnd:y,markerStart:w,interactionWidth:x})})}const ah=Ds({isInternal:!1}),Ts=Ds({isInternal:!0});ah.displayName="SimpleBezierEdge";Ts.displayName="SimpleBezierEdgeInternal";function $s(e){return D.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:d,style:f,sourcePosition:m=X.Bottom,targetPosition:p=X.Top,markerEnd:y,markerStart:w,pathOptions:x,interactionWidth:b})=>{const[g,v,j]=An({sourceX:n,sourceY:o,sourcePosition:m,targetX:r,targetY:i,targetPosition:p,borderRadius:x?.borderRadius,offset:x?.offset,stepPosition:x?.stepPosition}),S=e.isInternal?void 0:t;return c.jsx(un,{id:S,path:g,labelX:v,labelY:j,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:y,markerStart:w,interactionWidth:b})})}const Rs=$s({isInternal:!1}),Ls=$s({isInternal:!0});Rs.displayName="SmoothStepEdge";Ls.displayName="SmoothStepEdgeInternal";function Hs(e){return D.memo(({id:t,...n})=>{const o=e.isInternal?void 0:t;return c.jsx(Rs,{...n,id:o,pathOptions:D.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const ch=Hs({isInternal:!1}),Vs=Hs({isInternal:!0});ch.displayName="StepEdge";Vs.displayName="StepEdgeInternal";function Bs(e){return D.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:m,markerStart:p,interactionWidth:y})=>{const[w,x,b]=is({sourceX:n,sourceY:o,targetX:r,targetY:i}),g=e.isInternal?void 0:t;return c.jsx(un,{id:g,path:w,labelX:x,labelY:b,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:u,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:m,markerStart:p,interactionWidth:y})})}const lh=Bs({isInternal:!1}),Os=Bs({isInternal:!0});lh.displayName="StraightEdge";Os.displayName="StraightEdgeInternal";function Fs(e){return D.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s=X.Bottom,targetPosition:a=X.Top,label:l,labelStyle:u,labelShowBg:h,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:m,style:p,markerEnd:y,markerStart:w,pathOptions:x,interactionWidth:b})=>{const[g,v,j]=rs({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a,curvature:x?.curvature}),S=e.isInternal?void 0:t;return c.jsx(un,{id:S,path:g,labelX:v,labelY:j,label:l,labelStyle:u,labelShowBg:h,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:m,style:p,markerEnd:y,markerStart:w,interactionWidth:b})})}const uh=Fs({isInternal:!1}),Ws=Fs({isInternal:!0});uh.displayName="BezierEdge";Ws.displayName="BezierEdgeInternal";const ir={default:Ws,straight:Os,step:Vs,smoothstep:Ls,simplebezier:Ts},ar={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},dh=(e,t,n)=>n===X.Left?e-t:n===X.Right?e+t:e,fh=(e,t,n)=>n===X.Top?e-t:n===X.Bottom?e+t:e,cr="react-flow__edgeupdater";function lr({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:i,onMouseOut:s,type:a}){return c.jsx("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:s,className:ce([cr,`${cr}-${a}`]),cx:dh(t,o,e),cy:fh(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function hh({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:i,targetY:s,sourcePosition:a,targetPosition:l,onReconnect:u,onReconnectStart:h,onReconnectEnd:d,setReconnecting:f,setUpdateHover:m}){const p=ae(),y=(v,j)=>{if(v.button!==0)return;const{autoPanOnConnect:S,domNode:C,isValidConnection:A,connectionMode:P,connectionRadius:V,lib:I,onConnectStart:T,onConnectEnd:R,cancelConnection:_,nodeLookup:N,rfId:E,panBy:M,updateConnection:k}=p.getState(),z=j.type==="target",$=(W,F)=>{f(!1),d?.(W,n,j.type,F)},H=W=>u?.(n,W),L=(W,F)=>{f(!0),h?.(v,n,j.type),T?.(W,F)};$n.onPointerDown(v.nativeEvent,{autoPanOnConnect:S,connectionMode:P,connectionRadius:V,domNode:C,handleId:j.id,nodeId:j.nodeId,nodeLookup:N,isTarget:z,edgeUpdaterType:j.type,lib:I,flowId:E,cancelConnection:_,panBy:M,isValidConnection:A,onConnect:H,onConnectStart:L,onConnectEnd:R,onReconnectEnd:$,updateConnection:k,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle,dragThreshold:p.getState().connectionDragThreshold,handleDomNode:v.currentTarget})},w=v=>y(v,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),x=v=>y(v,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),b=()=>m(!0),g=()=>m(!1);return c.jsxs(c.Fragment,{children:[(e===!0||e==="source")&&c.jsx(lr,{position:a,centerX:o,centerY:r,radius:t,onMouseDown:w,onMouseEnter:b,onMouseOut:g,type:"source"}),(e===!0||e==="target")&&c.jsx(lr,{position:l,centerX:i,centerY:s,radius:t,onMouseDown:x,onMouseEnter:b,onMouseOut:g,type:"target"})]})}function ph({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:u,reconnectRadius:h,onReconnect:d,onReconnectStart:f,onReconnectEnd:m,rfId:p,edgeTypes:y,noPanClassName:w,onError:x,disableKeyboardA11y:b}){let g=ne(K=>K.edgeLookup.get(e));const v=ne(K=>K.defaultEdgeOptions);g=v?{...v,...g}:g;let j=g.type||"default",S=y?.[j]||ir[j];S===void 0&&(x?.("011",ye.error011(j)),j="default",S=y?.default||ir.default);const C=!!(g.focusable||t&&typeof g.focusable>"u"),A=typeof d<"u"&&(g.reconnectable||n&&typeof g.reconnectable>"u"),P=!!(g.selectable||o&&typeof g.selectable>"u"),V=D.useRef(null),[I,T]=D.useState(!1),[R,_]=D.useState(!1),N=ae(),{zIndex:E,sourceX:M,sourceY:k,targetX:z,targetY:$,sourcePosition:H,targetPosition:L}=ne(D.useCallback(K=>{const Q=K.nodeLookup.get(g.source),oe=K.nodeLookup.get(g.target);if(!Q||!oe)return{zIndex:g.zIndex,...ar};const se=cd({id:e,sourceNode:Q,targetNode:oe,sourceHandle:g.sourceHandle||null,targetHandle:g.targetHandle||null,connectionMode:K.connectionMode,onError:x});return{zIndex:ed({selected:g.selected,zIndex:g.zIndex,sourceNode:Q,targetNode:oe,elevateOnSelect:K.elevateEdgesOnSelect,zIndexMode:K.zIndexMode}),...se||ar}},[g.source,g.target,g.sourceHandle,g.targetHandle,g.selected,g.zIndex]),ie),W=D.useMemo(()=>g.markerStart?`url('#${Dn(g.markerStart,p)}')`:void 0,[g.markerStart,p]),F=D.useMemo(()=>g.markerEnd?`url('#${Dn(g.markerEnd,p)}')`:void 0,[g.markerEnd,p]);if(g.hidden||M===null||k===null||z===null||$===null)return null;const U=K=>{const{addSelectedEdges:Q,unselectNodesAndEdges:oe,multiSelectionActive:se}=N.getState();P&&(N.setState({nodesSelectionActive:!1}),g.selected&&se?(oe({nodes:[],edges:[g]}),V.current?.blur()):Q([e])),r&&r(K,g)},J=i?K=>{i(K,{...g})}:void 0,Z=s?K=>{s(K,{...g})}:void 0,B=a?K=>{a(K,{...g})}:void 0,Y=l?K=>{l(K,{...g})}:void 0,te=u?K=>{u(K,{...g})}:void 0,ee=K=>{if(!b&&Fr.includes(K.key)&&P){const{unselectNodesAndEdges:Q,addSelectedEdges:oe}=N.getState();K.key==="Escape"?(V.current?.blur(),Q({edges:[g]})):oe([e])}};return c.jsx("svg",{style:{zIndex:E},children:c.jsxs("g",{className:ce(["react-flow__edge",`react-flow__edge-${j}`,g.className,w,{selected:g.selected,animated:g.animated,inactive:!P&&!r,updating:I,selectable:P}]),onClick:U,onDoubleClick:J,onContextMenu:Z,onMouseEnter:B,onMouseMove:Y,onMouseLeave:te,onKeyDown:C?ee:void 0,tabIndex:C?0:void 0,role:g.ariaRole??(C?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":g.ariaLabel===null?void 0:g.ariaLabel||`Edge from ${g.source} to ${g.target}`,"aria-describedby":C?`${_s}-${p}`:void 0,ref:V,...g.domAttributes,children:[!R&&c.jsx(S,{id:e,source:g.source,target:g.target,type:g.type,selected:g.selected,animated:g.animated,selectable:P,deletable:g.deletable??!0,label:g.label,labelStyle:g.labelStyle,labelShowBg:g.labelShowBg,labelBgStyle:g.labelBgStyle,labelBgPadding:g.labelBgPadding,labelBgBorderRadius:g.labelBgBorderRadius,sourceX:M,sourceY:k,targetX:z,targetY:$,sourcePosition:H,targetPosition:L,data:g.data,style:g.style,sourceHandleId:g.sourceHandle,targetHandleId:g.targetHandle,markerStart:W,markerEnd:F,pathOptions:"pathOptions"in g?g.pathOptions:void 0,interactionWidth:g.interactionWidth}),A&&c.jsx(hh,{edge:g,isReconnectable:A,reconnectRadius:h,onReconnect:d,onReconnectStart:f,onReconnectEnd:m,sourceX:M,sourceY:k,targetX:z,targetY:$,sourcePosition:H,targetPosition:L,setUpdateHover:T,setReconnecting:_})]})})}var gh=D.memo(ph);const mh=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Xs({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:h,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:m,onReconnectEnd:p,disableKeyboardA11y:y}){const{edgesFocusable:w,edgesReconnectable:x,elementsSelectable:b,onError:g}=ne(mh,ie),v=eh(t);return c.jsxs("div",{className:"react-flow__edges",children:[c.jsx(sh,{defaultColor:e,rfId:n}),v.map(j=>c.jsx(gh,{id:j,edgesFocusable:w,edgesReconnectable:x,elementsSelectable:b,noPanClassName:r,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:u,onClick:h,reconnectRadius:d,onDoubleClick:f,onReconnectStart:m,onReconnectEnd:p,rfId:n,onError:g,edgeTypes:o,disableKeyboardA11y:y},j))]})}Xs.displayName="EdgeRenderer";const xh=D.memo(Xs),yh=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function wh({children:e}){const t=ne(yh);return c.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function vh(e){const t=eo(),n=D.useRef(!1);D.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const _h=e=>e.panZoom?.syncViewport;function bh(e){const t=ne(_h),n=ae();return D.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Sh(e){return e.connection.inProgress?{...e.connection,to:St(e.connection.to,e.transform)}:{...e.connection}}function Eh(e){return Sh}function jh(e){const t=Eh();return ne(t,ie)}const Ch=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Nh({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:r,width:i,height:s,isValid:a,inProgress:l}=ne(Ch,ie);return!(i&&r&&l)?null:c.jsx("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:c.jsx("g",{className:ce(["react-flow__connection",Yr(a)]),children:c.jsx(Ys,{style:t,type:n,CustomComponent:o,isValid:a})})})}const Ys=({style:e,type:t=Me.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:r,from:i,fromNode:s,fromHandle:a,fromPosition:l,to:u,toNode:h,toHandle:d,toPosition:f,pointer:m}=jh();if(!r)return;if(n)return c.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:u.x,toY:u.y,fromPosition:l,toPosition:f,connectionStatus:Yr(o),toNode:h,toHandle:d,pointer:m});let p="";const y={sourceX:i.x,sourceY:i.y,sourcePosition:l,targetX:u.x,targetY:u.y,targetPosition:f};switch(t){case Me.Bezier:[p]=rs(y);break;case Me.SimpleBezier:[p]=As(y);break;case Me.Step:[p]=An({...y,borderRadius:0});break;case Me.SmoothStep:[p]=An(y);break;default:[p]=is(y)}return c.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:e})};Ys.displayName="ConnectionLine";const kh={};function ur(e=kh){D.useRef(e),ae(),D.useEffect(()=>{},[e])}function Mh(){ae(),D.useRef(!1),D.useEffect(()=>{},[])}function Zs({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:u,onNodeContextMenu:h,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:m,connectionLineType:p,connectionLineStyle:y,connectionLineComponent:w,connectionLineContainerStyle:x,selectionKeyCode:b,selectionOnDrag:g,selectionMode:v,multiSelectionKeyCode:j,panActivationKeyCode:S,zoomActivationKeyCode:C,deleteKeyCode:A,onlyRenderVisibleElements:P,elementsSelectable:V,defaultViewport:I,translateExtent:T,minZoom:R,maxZoom:_,preventScrolling:N,defaultMarkerColor:E,zoomOnScroll:M,zoomOnPinch:k,panOnScroll:z,panOnScrollSpeed:$,panOnScrollMode:H,zoomOnDoubleClick:L,panOnDrag:W,onPaneClick:F,onPaneMouseEnter:U,onPaneMouseMove:J,onPaneMouseLeave:Z,onPaneScroll:B,onPaneContextMenu:Y,paneClickDistance:te,nodeClickDistance:ee,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:oe,onEdgeMouseLeave:se,reconnectRadius:re,onReconnect:le,onReconnectStart:je,onReconnectEnd:ve,noDragClassName:ze,noWheelClassName:Je,noPanClassName:et,disableKeyboardA11y:tt,nodeExtent:dn,rfId:Et,viewport:He,onViewportChange:nt}){return ur(e),ur(t),Mh(),vh(n),bh(He),c.jsx(Wf,{onPaneClick:F,onPaneMouseEnter:U,onPaneMouseMove:J,onPaneMouseLeave:Z,onPaneContextMenu:Y,onPaneScroll:B,paneClickDistance:te,deleteKeyCode:A,selectionKeyCode:b,selectionOnDrag:g,selectionMode:v,onSelectionStart:f,onSelectionEnd:m,multiSelectionKeyCode:j,panActivationKeyCode:S,zoomActivationKeyCode:C,elementsSelectable:V,zoomOnScroll:M,zoomOnPinch:k,zoomOnDoubleClick:L,panOnScroll:z,panOnScrollSpeed:$,panOnScrollMode:H,panOnDrag:W,defaultViewport:I,translateExtent:T,minZoom:R,maxZoom:_,onSelectionContextMenu:d,preventScrolling:N,noDragClassName:ze,noWheelClassName:Je,noPanClassName:et,disableKeyboardA11y:tt,onViewportChange:nt,isControlledViewport:!!He,children:c.jsxs(wh,{children:[c.jsx(xh,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:s,onReconnect:le,onReconnectStart:je,onReconnectEnd:ve,onlyRenderVisibleElements:P,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:oe,onEdgeMouseLeave:se,reconnectRadius:re,defaultMarkerColor:E,noPanClassName:et,disableKeyboardA11y:tt,rfId:Et}),c.jsx(Nh,{style:y,type:p,component:w,containerStyle:x}),c.jsx("div",{className:"react-flow__edgelabel-renderer"}),c.jsx(Jf,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:u,onNodeContextMenu:h,nodeClickDistance:ee,onlyRenderVisibleElements:P,noPanClassName:et,noDragClassName:ze,disableKeyboardA11y:tt,nodeExtent:dn,rfId:Et}),c.jsx("div",{className:"react-flow__viewport-portal"})]})})}Zs.displayName="GraphView";const Ih=D.memo(Zs),dr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:l=.5,maxZoom:u=2,nodeOrigin:h,nodeExtent:d,zIndexMode:f="basic"}={})=>{const m=new Map,p=new Map,y=new Map,w=new Map,x=o??t??[],b=n??e??[],g=h??[0,0],v=d??pt;ls(y,w,x);const j=Tn(b,m,p,{nodeOrigin:g,nodeExtent:v,zIndexMode:f});let S=[0,0,1];if(s&&r&&i){const C=_t(m,{filter:I=>!!((I.width||I.initialWidth)&&(I.height||I.initialHeight))}),{x:A,y:P,zoom:V}=Zn(C,r,i,l,u,a?.padding??.1);S=[A,P,V]}return{rfId:"1",width:r??0,height:i??0,transform:S,nodes:b,nodesInitialized:j,nodeLookup:m,parentLookup:p,edges:x,edgeLookup:w,connectionLookup:y,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:l,maxZoom:u,translateExtent:pt,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ze.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:g,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Xr},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Gu,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Wr,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},zh=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:l,maxZoom:u,nodeOrigin:h,nodeExtent:d,zIndexMode:f})=>Yd((m,p)=>{async function y(){const{nodeLookup:w,panZoom:x,fitViewOptions:b,fitViewResolver:g,width:v,height:j,minZoom:S,maxZoom:C}=p();x&&(await Yu({nodes:w,width:v,height:j,panZoom:x,minZoom:S,maxZoom:C},b),g?.resolve(!0),m({fitViewResolver:null}))}return{...dr({nodes:e,edges:t,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:l,maxZoom:u,nodeOrigin:h,nodeExtent:d,defaultNodes:n,defaultEdges:o,zIndexMode:f}),setNodes:w=>{const{nodeLookup:x,parentLookup:b,nodeOrigin:g,elevateNodesOnSelect:v,fitViewQueued:j,zIndexMode:S}=p(),C=Tn(w,x,b,{nodeOrigin:g,nodeExtent:d,elevateNodesOnSelect:v,checkEquality:!0,zIndexMode:S});j&&C?(y(),m({nodes:w,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):m({nodes:w,nodesInitialized:C})},setEdges:w=>{const{connectionLookup:x,edgeLookup:b}=p();ls(x,b,w),m({edges:w})},setDefaultNodesAndEdges:(w,x)=>{if(w){const{setNodes:b}=p();b(w),m({hasDefaultNodes:!0})}if(x){const{setEdges:b}=p();b(x),m({hasDefaultEdges:!0})}},updateNodeInternals:w=>{const{triggerNodeChanges:x,nodeLookup:b,parentLookup:g,domNode:v,nodeOrigin:j,nodeExtent:S,debug:C,fitViewQueued:A,zIndexMode:P}=p(),{changes:V,updatedInternals:I}=md(w,b,g,v,j,S,P);I&&(fd(b,g,{nodeOrigin:j,nodeExtent:S,zIndexMode:P}),A?(y(),m({fitViewQueued:!1,fitViewOptions:void 0})):m({}),V?.length>0&&(C&&console.log("React Flow: trigger node changes",V),x?.(V)))},updateNodePositions:(w,x=!1)=>{const b=[];let g=[];const{nodeLookup:v,triggerNodeChanges:j,connection:S,updateConnection:C,onNodesChangeMiddlewareMap:A}=p();for(const[P,V]of w){const I=v.get(P),T=!!(I?.expandParent&&I?.parentId&&V?.position),R={id:P,type:"position",position:T?{x:Math.max(0,V.position.x),y:Math.max(0,V.position.y)}:V.position,dragging:x};if(I&&S.inProgress&&S.fromNode.id===I.id){const _=Re(I,S.fromHandle,X.Left,!0);C({...S,from:_})}T&&I.parentId&&b.push({id:P,parentId:I.parentId,rect:{...V.internals.positionAbsolute,width:V.measured.width??0,height:V.measured.height??0}}),g.push(R)}if(b.length>0){const{parentLookup:P,nodeOrigin:V}=p(),I=Jn(b,v,P,V);g.push(...I)}for(const P of A.values())g=P(g);j(g)},triggerNodeChanges:w=>{const{onNodesChange:x,setNodes:b,nodes:g,hasDefaultNodes:v,debug:j}=p();if(w?.length){if(v){const S=pf(w,g);b(S)}j&&console.log("React Flow: trigger node changes",w),x?.(w)}},triggerEdgeChanges:w=>{const{onEdgesChange:x,setEdges:b,edges:g,hasDefaultEdges:v,debug:j}=p();if(w?.length){if(v){const S=gf(w,g);b(S)}j&&console.log("React Flow: trigger edge changes",w),x?.(w)}},addSelectedNodes:w=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:g,triggerNodeChanges:v,triggerEdgeChanges:j}=p();if(x){const S=w.map(C=>Ae(C,!0));v(S);return}v(Oe(g,new Set([...w]),!0)),j(Oe(b))},addSelectedEdges:w=>{const{multiSelectionActive:x,edgeLookup:b,nodeLookup:g,triggerNodeChanges:v,triggerEdgeChanges:j}=p();if(x){const S=w.map(C=>Ae(C,!0));j(S);return}j(Oe(b,new Set([...w]))),v(Oe(g,new Set,!0))},unselectNodesAndEdges:({nodes:w,edges:x}={})=>{const{edges:b,nodes:g,nodeLookup:v,triggerNodeChanges:j,triggerEdgeChanges:S}=p(),C=w||g,A=x||b,P=C.map(I=>{const T=v.get(I.id);return T&&(T.selected=!1),Ae(I.id,!1)}),V=A.map(I=>Ae(I.id,!1));j(P),S(V)},setMinZoom:w=>{const{panZoom:x,maxZoom:b}=p();x?.setScaleExtent([w,b]),m({minZoom:w})},setMaxZoom:w=>{const{panZoom:x,minZoom:b}=p();x?.setScaleExtent([b,w]),m({maxZoom:w})},setTranslateExtent:w=>{p().panZoom?.setTranslateExtent(w),m({translateExtent:w})},resetSelectedElements:()=>{const{edges:w,nodes:x,triggerNodeChanges:b,triggerEdgeChanges:g,elementsSelectable:v}=p();if(!v)return;const j=x.reduce((C,A)=>A.selected?[...C,Ae(A.id,!1)]:C,[]),S=w.reduce((C,A)=>A.selected?[...C,Ae(A.id,!1)]:C,[]);b(j),g(S)},setNodeExtent:w=>{const{nodes:x,nodeLookup:b,parentLookup:g,nodeOrigin:v,elevateNodesOnSelect:j,nodeExtent:S,zIndexMode:C}=p();w[0][0]===S[0][0]&&w[0][1]===S[0][1]&&w[1][0]===S[1][0]&&w[1][1]===S[1][1]||(Tn(x,b,g,{nodeOrigin:v,nodeExtent:w,elevateNodesOnSelect:j,checkEquality:!1,zIndexMode:C}),m({nodeExtent:w}))},panBy:w=>{const{transform:x,width:b,height:g,panZoom:v,translateExtent:j}=p();return xd({delta:w,panZoom:v,transform:x,translateExtent:j,width:b,height:g})},setCenter:async(w,x,b)=>{const{width:g,height:v,maxZoom:j,panZoom:S}=p();if(!S)return Promise.resolve(!1);const C=typeof b?.zoom<"u"?b.zoom:j;return await S.setViewport({x:g/2-w*C,y:v/2-x*C,zoom:C},{duration:b?.duration,ease:b?.ease,interpolate:b?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{m({connection:{...Xr}})},updateConnection:w=>{m({connection:w})},reset:()=>m({...dr()})}},Object.is);function Ln({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:i,initialMinZoom:s,initialMaxZoom:a,initialFitViewOptions:l,fitView:u,nodeOrigin:h,nodeExtent:d,zIndexMode:f,children:m}){const[p]=D.useState(()=>zh({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:u,minZoom:s,maxZoom:a,fitViewOptions:l,nodeOrigin:h,nodeExtent:d,zIndexMode:f}));return c.jsx(Zd,{value:p,children:c.jsx(wf,{children:m})})}function Ph({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:i,height:s,fitView:a,fitViewOptions:l,minZoom:u,maxZoom:h,nodeOrigin:d,nodeExtent:f,zIndexMode:m}){return D.useContext(an)?c.jsx(c.Fragment,{children:e}):c.jsx(Ln,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:i,initialHeight:s,fitView:a,initialFitViewOptions:l,initialMinZoom:u,initialMaxZoom:h,nodeOrigin:d,nodeExtent:f,zIndexMode:m,children:e})}const Ah={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Dh({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:l,onInit:u,onMove:h,onMoveStart:d,onMoveEnd:f,onConnect:m,onConnectStart:p,onConnectEnd:y,onClickConnectStart:w,onClickConnectEnd:x,onNodeMouseEnter:b,onNodeMouseMove:g,onNodeMouseLeave:v,onNodeContextMenu:j,onNodeDoubleClick:S,onNodeDragStart:C,onNodeDrag:A,onNodeDragStop:P,onNodesDelete:V,onEdgesDelete:I,onDelete:T,onSelectionChange:R,onSelectionDragStart:_,onSelectionDrag:N,onSelectionDragStop:E,onSelectionContextMenu:M,onSelectionStart:k,onSelectionEnd:z,onBeforeDelete:$,connectionMode:H,connectionLineType:L=Me.Bezier,connectionLineStyle:W,connectionLineComponent:F,connectionLineContainerStyle:U,deleteKeyCode:J="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:B=!1,selectionMode:Y=gt.Full,panActivationKeyCode:te="Space",multiSelectionKeyCode:ee=xt()?"Meta":"Control",zoomActivationKeyCode:K=xt()?"Meta":"Control",snapToGrid:Q,snapGrid:oe,onlyRenderVisibleElements:se=!1,selectNodesOnDrag:re,nodesDraggable:le,autoPanOnNodeFocus:je,nodesConnectable:ve,nodesFocusable:ze,nodeOrigin:Je=bs,edgesFocusable:et,edgesReconnectable:tt,elementsSelectable:dn=!0,defaultViewport:Et=af,minZoom:He=.5,maxZoom:nt=2,translateExtent:no=pt,preventScrolling:Ks=!0,nodeExtent:fn,defaultMarkerColor:Qs="#b1b1b7",zoomOnScroll:Js=!0,zoomOnPinch:ei=!0,panOnScroll:ti=!1,panOnScrollSpeed:ni=.5,panOnScrollMode:oi=De.Free,zoomOnDoubleClick:ri=!0,panOnDrag:si=!0,onPaneClick:ii,onPaneMouseEnter:ai,onPaneMouseMove:ci,onPaneMouseLeave:li,onPaneScroll:ui,onPaneContextMenu:di,paneClickDistance:fi=1,nodeClickDistance:hi=0,children:pi,onReconnect:gi,onReconnectStart:mi,onReconnectEnd:xi,onEdgeContextMenu:yi,onEdgeDoubleClick:wi,onEdgeMouseEnter:vi,onEdgeMouseMove:_i,onEdgeMouseLeave:bi,reconnectRadius:Si=10,onNodesChange:Ei,onEdgesChange:ji,noDragClassName:Ci="nodrag",noWheelClassName:Ni="nowheel",noPanClassName:oo="nopan",fitView:ro,fitViewOptions:so,connectOnClick:ki,attributionPosition:Mi,proOptions:Ii,defaultEdgeOptions:zi,elevateNodesOnSelect:Pi=!0,elevateEdgesOnSelect:Ai=!1,disableKeyboardA11y:io=!1,autoPanOnConnect:Di,autoPanOnNodeDrag:Ti,autoPanSpeed:$i,connectionRadius:Ri,isValidConnection:Li,onError:Hi,style:Vi,id:ao,nodeDragThreshold:Bi,connectionDragThreshold:Oi,viewport:Fi,onViewportChange:Wi,width:Xi,height:Yi,colorMode:Zi="light",debug:Gi,onScroll:co,ariaLabelConfig:qi,zIndexMode:lo="basic",...Ui},Ki){const hn=ao||"1",Qi=df(Zi),Ji=D.useCallback(uo=>{uo.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),co?.(uo)},[co]);return c.jsx("div",{"data-testid":"rf__wrapper",...Ui,onScroll:Ji,style:{...Vi,...Ah},ref:Ki,className:ce(["react-flow",r,Qi]),id:ao,role:"application",children:c.jsxs(Ph,{nodes:e,edges:t,width:Xi,height:Yi,fitView:ro,fitViewOptions:so,minZoom:He,maxZoom:nt,nodeOrigin:Je,nodeExtent:fn,zIndexMode:lo,children:[c.jsx(Ih,{onInit:u,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:b,onNodeMouseMove:g,onNodeMouseLeave:v,onNodeContextMenu:j,onNodeDoubleClick:S,nodeTypes:i,edgeTypes:s,connectionLineType:L,connectionLineStyle:W,connectionLineComponent:F,connectionLineContainerStyle:U,selectionKeyCode:Z,selectionOnDrag:B,selectionMode:Y,deleteKeyCode:J,multiSelectionKeyCode:ee,panActivationKeyCode:te,zoomActivationKeyCode:K,onlyRenderVisibleElements:se,defaultViewport:Et,translateExtent:no,minZoom:He,maxZoom:nt,preventScrolling:Ks,zoomOnScroll:Js,zoomOnPinch:ei,zoomOnDoubleClick:ri,panOnScroll:ti,panOnScrollSpeed:ni,panOnScrollMode:oi,panOnDrag:si,onPaneClick:ii,onPaneMouseEnter:ai,onPaneMouseMove:ci,onPaneMouseLeave:li,onPaneScroll:ui,onPaneContextMenu:di,paneClickDistance:fi,nodeClickDistance:hi,onSelectionContextMenu:M,onSelectionStart:k,onSelectionEnd:z,onReconnect:gi,onReconnectStart:mi,onReconnectEnd:xi,onEdgeContextMenu:yi,onEdgeDoubleClick:wi,onEdgeMouseEnter:vi,onEdgeMouseMove:_i,onEdgeMouseLeave:bi,reconnectRadius:Si,defaultMarkerColor:Qs,noDragClassName:Ci,noWheelClassName:Ni,noPanClassName:oo,rfId:hn,disableKeyboardA11y:io,nodeExtent:fn,viewport:Fi,onViewportChange:Wi}),c.jsx(uf,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:m,onConnectStart:p,onConnectEnd:y,onClickConnectStart:w,onClickConnectEnd:x,nodesDraggable:le,autoPanOnNodeFocus:je,nodesConnectable:ve,nodesFocusable:ze,edgesFocusable:et,edgesReconnectable:tt,elementsSelectable:dn,elevateNodesOnSelect:Pi,elevateEdgesOnSelect:Ai,minZoom:He,maxZoom:nt,nodeExtent:fn,onNodesChange:Ei,onEdgesChange:ji,snapToGrid:Q,snapGrid:oe,connectionMode:H,translateExtent:no,connectOnClick:ki,defaultEdgeOptions:zi,fitView:ro,fitViewOptions:so,onNodesDelete:V,onEdgesDelete:I,onDelete:T,onNodeDragStart:C,onNodeDrag:A,onNodeDragStop:P,onSelectionDrag:N,onSelectionDragStart:_,onSelectionDragStop:E,onMove:h,onMoveStart:d,onMoveEnd:f,noPanClassName:oo,nodeOrigin:Je,rfId:hn,autoPanOnConnect:Di,autoPanOnNodeDrag:Ti,autoPanSpeed:$i,onError:Hi,connectionRadius:Ri,isValidConnection:Li,selectNodesOnDrag:re,nodeDragThreshold:Bi,connectionDragThreshold:Oi,onBeforeDelete:$,debug:Gi,ariaLabelConfig:qi,zIndexMode:lo}),c.jsx(sf,{onSelectionChange:R}),pi,c.jsx(ef,{proOptions:Ii,position:Mi}),c.jsx(Jd,{rfId:hn,disableKeyboardA11y:io})]})})}var fr=Es(Dh);function Th({dimensions:e,lineWidth:t,variant:n,className:o}){return c.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ce(["react-flow__background-pattern",n,o])})}function $h({radius:e,className:t}){return c.jsx("circle",{cx:e,cy:e,r:e,className:ce(["react-flow__background-pattern","dots",t])})}var Ie;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ie||(Ie={}));const Rh={[Ie.Dots]:1,[Ie.Lines]:1,[Ie.Cross]:6},Lh=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Gs({id:e,variant:t=Ie.Dots,gap:n=20,size:o,lineWidth:r=1,offset:i=0,color:s,bgColor:a,style:l,className:u,patternClassName:h}){const d=D.useRef(null),{transform:f,patternId:m}=ne(Lh,ie),p=o||Rh[t],y=t===Ie.Dots,w=t===Ie.Cross,x=Array.isArray(n)?n:[n,n],b=[x[0]*f[2]||1,x[1]*f[2]||1],g=p*f[2],v=Array.isArray(i)?i:[i,i],j=w?[g,g]:b,S=[v[0]*f[2]||1+j[0]/2,v[1]*f[2]||1+j[1]/2],C=`${m}${e||""}`;return c.jsxs("svg",{className:ce(["react-flow__background",u]),style:{...l,...ln,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:d,"data-testid":"rf__background",children:[c.jsx("pattern",{id:C,x:f[0]%b[0],y:f[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${S[0]},-${S[1]})`,children:y?c.jsx($h,{radius:g/2,className:h}):c.jsx(Th,{dimensions:j,lineWidth:r,variant:t,className:h})}),c.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${C})`})]})}Gs.displayName="Background";const hr=D.memo(Gs);function Hh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:c.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Vh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:c.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Bh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:c.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Oh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:c.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Fh(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:c.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function $t({children:e,className:t,...n}){return c.jsx("button",{type:"button",className:ce(["react-flow__controls-button",t]),...n,children:e})}const Wh=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function qs({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:l,className:u,children:h,position:d="bottom-left",orientation:f="vertical","aria-label":m}){const p=ae(),{isInteractive:y,minZoomReached:w,maxZoomReached:x,ariaLabelConfig:b}=ne(Wh,ie),{zoomIn:g,zoomOut:v,fitView:j}=eo(),S=()=>{g(),i?.()},C=()=>{v(),s?.()},A=()=>{j(r),a?.()},P=()=>{p.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),l?.(!y)},V=f==="horizontal"?"horizontal":"vertical";return c.jsxs(cn,{className:ce(["react-flow__controls",V,u]),position:d,style:e,"data-testid":"rf__controls","aria-label":m??b["controls.ariaLabel"],children:[t&&c.jsxs(c.Fragment,{children:[c.jsx($t,{onClick:S,className:"react-flow__controls-zoomin",title:b["controls.zoomIn.ariaLabel"],"aria-label":b["controls.zoomIn.ariaLabel"],disabled:x,children:c.jsx(Hh,{})}),c.jsx($t,{onClick:C,className:"react-flow__controls-zoomout",title:b["controls.zoomOut.ariaLabel"],"aria-label":b["controls.zoomOut.ariaLabel"],disabled:w,children:c.jsx(Vh,{})})]}),n&&c.jsx($t,{className:"react-flow__controls-fitview",onClick:A,title:b["controls.fitView.ariaLabel"],"aria-label":b["controls.fitView.ariaLabel"],children:c.jsx(Bh,{})}),o&&c.jsx($t,{className:"react-flow__controls-interactive",onClick:P,title:b["controls.interactive.ariaLabel"],"aria-label":b["controls.interactive.ariaLabel"],children:y?c.jsx(Fh,{}):c.jsx(Oh,{})}),h]})}qs.displayName="Controls";const pr=D.memo(qs);function Xh({id:e,x:t,y:n,width:o,height:r,style:i,color:s,strokeColor:a,strokeWidth:l,className:u,borderRadius:h,shapeRendering:d,selected:f,onClick:m}){const{background:p,backgroundColor:y}=i||{},w=s||p||y;return c.jsx("rect",{className:ce(["react-flow__minimap-node",{selected:f},u]),x:t,y:n,rx:h,ry:h,width:o,height:r,style:{fill:w,stroke:a,strokeWidth:l},shapeRendering:d,onClick:m?x=>m(x,e):void 0})}const Yh=D.memo(Xh),Zh=e=>e.nodes.map(t=>t.id),Sn=e=>e instanceof Function?e:()=>e;function Gh({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:i=Yh,onClick:s}){const a=ne(Zh,ie),l=Sn(t),u=Sn(e),h=Sn(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return c.jsx(c.Fragment,{children:a.map(f=>c.jsx(Uh,{id:f,nodeColorFunc:l,nodeStrokeColorFunc:u,nodeClassNameFunc:h,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:i,onClick:s,shapeRendering:d},f))})}function qh({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:l}){const{node:u,x:h,y:d,width:f,height:m}=ne(p=>{const{internals:y}=p.nodeLookup.get(e),w=y.userNode,{x,y:b}=y.positionAbsolute,{width:g,height:v}=Ee(w);return{node:w,x,y:b,width:g,height:v}},ie);return!u||u.hidden||!Qr(u)?null:c.jsx(a,{x:h,y:d,width:f,height:m,style:u.style,selected:!!u.selected,className:o(u),color:t(u),borderRadius:r,strokeColor:n(u),strokeWidth:i,shapeRendering:s,onClick:l,id:u.id})}const Uh=D.memo(qh);var Kh=D.memo(Gh);const Qh=200,Jh=150,ep=e=>!e.hidden,tp=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Kr(_t(e.nodeLookup,{filter:ep}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},np="react-flow__minimap-desc";function Us({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:l,maskColor:u,maskStrokeColor:h,maskStrokeWidth:d,position:f="bottom-right",onClick:m,onNodeClick:p,pannable:y=!1,zoomable:w=!1,ariaLabel:x,inversePan:b,zoomStep:g=1,offsetScale:v=5}){const j=ae(),S=D.useRef(null),{boundingRect:C,viewBB:A,rfId:P,panZoom:V,translateExtent:I,flowWidth:T,flowHeight:R,ariaLabelConfig:_}=ne(tp,ie),N=e?.width??Qh,E=e?.height??Jh,M=C.width/N,k=C.height/E,z=Math.max(M,k),$=z*N,H=z*E,L=v*z,W=C.x-($-C.width)/2-L,F=C.y-(H-C.height)/2-L,U=$+L*2,J=H+L*2,Z=`${np}-${P}`,B=D.useRef(0),Y=D.useRef();B.current=z,D.useEffect(()=>{if(S.current&&V)return Y.current=Cd({domNode:S.current,panZoom:V,getTransform:()=>j.getState().transform,getViewScale:()=>B.current}),()=>{Y.current?.destroy()}},[V]),D.useEffect(()=>{Y.current?.update({translateExtent:I,width:T,height:R,inversePan:b,pannable:y,zoomStep:g,zoomable:w})},[y,w,b,g,I,T,R]);const te=m?Q=>{const[oe,se]=Y.current?.pointer(Q)||[0,0];m(Q,{x:oe,y:se})}:void 0,ee=p?D.useCallback((Q,oe)=>{const se=j.getState().nodeLookup.get(oe).internals.userNode;p(Q,se)},[]):void 0,K=x??_["minimap.ariaLabel"];return c.jsx(cn,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*z:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="number"?s:void 0},className:ce(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:c.jsxs("svg",{width:N,height:E,viewBox:`${W} ${F} ${U} ${J}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Z,ref:S,onClick:te,children:[K&&c.jsx("title",{id:Z,children:K}),c.jsx(Kh,{onClick:ee,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:s,nodeComponent:a}),c.jsx("path",{className:"react-flow__minimap-mask",d:`M${W-L},${F-L}h${U+L*2}v${J+L*2}h${-U-L*2}z
        M${A.x},${A.y}h${A.width}v${A.height}h${-A.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Us.displayName="MiniMap";const op=D.memo(Us),rp=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,sp={[Ke.Line]:"right",[Ke.Handle]:"bottom-right"};function ip({nodeId:e,position:t,variant:n=Ke.Handle,className:o,style:r=void 0,children:i,color:s,minWidth:a=10,minHeight:l=10,maxWidth:u=Number.MAX_VALUE,maxHeight:h=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:f,autoScale:m=!0,shouldResize:p,onResizeStart:y,onResize:w,onResizeEnd:x}){const b=ks(),g=typeof e=="string"?e:b,v=ae(),j=D.useRef(null),S=n===Ke.Handle,C=ne(D.useCallback(rp(S&&m),[S,m]),ie),A=D.useRef(null),P=t??sp[n];D.useEffect(()=>{if(!(!j.current||!g))return A.current||(A.current=Vd({domNode:j.current,nodeId:g,getStoreItems:()=>{const{nodeLookup:I,transform:T,snapGrid:R,snapToGrid:_,nodeOrigin:N,domNode:E}=v.getState();return{nodeLookup:I,transform:T,snapGrid:R,snapToGrid:_,nodeOrigin:N,paneDomNode:E}},onChange:(I,T)=>{const{triggerNodeChanges:R,nodeLookup:_,parentLookup:N,nodeOrigin:E}=v.getState(),M=[],k={x:I.x,y:I.y},z=_.get(g);if(z&&z.expandParent&&z.parentId){const $=z.origin??E,H=I.width??z.measured.width??0,L=I.height??z.measured.height??0,W={id:z.id,parentId:z.parentId,rect:{width:H,height:L,...Jr({x:I.x??z.position.x,y:I.y??z.position.y},{width:H,height:L},z.parentId,_,$)}},F=Jn([W],_,N,E);M.push(...F),k.x=I.x?Math.max($[0]*H,I.x):void 0,k.y=I.y?Math.max($[1]*L,I.y):void 0}if(k.x!==void 0&&k.y!==void 0){const $={id:g,type:"position",position:{...k}};M.push($)}if(I.width!==void 0&&I.height!==void 0){const H={id:g,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:I.width,height:I.height}};M.push(H)}for(const $ of T){const H={...$,type:"position"};M.push(H)}R(M)},onEnd:({width:I,height:T})=>{const R={id:g,type:"dimensions",resizing:!1,dimensions:{width:I,height:T}};v.getState().triggerNodeChanges([R])}})),A.current.update({controlPosition:P,boundaries:{minWidth:a,minHeight:l,maxWidth:u,maxHeight:h},keepAspectRatio:d,resizeDirection:f,onResizeStart:y,onResize:w,onResizeEnd:x,shouldResize:p}),()=>{A.current?.destroy()}},[P,a,l,u,h,d,y,w,x,p]);const V=P.split("-");return c.jsx("div",{className:ce(["react-flow__resize-control","nodrag",...V,n,o]),ref:j,style:{...r,scale:C,...s&&{[S?"backgroundColor":"borderColor"]:s}},children:i})}D.memo(ip);const ap=({data:e})=>{const[t,n]=Hn.useState(!1),o=e.deployment,r=l=>{switch(l){case"success":return"success";case"running":return"info";case"failed":return"error";case"pending":return"warning";case"cancelled":return"default";default:return"default"}},i=l=>({success:"",running:"",failed:"",pending:"",cancelled:""})[l]||l,s=()=>{if(!o.jenkins_job||!o.jenkins_server_url)return null;const l=o.jenkins_server_url.replace(/\/$/,"");return o.jenkins_build_number?`${l}/job/${o.jenkins_job}/${o.jenkins_build_number}`:`${l}/job/${o.jenkins_job}`},a=()=>!o.jenkins_job||!o.jenkins_server_url||!o.jenkins_build_number?null:`${o.jenkins_server_url.replace(/\/$/,"")}/job/${o.jenkins_job}/${o.jenkins_build_number}/console`;return c.jsxs(c.Fragment,{children:[c.jsx(Qe,{type:"target",position:X.Left,style:{background:"#555"}}),c.jsx(at,{sx:{minWidth:280,maxWidth:320,border:`2px solid ${o.status==="success"?"#4caf50":o.status==="failed"?"#f44336":o.status==="running"?"#2196f3":"#ff9800"}`,borderRadius:2,boxShadow:3},children:c.jsxs(ct,{sx:{p:2,"&:last-child":{pb:2}},children:[c.jsxs(q,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1.5},children:[c.jsx(O,{variant:"h6",fontWeight:600,sx:{fontSize:"1rem"},children:o.project_name}),c.jsx(de,{label:i(o.status),color:r(o.status),size:"small",sx:{height:24}})]}),o.env_name&&c.jsxs(O,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:[": ",o.env_name]}),o.version&&c.jsxs(O,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:[": ",o.version]}),o.jenkins_job&&c.jsxs(O,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1},children:["Job: ",o.jenkins_job,o.jenkins_build_number&&` #${o.jenkins_build_number}`]}),c.jsx(En,{sx:{my:1}}),c.jsxs(q,{sx:{display:"flex",gap:.5,justifyContent:"flex-end"},children:[s()&&c.jsx(pn,{title:"Jenkins",children:c.jsx(gn,{size:"small",onClick:()=>{const l=s();l&&window.open(l,"_blank")},sx:{p:.5},children:c.jsx(fo,{fontSize:"small"})})}),a()&&c.jsx(pn,{title:"Jenkins",children:c.jsx(gn,{size:"small",onClick:()=>{const l=a();l&&window.open(l,"_blank")},sx:{p:.5},children:c.jsx(ho,{fontSize:"small"})})}),c.jsx(pn,{title:"",children:c.jsx(gn,{size:"small",onClick:()=>n(!0),sx:{p:.5},children:c.jsx(ea,{fontSize:"small"})})})]})]})}),c.jsx(Qe,{type:"source",position:X.Right,style:{background:"#555"}}),c.jsxs(ta,{open:t,onClose:()=>n(!1),maxWidth:"md",fullWidth:!0,children:[c.jsxs(na,{children:[" - ",o.project_name]}),c.jsx(oa,{children:c.jsxs(ue,{container:!0,spacing:2,sx:{mt:1},children:[c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:"ID"}),c.jsx(O,{variant:"body2",children:o.id})]}),c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(q,{children:c.jsx(de,{label:i(o.status),color:r(o.status),size:"small"})})]}),c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:o.project_name})]}),o.env_name&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:o.env_name})]}),o.cluster_name&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:o.cluster_name})]}),o.namespace&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:o.namespace})]}),o.version&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:o.version})]}),o.deploy_type&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:o.deploy_type.toUpperCase()})]}),o.jenkins_job&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:"Jenkins Job"}),c.jsxs(O,{variant:"body2",children:[o.jenkins_job,o.jenkins_build_number&&` #${o.jenkins_build_number}`]})]}),o.created_by_name&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:o.created_by_name})]}),o.created_at&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:new Date(o.created_at).toLocaleString("zh-CN")})]}),o.started_at&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:new Date(o.started_at).toLocaleString("zh-CN")})]}),o.completed_at&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:new Date(o.completed_at).toLocaleString("zh-CN")})]}),o.duration&&c.jsxs(ue,{item:!0,xs:12,sm:6,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsxs(O,{variant:"body2",children:[o.duration," "]})]}),o.description&&c.jsxs(ue,{item:!0,xs:12,children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body2",children:o.description})]})]})}),c.jsxs(ra,{children:[s()&&c.jsx(Fe,{onClick:()=>{const l=s();l&&window.open(l,"_blank")},startIcon:c.jsx(fo,{}),children:"Jenkins"}),a()&&c.jsx(Fe,{onClick:()=>{const l=a();l&&window.open(l,"_blank")},startIcon:c.jsx(ho,{}),children:""}),c.jsx(Fe,{onClick:()=>n(!1),children:""})]})]})]})},cp={deployment:ap};function lp({deployments:e}){Hn.useEffect(()=>{console.log("DeploymentFlow deployments:",e),console.log("deployments :",e?.length||0)},[e]);const{nodes:t,edges:n}=D.useMemo(()=>{if(console.log("deployments:",e),!e||e.length===0)return console.log(""),{nodes:[],edges:[]};const s=380,a=250,l=4,u=e.map((d,f)=>{const m=Math.floor(f/l),p=f%l,w=Math.min(l,e.length-m*l)*s,x=(l*s-w)/2+50;return{id:d.id,type:"deployment",position:{x:x+p*s,y:m*a+50},data:{deployment:d}}}),h=[];for(let d=0;d<u.length-1;d++)h.push({id:`e${d}-${d+1}`,source:u[d].id,target:u[d+1].id,type:"smoothstep",animated:e[d].status==="running",style:{strokeWidth:3,stroke:e[d].status==="success"?"#4caf50":e[d].status==="failed"?"#f44336":e[d].status==="running"?"#2196f3":"#ff9800"},markerEnd:{type:"arrowclosed",width:20,height:20,color:e[d].status==="success"?"#4caf50":e[d].status==="failed"?"#f44336":e[d].status==="running"?"#2196f3":"#ff9800"},labelStyle:{fill:"#666",fontWeight:500,fontSize:12}});return console.log(":",u.length,":",h.length),{nodes:u,edges:h}},[e]);if(!e||e.length===0)return c.jsxs(q,{sx:{width:"100%",height:"400px",border:"1px solid #e0e0e0",borderRadius:2,overflow:"hidden",position:"relative",backgroundColor:"#fafafa",display:"flex",alignItems:"center",justifyContent:"center"},children:[c.jsx(Ln,{children:c.jsxs(fr,{nodes:[],edges:[],fitView:!0,style:{width:"100%",height:"100%"},children:[c.jsx(hr,{color:"#e0e0e0",gap:16}),c.jsx(pr,{})]})}),c.jsx(q,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"rgba(255, 255, 255, 0.9)",padding:2,borderRadius:1,zIndex:10},children:c.jsx(O,{variant:"body2",color:"text.secondary",children:""})})]});const r=Math.ceil(e.length/4),i=Math.max(500,r*250+100);return console.log(" ReactFlow:",t.length,":",n.length),c.jsxs(q,{sx:{width:"100%",height:`${i}px`,border:"2px solid #1976d2",borderRadius:2,overflow:"hidden",position:"relative",backgroundColor:"#fafafa",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[c.jsx(Ln,{children:c.jsxs(fr,{nodes:t,edges:n,nodeTypes:cp,fitView:!0,fitViewOptions:{padding:.3,maxZoom:1.5,minZoom:.5},panOnScroll:!0,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!0,selectNodesOnDrag:!1,style:{width:"100%",height:"100%"},defaultEdgeOptions:{type:"smoothstep",style:{strokeWidth:3}},children:[c.jsx(hr,{color:"#e0e0e0",gap:16,size:1}),c.jsx(pr,{showInteractive:!1}),c.jsx(op,{nodeColor:s=>{const a=s.data?.deployment;if(!a)return"#ccc";switch(a.status){case"success":return"#4caf50";case"failed":return"#f44336";case"running":return"#2196f3";case"pending":return"#ff9800";default:return"#ccc"}},style:{backgroundColor:"#fff",border:"1px solid #ddd"},nodeStrokeWidth:3,pannable:!0,zoomable:!0})]})}),!1]})}const up=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:i,...s}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Ft,{...s,style:{...s.style&&typeof s.style=="object"?s.style:{},width:"100%"}})})},dp=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:i,...s}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Ft.TextArea,{...s,style:{...s.style&&typeof s.style=="object"?s.style:{},width:"100%"}})})},gr=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:i,...s}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Ma,{...s,style:{...s.style&&typeof s.style=="object"?s.style:{},width:"100%"}})})},mr=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:i,...s}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Na,{...s,style:{...s.style&&typeof s.style=="object"?s.style:{},width:"100%"}})})},fp=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:i,...s}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(Ia,{...s,style:{...s.style&&typeof s.style=="object"?s.style:{},width:"100%"}})})},hp=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:i,...s}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(jn,{...s,style:{...s.style&&typeof s.style=="object"?s.style:{},width:"100%"}})})},pp=e=>{const n=Le()?.componentProps?.size||e.size||200,r=`${typeof n=="number"?n:parseInt(String(n))||200}px`,{size:i,...s}=e;return c.jsx("div",{style:{width:r,maxWidth:r},children:c.jsx(ka,{...s,style:{...s.style&&typeof s.style=="object"?s.style:{},width:"100%"}})})},gp=va({components:{FormItem:xo,Input:up,TextArea:dp,Password:fp,Select:gr,FormilySelect:gr,DatePicker:hp,TimePicker:pp,DateRangePicker:jn.RangePicker||jn,NumberPicker:mr,InputNumber:mr,Switch:Ca,CheckboxGroup:ba.Group,RadioGroup:_a.Group,Slider:Ft,Rate:Ft,Upload:ja,FormLayout:Ea,FormGrid:Sa,Field:xo}});function Rt(e){const{children:t,value:n,index:o,...r}=e;return c.jsx("div",{role:"tabpanel",hidden:n!==o,id:`ticket-tabpanel-${o}`,"aria-labelledby":`ticket-tab-${o}`,...r,children:n===o&&c.jsx(q,{sx:{py:2},children:t})})}function Ep(){const{id:e}=sa(),t=ia(),n=aa(),[o,r]=D.useState(null),[i,s]=D.useState(!0),[a]=D.useState(()=>ya({readOnly:!0})),[l,u]=D.useState(0),d=(()=>{if(n.state?.from)return n.state.from;const p=document.referrer;if(p){if(p.includes("/daily-workorders")||p.includes("/fill-ticket-form"))return"/daily-workorders";if(p.includes("/my-tickets"))return"/my-tickets";if(p.includes("/all-tickets"))return"/all-tickets"}const y=sessionStorage.getItem("ticket_detail_from");return y||"/my-tickets"})();D.useEffect(()=>{d&&sessionStorage.setItem("ticket_detail_from",d)},[d]);const f=D.useCallback(async()=>{if(e)try{s(!0);const p=await ga.get(Number(e));p.data.code===0?(console.log(":",p.data.data),console.log(":",p.data.data.deployments),console.log(":",p.data.data.deployments?.length||0),console.log("ID:",p.data.data.approval_instance_id),console.log("ID:",p.data.data.deployment_id),console.log(":",p.data.data.form_data),r(p.data.data),p.data.data.form_data&&a.setValues(p.data.data.form_data)):(po(""),t("/my-tickets"))}catch(p){const y=p;console.error(":",p),po(y?.response?.data?.message||""),t("/my-tickets")}finally{s(!1)}},[e,t,a]);D.useEffect(()=>{e&&f()},[e,f]);const m=()=>{if(!o?.form_data)return[];const p=o.form_data,y=[];if(p.steps&&Array.isArray(p.steps)&&p.steps.forEach((w,x)=>{const b=w.func_kwargs_json||{},g=String(b.application_name||b.service_name||b.project_name||""),v=String(b.application_id||b.service_id||b.project_id||"");g&&y.push({id:v||`step-${x}`,name:g,env_name:b.env_name?String(b.env_name):w.env_name?String(w.env_name):void 0,env_id:b.env_id?String(b.env_id):w.env_id?String(w.env_id):void 0,step_type:w.step_type?String(w.step_type):void 0,step_name:w.step_name?String(w.step_name):void 0,version:b.version?String(b.version):w.version?String(w.version):void 0})}),y.length===0){const w=String(p.application_name||p.service_name||p.project_name||"");w&&y.push({id:String(p.application_id||p.service_id||p.project_id||"1"),name:w,env_name:p.env_name?String(p.env_name):void 0,env_id:p.env_id?String(p.env_id):void 0})}return y};return i?c.jsx(q,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:c.jsx(ca,{})}):o?c.jsxs(q,{sx:{p:3,width:"100%"},children:[c.jsxs(q,{sx:{display:"flex",alignItems:"center",mb:3},children:[c.jsx(Fe,{startIcon:c.jsx(la,{}),onClick:()=>t(d),sx:{mr:2},children:""}),c.jsx(O,{variant:"h4",component:"h1",children:""})]}),c.jsxs(q,{sx:{width:"100%"},children:[c.jsx(q,{sx:{mb:2},children:c.jsx(de,{label:o.type==="deployment"?"":"",color:o.type==="deployment"?"primary":"default",variant:"outlined",sx:{fontWeight:600}})}),o.type==="deployment"&&c.jsx(at,{sx:{width:"100%",mb:3},children:c.jsxs(ct,{sx:{p:4,width:"100%",boxSizing:"border-box"},children:[c.jsxs(q,{sx:{mb:3},children:[c.jsx(O,{variant:"h5",fontWeight:600,gutterBottom:!0,children:""}),c.jsxs(O,{variant:"body2",color:"text.secondary",children:[new Date(o.created_at).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}),"  1 "]})]}),c.jsx(q,{sx:{position:"relative",mt:4,width:"100%"},children:c.jsxs(q,{sx:{display:"flex",justifyContent:"space-between",position:"relative",zIndex:1,width:"100%",gap:6},children:[c.jsxs(q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(q,{sx:{position:"absolute",top:20,left:"calc(50% + 20px)",width:"calc(100% + 48px)",height:3,backgroundColor:"#e91e63",zIndex:0}}),c.jsx(q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:"#e91e63",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(O,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),c.jsx(O,{variant:"caption",color:"text.secondary",children:o.applicant_name}),c.jsx(O,{variant:"caption",color:"text.secondary",children:new Date(o.created_at).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),c.jsxs(q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(q,{sx:{position:"absolute",top:20,left:"calc(50% + 20px)",width:"calc(100% + 48px)",height:3,backgroundColor:o.status!=="draft"?"#e91e63":"#e0e0e0",zIndex:0}}),c.jsx(q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:o.status!=="draft"?"#e91e63":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(O,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),c.jsx(O,{variant:"caption",color:"text.secondary",children:o.status==="draft"?"":""})]}),c.jsxs(q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(q,{sx:{position:"absolute",top:20,left:"calc(50% + 20px)",width:"calc(100% + 48px)",height:3,backgroundColor:o.approval_status==="approved"||o.status==="approved"?"#e91e63":o.approval_status==="rejected"||o.status==="rejected"?"#f44336":o.status==="submitted"?"#e91e63":"#e0e0e0",zIndex:0}}),c.jsx(q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:o.approval_status==="approved"||o.status==="approved"?"#e91e63":o.approval_status==="rejected"||o.status==="rejected"?"#f44336":o.status==="submitted"?"#e91e63":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(O,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),o.approval_status==="pending"||o.status==="submitted"&&!o.approval_status?c.jsx(O,{variant:"caption",color:"text.secondary",children:""}):o.approval_status==="approved"||o.status==="approved"?c.jsx(O,{variant:"caption",color:"text.secondary",children:o.approvers&&Array.isArray(o.approvers)?o.approvers.join(""):""}):o.approval_status==="rejected"||o.status==="rejected"?c.jsx(O,{variant:"caption",color:"error",children:""}):c.jsx(O,{variant:"caption",color:"text.secondary",children:""})]}),c.jsxs(q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(q,{sx:{position:"absolute",top:20,left:"calc(50% + 20px)",width:"calc(100% + 48px)",height:3,backgroundColor:o.deployment_status==="success"?"#e91e63":o.deployment_status==="running"?"#2196f3":o.deployment_status==="failed"?"#f44336":o.approval_status==="approved"||o.status==="approved"?"#e91e63":"#e0e0e0",zIndex:0}}),c.jsx(q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:o.deployment_status==="success"?"#e91e63":o.deployment_status==="running"?"#2196f3":o.deployment_status==="failed"?"#f44336":o.approval_status==="approved"||o.status==="approved"?"#e91e63":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(O,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),o.deployments&&o.deployments.length>0?c.jsxs(O,{variant:"caption",color:"text.secondary",children:[o.deployments.length," "]}):o.deployment_status?c.jsx(O,{variant:"caption",color:"text.secondary",children:o.deployment_status==="success"?"":o.deployment_status==="running"?"":o.deployment_status==="failed"?"":""}):c.jsx(O,{variant:"caption",color:"text.secondary",children:""})]}),c.jsxs(q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,minWidth:0,position:"relative"},children:[c.jsx(q,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:o.deployment_status==="success"&&o.status==="approved"?"#e91e63":"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",position:"relative",zIndex:1}}),c.jsx(O,{variant:"body2",fontWeight:500,sx:{mt:1.5,mb:.5},children:""}),c.jsx(O,{variant:"caption",color:"text.secondary",children:o.deployment_status==="success"?"":""})]})]})})]})}),o.type==="daily"&&o.template&&o.template.schema&&c.jsx(at,{sx:{width:"100%",mb:3},children:c.jsxs(ct,{children:[c.jsx(O,{variant:"h6",gutterBottom:!0,children:""}),c.jsx(En,{sx:{mb:2}}),c.jsx(rt,{sx:{p:3},children:c.jsx(wa,{form:a,children:c.jsx(gp,{schema:o.template.schema})})})]})}),o.type==="deployment"&&c.jsx(at,{sx:{width:"100%",mb:3},children:c.jsxs(ct,{sx:{p:0,width:"100%"},children:[c.jsx(q,{sx:{borderBottom:1,borderColor:"divider"},children:c.jsxs(ua,{value:l,onChange:(p,y)=>u(y),sx:{px:3,"& .MuiTab-root":{textTransform:"none",minHeight:64,px:3,mx:1}},children:[o.type==="deployment"&&c.jsxs(c.Fragment,{children:[c.jsx(jt,{icon:c.jsx(da,{}),iconPosition:"start",label:""}),c.jsx(jt,{icon:c.jsx(fa,{}),iconPosition:"start",label:""}),c.jsx(jt,{icon:c.jsx(ha,{}),iconPosition:"start",label:""})]}),c.jsx(jt,{icon:c.jsx(pa,{}),iconPosition:"start",label:""})]})}),o.type==="deployment"&&c.jsx(Rt,{value:l,index:0,children:c.jsx(q,{sx:{px:3},children:(()=>{const p=m(),y=o.deployments||[],w=p.map(x=>{const b=y.find(g=>{const v=g;return v.project_name===x.name||v.project_name===x.step_name});return{...x,deployment:b}});return y.forEach(x=>{const b=x;w.some(v=>v.deployment?.id===x.id||v.name===b.project_name)||w.push({id:String(x.id||""),name:b.project_name||"",env_name:b.env_name,env_id:b.env_id,deployment:x})}),w.length>0?c.jsx(Ct,{children:c.jsxs(Nt,{children:[c.jsx(kt,{children:c.jsxs(Ce,{children:[c.jsx(G,{children:""}),c.jsx(G,{children:""}),c.jsx(G,{children:""}),c.jsx(G,{children:""}),c.jsx(G,{children:""}),c.jsx(G,{children:""}),c.jsx(G,{children:""})]})}),c.jsx(Mt,{children:w.map((x,b)=>c.jsxs(Ce,{children:[c.jsx(G,{children:c.jsx(O,{variant:"body2",fontWeight:500,children:x.name})}),c.jsx(G,{children:String(x.env_name||x.deployment?.env_name||"-")}),c.jsx(G,{children:String(x.deployment?.version||x.version||"-")}),c.jsx(G,{children:x.deployment?c.jsx(de,{label:x.deployment.status==="success"?"":x.deployment.status==="running"?"":x.deployment.status==="failed"?"":x.deployment.status==="pending"?"":x.deployment.status,color:x.deployment.status==="success"?"success":x.deployment.status==="running"?"info":x.deployment.status==="failed"?"error":"warning",size:"small"}):c.jsx(de,{label:"",color:"default",size:"small"})}),c.jsx(G,{children:x.deployment?.deploy_type==="jenkins"?"Jenkins":x.deployment?.deploy_type==="k8s"||x.step_type==="deploy_k8s"?"K8s":x.step_type==="project"?"":x.step_type||"-"}),c.jsx(G,{children:x.step_type==="deploy_k8s"?"K8s":x.step_type==="project"?"":x.step_type==="sql"?"SQL":x.step_type||"-"}),c.jsx(G,{children:x.deployment?.created_at?new Date(x.deployment.created_at).toLocaleString("zh-CN"):o.created_at?new Date(o.created_at).toLocaleString("zh-CN"):"-"})]},x.id||`service-${b}`))})]})}):c.jsx(ot,{severity:"info",children:""})})()})}),c.jsx(Rt,{value:l,index:o.type==="deployment"?1:0,children:c.jsxs(q,{sx:{px:3},children:[c.jsxs(q,{sx:{mb:3},children:[c.jsx(O,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(q,{sx:{mt:1},children:c.jsx(de,{label:o.approval_status==="approved"||o.status==="approved"?"":o.approval_status==="rejected"||o.status==="rejected"?"":o.approval_status==="pending"||o.status==="submitted"?"":"",color:o.approval_status==="approved"||o.status==="approved"?"success":o.approval_status==="rejected"||o.status==="rejected"?"error":o.approval_status==="pending"||o.status==="submitted"?"info":"default",size:"medium"})})]}),o.approvers&&Array.isArray(o.approvers)&&o.approvers.length>0&&c.jsxs(q,{sx:{mb:3},children:[c.jsx(O,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(q,{sx:{mt:1,display:"flex",flexWrap:"wrap",gap:1},children:o.approvers.map((p,y)=>c.jsx(de,{label:p,size:"small"},y))})]}),o.current_approver&&c.jsxs(q,{sx:{mb:3},children:[c.jsx(O,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(O,{variant:"body1",sx:{mt:1},children:o.current_approver})]}),o.approval_steps&&Array.isArray(o.approval_steps)&&o.approval_steps.length>0&&c.jsxs(q,{sx:{mb:3},children:[c.jsx(O,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(Ct,{component:rt,variant:"outlined",children:c.jsxs(Nt,{size:"small",children:[c.jsx(kt,{children:c.jsxs(Ce,{children:[c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""})]})}),c.jsx(Mt,{children:o.approval_steps.map((p,y)=>c.jsxs(Ce,{children:[c.jsxs(G,{align:"center",children:[" ",y+1]}),c.jsx(G,{align:"center",children:p.approver||p.approver_name||"-"}),c.jsx(G,{align:"center",children:c.jsx(de,{label:p.status==="approved"?"":p.status==="rejected"?"":p.status==="pending"?"":p.status||"-",color:p.status==="approved"?"success":p.status==="rejected"?"error":"default",size:"small"})}),c.jsx(G,{align:"center",children:p.comment||p.remark||"-"})]},y))})]})})]}),o.approval_comment&&c.jsxs(q,{children:[c.jsx(O,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(rt,{sx:{p:2,mt:1,bgcolor:"background.default"},children:c.jsx(O,{variant:"body2",children:o.approval_comment})})]}),!o.approval_steps&&!o.approval_comment&&!o.approvers&&c.jsx(ot,{severity:"info",children:""})]})}),o.type==="deployment"&&c.jsx(Rt,{value:l,index:2,children:c.jsx(q,{sx:{px:3},children:o.deployments&&o.deployments.length>0?c.jsxs(c.Fragment,{children:[c.jsxs(q,{sx:{mb:3},children:[c.jsx(O,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(q,{sx:{mt:2,width:"100%",overflow:"hidden"},children:c.jsx(lp,{deployments:o.deployments})})]}),c.jsxs(q,{children:[c.jsx(O,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:""}),c.jsx(Ct,{component:rt,variant:"outlined",sx:{mt:2},children:c.jsxs(Nt,{children:[c.jsx(kt,{children:c.jsxs(Ce,{children:[c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""})]})}),c.jsx(Mt,{children:o.deployments.map(p=>{const y=p;return c.jsxs(Ce,{children:[c.jsx(G,{align:"center",children:c.jsx(O,{variant:"body2",fontWeight:500,children:y.project_name||"-"})}),c.jsx(G,{align:"center",children:y.env_name||"-"}),c.jsx(G,{align:"center",children:y.version||"-"}),c.jsx(G,{align:"center",children:c.jsx(de,{label:y.deploy_type==="jenkins"?"Jenkins":y.deploy_type==="k8s"?"K8s":y.deploy_type||"",size:"small",color:y.deploy_type==="jenkins"?"primary":"default"})}),c.jsx(G,{align:"center",children:c.jsx(de,{label:y.status==="success"?"":y.status==="running"?"":y.status==="failed"?"":y.status==="pending"?"":y.status||"-",color:y.status==="success"?"success":y.status==="running"?"info":y.status==="failed"?"error":"warning",size:"small"})}),c.jsx(G,{align:"center",children:y.started_at?new Date(y.started_at).toLocaleString("zh-CN"):"-"}),c.jsx(G,{align:"center",children:y.completed_at?new Date(y.completed_at).toLocaleString("zh-CN"):"-"}),c.jsx(G,{align:"center",children:y.duration?`${y.duration} `:"-"})]},p.id)})})]})})]})]}):c.jsx(ot,{severity:"info",children:""})})}),o.type==="deployment"&&c.jsx(Rt,{value:l,index:3,children:c.jsx(q,{sx:{px:3},children:o.deployments&&o.deployments.length>0?c.jsx(Ct,{component:rt,variant:"outlined",children:c.jsxs(Nt,{children:[c.jsx(kt,{children:c.jsxs(Ce,{children:[c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""}),c.jsx(G,{align:"center",children:""})]})}),c.jsx(Mt,{children:o.deployments.map(p=>{const y=p;return c.jsxs(Ce,{children:[c.jsx(G,{align:"center",children:c.jsx(O,{variant:"body2",fontWeight:500,children:y.project_name||"-"})}),c.jsx(G,{align:"center",children:y.version||"-"}),c.jsx(G,{align:"center",children:c.jsx(de,{label:"",size:"small",color:"primary",variant:"outlined"})}),c.jsx(G,{align:"center",children:y.env_name||"-"}),c.jsx(G,{align:"center",children:c.jsx(de,{label:"",color:"default",size:"small"})}),c.jsx(G,{align:"center",children:c.jsx(Fe,{variant:"outlined",size:"small",color:"warning",disabled:y.status!=="success",children:""})})]},p.id)})})]})}):c.jsx(ot,{severity:"info",children:""})})})]})}),(o.approval_steps||o.approval_result||o.approval_comment)&&c.jsx(at,{sx:{width:"100%"},children:c.jsxs(ct,{children:[c.jsx(O,{variant:"h6",gutterBottom:!0,children:""}),c.jsx(En,{sx:{mb:2}}),o.approval_result&&c.jsxs(q,{sx:{mb:2},children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(q,{children:c.jsx(de,{label:o.approval_result==="approved"?"":o.approval_result==="rejected"?"":o.approval_result,color:o.approval_result==="approved"?"success":o.approval_result==="rejected"?"error":"default",size:"small"})})]}),o.approval_comment&&c.jsxs(q,{sx:{mb:2},children:[c.jsx(O,{variant:"caption",color:"text.secondary",children:""}),c.jsx(O,{variant:"body1",children:o.approval_comment})]}),o.approval_steps&&Array.isArray(o.approval_steps)&&o.approval_steps.length>0&&c.jsxs(q,{children:[c.jsx(O,{variant:"caption",color:"text.secondary",sx:{mb:1,display:"block"},children:""}),o.approval_steps.map((p,y)=>c.jsxs(q,{sx:{mb:1,p:1,bgcolor:"background.default",borderRadius:1},children:[c.jsxs(O,{variant:"body2",children:[" ",y+1,": ",p.step_name||p.name||"-"]}),p.comment&&c.jsxs(O,{variant:"caption",color:"text.secondary",children:[": ",p.comment]})]},y))]})]})})]})]}):c.jsxs(q,{sx:{p:3},children:[c.jsx(ot,{severity:"error",children:""}),c.jsx(Fe,{sx:{mt:2},onClick:()=>t("/my-tickets"),children:""})]})}export{Ep as default};

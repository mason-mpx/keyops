import{r,bf as v,j as s,B as g,C as A,T as i,b as f,F as S,n as I,o as E,M,bi as L}from"./index-Cih9_E47.js";import{k}from"./k8sClusterApi-B1gmk072.js";function H({value:n,onChange:a,required:j=!0,label:o="选择集群",size:l="small",fullWidth:C=!0}){const[c,x]=r.useState([]),[b,d]=r.useState(!1),[u,m]=r.useState(null),p=r.useCallback(async()=>{try{d(!0),m(null);const e=await k.listClusters(),t=Array.isArray(e)?e:[];x(t),t.length===1&&!n&&a(t[0].id)}catch(e){const y=e?.response?.data?.message||"获取集群列表失败";m(y),v(y),x([])}finally{d(!1)}},[n,a]);if(r.useEffect(()=>{p()},[p]),b)return s.jsxs(g,{display:"flex",alignItems:"center",gap:1,children:[s.jsx(A,{size:20}),s.jsx(i,{variant:"body2",color:"text.secondary",children:"加载集群列表..."})]});if(u)return s.jsx(f,{severity:"error",sx:{mb:2},children:u});const h=Array.isArray(c)?c:[];return h.length===0?s.jsx(f,{severity:"warning",sx:{mb:2},children:"您没有可访问的集群，请联系管理员分配权限"}):s.jsxs(S,{size:l,fullWidth:C,required:j,sx:{"& .MuiInputBase-root":{height:l==="medium"?"56px":"40px"}},children:[s.jsx(I,{children:o}),s.jsx(E,{value:n||"",label:o,onChange:e=>a(e.target.value),startAdornment:s.jsx(L,{sx:{mr:1,color:"text.secondary",fontSize:"1.2rem"}}),sx:{"& .MuiSelect-select":{display:"flex",alignItems:"center",minHeight:"unset",height:"100%"}},children:h.map(e=>s.jsx(M,{value:e.id,sx:{py:1},children:s.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:.25},children:[s.jsx(i,{variant:"body2",sx:{lineHeight:1.2},children:e.name}),e.environment&&s.jsxs(i,{variant:"caption",color:"text.secondary",sx:{lineHeight:1.2},children:[e.environment.toUpperCase()," · ",e.region||"N/A"]})]})},e.id))})]})}export{H as C};

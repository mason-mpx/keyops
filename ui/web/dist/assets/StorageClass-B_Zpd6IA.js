import{u as T,r as t,bf as m,j as e,B as o,T as p,I as C,v as I,w as y,x as b,b as B,C as E,a as W,ci as Y,cj as z}from"./index-Cih9_E47.js";import{g as D}from"./yaml-QAtnNmSC.js";import{C as P}from"./ClusterSelector-DNhvsi-8.js";import{Y as R}from"./YamlViewerDialog-GsnPY0Cp.js";import{T as V,a as M,b as A,c as j,d as l,e as L}from"./TableRow-Bl_73t-R.js";import{C as N}from"./Chip-D6-9bdkU.js";import"./k8sClusterApi-B1gmk072.js";function K(){const{t:a}=T(),[h,u]=t.useState(!1),[g,f]=t.useState([]),[r,S]=t.useState(""),[k,i]=t.useState(!1),[c,d]=t.useState(null),x=t.useCallback(async()=>{if(!r){m("请先选择集群");return}try{u(!0),f([])}catch(s){const n=(s&&typeof s=="object"&&"response"in s&&s.response&&typeof s.response=="object"&&"data"in s.response&&s.response.data&&typeof s.response.data=="object"&&"message"in s.response.data&&typeof s.response.data.message=="string"?s.response.data.message:null)||"获取StorageClass列表失败";m(n),s&&typeof s=="object"&&"response"in s&&s.response&&typeof s.response=="object"&&"status"in s.response&&s.response.status===403&&f([])}finally{u(!1)}},[r]);return t.useEffect(()=>{r&&x()},[r,x]),e.jsxs(o,{sx:{width:"100%",p:3},children:[e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexWrap:"wrap",gap:2,children:[e.jsxs(o,{children:[e.jsx(p,{variant:"h4",component:"h1",fontWeight:"700",children:a("k8s.storageClass.title","StorageClass 管理")}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:a("k8s.storageClass.subtitle","管理存储类（Storage Class）")})]}),e.jsx(C,{onClick:x,disabled:!r||h,title:a("common.refresh"),children:e.jsx(I,{})})]}),e.jsx(y,{sx:{mb:3},children:e.jsx(b,{children:e.jsx(o,{display:"flex",gap:2,alignItems:"flex-end",flexWrap:"wrap",children:e.jsx(o,{sx:{minWidth:{xs:"100%",sm:"220px"},maxWidth:{xs:"100%",sm:"220px"}},children:e.jsx(P,{value:r,onChange:S,size:"medium",fullWidth:!0,label:a("k8s.selectCluster")})})})})}),r?h?e.jsx(o,{display:"flex",justifyContent:"center",p:3,children:e.jsx(E,{})}):e.jsx(y,{children:e.jsx(b,{children:e.jsx(V,{children:e.jsxs(M,{children:[e.jsx(A,{children:e.jsxs(j,{children:[e.jsx(l,{children:a("k8s.storageClass.name","名称")}),e.jsx(l,{children:a("k8s.storageClass.provisioner","Provisioner")}),e.jsx(l,{children:a("k8s.storageClass.reclaimPolicy","回收策略")}),e.jsx(l,{children:a("k8s.storageClass.volumeBindingMode","卷绑定模式")}),e.jsx(l,{children:a("k8s.storageClass.allowVolumeExpansion","允许扩容")}),e.jsx(l,{children:a("k8s.storageClass.age","运行时间")}),e.jsx(l,{children:a("common.actions")})]})}),e.jsx(L,{children:g.length===0?e.jsx(j,{children:e.jsx(l,{colSpan:7,align:"center",children:e.jsx(p,{color:"textSecondary",children:a("common.noData")})})}):g.map((s,n)=>e.jsxs(j,{children:[e.jsx(l,{children:s.name}),e.jsx(l,{children:s.provisioner}),e.jsx(l,{children:s.reclaimPolicy}),e.jsx(l,{children:s.volumeBindingMode}),e.jsx(l,{children:e.jsx(N,{label:s.allowVolumeExpansion?a("common.yes","是"):a("common.no","否"),color:s.allowVolumeExpansion?"success":"default",size:"small"})}),e.jsx(l,{children:s.age||"N/A"}),e.jsx(l,{children:e.jsxs(o,{display:"flex",gap:.5,children:[e.jsx(W,{size:"small",variant:"outlined",startIcon:e.jsx(Y,{}),onClick:()=>{if(!r){m("请先选择集群");return}d(s),i(!0)},disabled:!r,children:a("k8s.viewDetails","详情")}),e.jsx(C,{size:"small",onClick:()=>{d(s),i(!0)},title:a("k8s.viewYaml"),children:e.jsx(z,{fontSize:"small"})})]})})]},n))})]})})})}):e.jsx(B,{severity:"info",children:a("k8s.selectClusterFirst")}),c&&e.jsx(R,{open:k,onClose:()=>{i(!1),d(null)},title:`StorageClass - ${c.name}`,clusterId:r,namespace:"",resourceType:"storageclass",resourceName:c.name,onLoadYaml:async(s,n,w,v)=>await D({clusterId:s,namespace:""},w,v)})]})}export{K as default};

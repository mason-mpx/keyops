import{u as W,r,j as e,B as x,w as B,x as A,T as v,a as o,v as H,A as O,C as P,P as R,d as T,I as D,g as F,h as q,i as L,k as G,l as J,m as p,p as K,bf as d,a7 as w}from"./index-STo1oTDL.js";import{S as j}from"./Stack-BJqE2zD7.js";import{T as N,a as Q,b as U,c as m,d as l,e as V}from"./TableRow-e9fRaRV7.js";import{C as S}from"./Chip-v5QMYL72.js";import{f as X}from"./index-CEYi4unC.js";import"./typeof-QjJsDpFa.js";function ae(){const{t:_}=W(),[u,I]=r.useState([]),[y,g]=r.useState(!1),[k,f]=r.useState(!1),[C,c]=r.useState(null),[a,n]=r.useState({name:"",description:"",deploy_type:""}),i=async()=>{g(!0);try{I([])}catch(s){const t=s?.message||"加载配置失败";d(t)}finally{g(!1)}};r.useEffect(()=>{i()},[]);const b=s=>{s?(c(s),n({name:s.name||"",description:s.description||"",deploy_type:s.deploy_type||""})):(c(null),n({name:"",description:"",deploy_type:""})),f(!0)},h=()=>{f(!1),c(null),n({name:"",description:"",deploy_type:""})},M=async()=>{try{if(!a.name.trim()){d("请输入配置名称");return}w(C?"更新成功":"创建成功"),h(),i()}catch(s){const t=s?.message||"保存失败";d(t)}},z=async s=>{if(console.log("handleDelete",s),!!window.confirm("确定要删除此配置吗？"))try{w("删除成功"),i()}catch(t){const E=t?.message||"删除失败";d(E)}};return e.jsxs(x,{sx:{width:"100%",bgcolor:"#f5f7fa",minHeight:"100vh",p:3},children:[e.jsx(B,{children:e.jsxs(A,{children:[e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(v,{variant:"h5",component:"h1",fontWeight:"600",children:_("menu.appDeployManagement")||"应用-发布"}),e.jsxs(j,{direction:"row",spacing:2,children:[e.jsx(o,{variant:"outlined",startIcon:e.jsx(H,{}),onClick:i,disabled:y,children:"刷新"}),e.jsx(o,{variant:"contained",startIcon:e.jsx(O,{}),onClick:()=>b(),children:"新增配置"})]})]}),y?e.jsx(x,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(P,{})}):e.jsx(N,{component:R,variant:"outlined",children:e.jsxs(Q,{children:[e.jsx(U,{children:e.jsxs(m,{children:[e.jsx(l,{children:"ID"}),e.jsx(l,{children:"配置名称"}),e.jsx(l,{children:"描述"}),e.jsx(l,{children:"部署类型"}),e.jsx(l,{children:"状态"}),e.jsx(l,{children:"创建时间"}),e.jsx(l,{align:"right",children:"操作"})]})}),e.jsx(V,{children:u.length===0?e.jsx(m,{children:e.jsx(l,{colSpan:7,align:"center",sx:{py:4},children:e.jsx(v,{color:"text.secondary",children:'暂无配置，点击"新增配置"创建'})})}):u.map((s,t)=>e.jsxs(m,{children:[e.jsx(l,{children:s.id}),e.jsx(l,{children:s.name}),e.jsx(l,{children:s.description||"-"}),e.jsx(l,{children:e.jsx(S,{label:s.deploy_type||"未设置",size:"small",color:s.deploy_type?"primary":"default"})}),e.jsx(l,{children:e.jsx(S,{label:s.status||"未知",size:"small",color:s.status==="active"?"success":"default"})}),e.jsx(l,{children:s.created_at?X(new Date(s.created_at),"yyyy-MM-dd HH:mm:ss"):"-"}),e.jsx(l,{align:"right",children:e.jsxs(j,{direction:"row",spacing:1,justifyContent:"flex-end",children:[e.jsx(T,{title:"编辑",children:e.jsx(D,{size:"small",onClick:()=>b(s),children:e.jsx(F,{fontSize:"small"})})}),e.jsx(T,{title:"删除",children:e.jsx(D,{size:"small",color:"error",onClick:()=>s.id&&z(s.id),children:e.jsx(q,{fontSize:"small"})})})]})})]},s.id||t))})]})})]})}),e.jsxs(L,{open:k,onClose:h,maxWidth:"md",fullWidth:!0,children:[e.jsx(G,{children:C?"编辑配置":"新增配置"}),e.jsx(J,{children:e.jsxs(j,{spacing:3,sx:{mt:1},children:[e.jsx(p,{label:"配置名称",required:!0,fullWidth:!0,value:a.name,onChange:s=>n({...a,name:s.target.value}),placeholder:"请输入配置名称"}),e.jsx(p,{label:"描述",fullWidth:!0,multiline:!0,rows:3,value:a.description,onChange:s=>n({...a,description:s.target.value}),placeholder:"请输入描述（可选）"}),e.jsx(p,{label:"部署类型",fullWidth:!0,value:a.deploy_type,onChange:s=>n({...a,deploy_type:s.target.value}),placeholder:"请输入部署类型（可选）"})]})}),e.jsxs(K,{children:[e.jsx(o,{onClick:h,children:"取消"}),e.jsx(o,{onClick:M,variant:"contained",children:"保存"})]})]})]})}export{ae as default};

import{r as h,j as t,F as B,n as I,o as k,M as d,B as F,C as R,T}from"./index-OJNN34VQ.js";import{g as C}from"./namespaces-D2j8PUT5.js";function q({value:e,onChange:n,clusterId:r,clusterName:o,allowedNamespaces:c,defaultNamespace:i,size:f="small",fullWidth:y=!0,label:g="命名空间"}){const[S,m]=h.useState([]),[j,u]=h.useState(!1),a=c&&c.length>0,p=a?c:S;h.useEffect(()=>{i&&!e&&n(i)},[i,e]),h.useEffect(()=>{!a&&(r||o)&&b()},[r,o,a,e,i]);const b=async()=>{try{u(!0);const s={};r?s.clusterId=r:o&&(s.clusterName=o);const x=(await C(s)).map(M=>M.name);m(x),!e&&i&&x.includes(i)?n(i):!e&&x.length>0&&n(x[0])}catch(s){console.error("获取命名空间列表失败:",s);const l=["default","kube-system","kube-public"];m(l),!e&&l.length>0&&n(l[0])}finally{u(!1)}},E={"& .MuiInputBase-root":{height:f==="medium"?"56px":"40px"}},L={"& .MuiSelect-select":{display:"flex",alignItems:"center",minHeight:"unset",height:"100%"}};return t.jsxs(B,{size:f,fullWidth:y,sx:E,children:[t.jsx(I,{children:g}),t.jsx(k,{value:e||"",label:g,onChange:s=>n(s.target.value),disabled:j||p.length===0,sx:L,children:j?t.jsx(d,{disabled:!0,children:t.jsxs(F,{display:"flex",alignItems:"center",gap:1,children:[t.jsx(R,{size:16}),t.jsx("span",{children:"加载中..."})]})}):p.length===0?t.jsx(d,{disabled:!0,children:"暂无命名空间"}):p.map(s=>t.jsx(d,{value:s,children:s},s))}),a&&c.length===1&&t.jsx(T,{variant:"caption",color:"text.secondary",sx:{mt:.5},children:"您只能访问此命名空间"})]})}export{q as N};

import{u as T,ax as w,r,bf as c,j as e,B as n,T as d,w as f,x as j,b as I,C as N,a as W,ci as E}from"./index-wVs8DYHr.js";import{k as $}from"./index-BIq8ZW4m.js";import{k as z}from"./k8sClusterApi-Bz6qMnao.js";import{C as B}from"./ClusterSelector-DqWR8dyY.js";import{N as A}from"./NamespaceSelector-BppKItkw.js";import{T as D,a as L,b as R,c as x,d as l,e as F}from"./TableRow-17IyVPm2.js";import{C as H}from"./Chip-DzNpApxT.js";import"./utils-DifSMk6h.js";import"./yaml-B1Nq9-gN.js";import"./namespaces-Biqx1aVY.js";function X(){const{t:a}=T(),S=w(),[C,m]=r.useState(!1),[u,h]=r.useState([]),[t,g]=r.useState(""),[o,b]=r.useState(""),[p,y]=r.useState(null);r.useEffect(()=>{t&&z.getCluster(t).then(y).catch(s=>{c(s?.response?.data?.message||"获取集群信息失败")})},[t]);const k=async()=>{if(!t){c("请先选择集群");return}try{m(!0);const s={clusterId:t,namespace:o||void 0},i=await $.getStatefulSetList(s);h(i)}catch(s){const i=s,v=i?.response?.data?.message||"获取StatefulSet列表失败";c(v),i?.response?.status===403&&h([])}finally{m(!1)}};return r.useEffect(()=>{t&&k()},[t,o]),e.jsxs(n,{sx:{width:"100%",p:3},children:[e.jsx(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexWrap:"wrap",gap:2,children:e.jsxs(n,{children:[e.jsx(d,{variant:"h4",component:"h1",fontWeight:"700",children:a("k8s.statefulSets.title")}),e.jsx(d,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:a("k8s.statefulSets.subtitle")})]})}),e.jsx(f,{sx:{mb:3},children:e.jsx(j,{children:e.jsxs(n,{display:"flex",gap:2,alignItems:"flex-end",flexWrap:"wrap",children:[e.jsx(n,{sx:{minWidth:{xs:"100%",sm:"220px"},maxWidth:{xs:"100%",sm:"220px"}},children:e.jsx(B,{value:t,onChange:g,size:"medium",fullWidth:!0,label:a("k8s.selectCluster")})}),t&&e.jsx(n,{sx:{minWidth:{xs:"100%",sm:"220px"},maxWidth:{xs:"100%",sm:"220px"}},children:e.jsx(A,{value:o,onChange:b,clusterId:t,allowedNamespaces:p?void 0:[],defaultNamespace:p?.defaultNamespace,size:"medium",fullWidth:!0,label:a("k8s.selectNamespace")})})]})})}),t?C?e.jsx(n,{display:"flex",justifyContent:"center",p:3,children:e.jsx(N,{})}):e.jsx(f,{children:e.jsx(j,{children:e.jsx(D,{children:e.jsxs(L,{children:[e.jsx(R,{children:e.jsxs(x,{children:[e.jsx(l,{children:a("k8s.statefulSets.name")}),e.jsx(l,{children:a("k8s.statefulSets.namespace")}),e.jsx(l,{children:a("k8s.statefulSets.ready")}),e.jsx(l,{children:a("k8s.statefulSets.age")}),e.jsx(l,{children:a("common.actions")})]})}),e.jsx(F,{children:u.length===0?e.jsx(x,{children:e.jsx(l,{colSpan:5,align:"center",children:e.jsx(d,{color:"textSecondary",children:a("common.noData")})})}):u.map(s=>e.jsxs(x,{children:[e.jsx(l,{children:s.name}),e.jsx(l,{children:s.namespace}),e.jsx(l,{children:e.jsx(H,{label:s.ready,color:s.ready>0?"success":"error",size:"small"})}),e.jsx(l,{children:s.age}),e.jsx(l,{children:e.jsx(W,{size:"small",variant:"outlined",startIcon:e.jsx(E,{}),onClick:()=>{if(!t){c("请先选择集群");return}const i=`/k8s/statefulsets/${t}/${s.namespace}/${s.name}`;S(i)},disabled:!t,children:a("k8s.viewDetails","详情")})})]},`${s.namespace}-${s.name}`))})]})})})}):e.jsx(I,{severity:"info",children:a("k8s.selectClusterFirst")})]})}export{X as default};

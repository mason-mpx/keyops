import{u as v,r as t,bf as d,j as e,B as r,T as p,I as C,v as Y,w as b,x as w,b as E,C as z,cj as B}from"./index-wVs8DYHr.js";import{k as D}from"./k8sClusterApi-Bz6qMnao.js";import{g as R}from"./yaml-B1Nq9-gN.js";import{C as A}from"./ClusterSelector-DqWR8dyY.js";import{N as L}from"./NamespaceSelector-BppKItkw.js";import{Y as O}from"./YamlViewerDialog-B73aV8Jq.js";import{T as F,a as H,b as M,c as x,d as n,e as P}from"./TableRow-17IyVPm2.js";import"./namespaces-Biqx1aVY.js";import"./utils-DifSMk6h.js";function ee(){const{t:l}=v(),[m,u]=t.useState(!1),[h,j]=t.useState([]),[a,S]=t.useState(""),[f,T]=t.useState(""),[I,k]=t.useState(null),[G,y]=t.useState(!1),[c,g]=t.useState(null);t.useEffect(()=>{a&&D.getCluster(a).then(k).catch(s=>{d(s?.response?.data?.message||"获取集群信息失败")})},[a]);const i=t.useCallback(async()=>{if(!a){d("请先选择集群");return}try{u(!0),j([])}catch(s){const o=(s&&typeof s=="object"&&"response"in s&&s.response&&typeof s.response=="object"&&"data"in s.response&&s.response.data&&typeof s.response.data=="object"&&"message"in s.response.data&&typeof s.response.data.message=="string"?s.response.data.message:null)||"获取Gateway列表失败";d(o),s&&typeof s=="object"&&"response"in s&&s.response&&typeof s.response=="object"&&"status"in s.response&&s.response.status===403&&j([])}finally{u(!1)}},[a]);return t.useEffect(()=>{a&&i()},[a,f,i]),e.jsxs(r,{sx:{width:"100%",p:3},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexWrap:"wrap",gap:2,children:[e.jsxs(r,{children:[e.jsx(p,{variant:"h4",component:"h1",fontWeight:"700",children:"Gateways管理"}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:"管理网关（Gateway）"})]}),e.jsx(C,{onClick:i,disabled:!a||m,children:e.jsx(Y,{})})]}),e.jsx(b,{sx:{mb:3},children:e.jsx(w,{children:e.jsxs(r,{display:"flex",gap:2,alignItems:"flex-end",flexWrap:"wrap",children:[e.jsx(r,{sx:{minWidth:{xs:"100%",sm:"220px"},maxWidth:{xs:"100%",sm:"220px"}},children:e.jsx(A,{value:a,onChange:S,size:"medium",fullWidth:!0,label:l("k8s.selectCluster")})}),a&&e.jsx(r,{sx:{minWidth:{xs:"100%",sm:"220px"},maxWidth:{xs:"100%",sm:"220px"}},children:e.jsx(L,{value:f,onChange:T,clusterId:a,defaultNamespace:I?.defaultNamespace,size:"medium",fullWidth:!0,label:l("k8s.selectNamespace")})})]})})}),a?m?e.jsx(r,{display:"flex",justifyContent:"center",p:3,children:e.jsx(z,{})}):e.jsx(b,{children:e.jsx(w,{children:e.jsx(F,{children:e.jsxs(H,{children:[e.jsx(M,{children:e.jsxs(x,{children:[e.jsx(n,{children:"名称"}),e.jsx(n,{children:"命名空间"}),e.jsx(n,{children:"创建时间"}),e.jsx(n,{children:l("common.actions")})]})}),e.jsx(P,{children:h.length===0?e.jsx(x,{children:e.jsx(n,{colSpan:4,align:"center",children:e.jsx(p,{color:"textSecondary",children:l("common.noData")})})}):h.map((s,o)=>e.jsxs(x,{children:[e.jsx(n,{children:s.name}),e.jsx(n,{children:s.namespace}),e.jsx(n,{children:s.age||"N/A"}),e.jsx(n,{children:e.jsx(C,{size:"small",onClick:()=>{g(s),y(!0)},title:l("k8s.viewYaml"),children:e.jsx(B,{fontSize:"small"})})})]},o))})]})})})}):e.jsx(E,{severity:"info",children:l("k8s.selectClusterFirst")}),c&&e.jsx(O,{open:G,onClose:()=>{y(!1),g(null)},title:`Gateway - ${c.name}`,clusterId:a,namespace:c.namespace,resourceType:"gateway",resourceName:c.name,onLoadYaml:async(s,o,N,W)=>await R({clusterId:s,namespace:o},N,W)})]})}export{ee as default};

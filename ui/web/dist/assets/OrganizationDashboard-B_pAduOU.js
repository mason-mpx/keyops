import{u as L,r as x,c3 as R,j as e,B as s,C as W,T as o,I as k,v as A,c4 as E,c as P,c8 as G,c9 as H,w as m,x as u}from"./index-z51Q_M-r.js";import{R as z,T as D,L as C,C as K,X as Y,Y as $}from"./CartesianChart-UrYVXqzA.js";import{P as F,a as X}from"./PieChart-B6-3f_v-.js";import{C as M}from"./tooltipContext-LzyZVOmF.js";import{B as U,a as _}from"./BarChart-CahnNwqx.js";import"./value-DaH6Zdgz.js";const v=["#667eea","#764ba2","#f093fb","#4facfe","#00f2fe"];function ee(){const{t}=L(),[T,h]=x.useState(!0),[d,w]=x.useState({total:0,active:0,departments:0,users:0}),[l,S]=x.useState([]),f=x.useCallback(async()=>{h(!0);try{const a=await R.getOrganizations({tree:!0}),I=(r=>{let i=0,b=0,j=0;const y=B=>{B.forEach(c=>{i++,c.isActive&&b++,c.unitType==="Department"&&j++,c.children&&c.children.length>0&&y(c.children)})};return y(r),{total:i,active:b,departments:j}})(a);w({...I,users:0});const p={},g=r=>{r.forEach(i=>{p[i.unitType]=(p[i.unitType]||0)+1,i.children&&i.children.length>0&&g(i.children)})};g(a);const O=Object.entries(p).map(([r,i])=>({name:t(r==="BizGroup"?"organizationDashboard.unitTypes.BizGroup":r==="LineOfBiz"?"organizationDashboard.unitTypes.LineOfBiz":r==="Site"?"organizationDashboard.unitTypes.Site":"organizationDashboard.unitTypes.Department"),value:i}));S(O),h(!1)}catch(a){console.error("Failed to load organization data:",a),h(!1)}},[t]);return x.useEffect(()=>{f()},[f]),T?e.jsx(s,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(W,{})}):e.jsxs(s,{children:[e.jsxs(s,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(o,{variant:"h4",component:"h1",children:t("organizationDashboard.title")}),e.jsx(k,{onClick:f,color:"primary",children:e.jsx(A,{})})]}),e.jsx(s,{sx:{display:"flex",gap:2.5,mb:3,flexWrap:{xs:"wrap",sm:"nowrap"}},children:[{label:t("organizationDashboard.totalOrganizations"),value:d.total,icon:E,color:"#3182ce",bg:"#ebf8ff"},{label:t("organizationDashboard.activeOrganizations"),value:d.active,icon:P,color:"#38a169",bg:"#f0fff4"},{label:t("organizationDashboard.totalDepartments"),value:d.departments,icon:G,color:"#805ad5",bg:"#faf5ff"},{label:t("organizationDashboard.totalUsers"),value:d.users,icon:H,color:"#e53e3e",bg:"#fff5f5"}].map((a,n)=>e.jsx(s,{sx:{flex:1,minWidth:{xs:"100%",sm:0}},children:e.jsx(m,{elevation:0,sx:{border:"1px solid #e2e8f0",width:"100%",height:{xs:"160px",sm:"180px"},transition:"all 0.3s ease","&:hover":{boxShadow:"0 4px 12px rgba(0,0,0,0.08)",transform:"translateY(-2px)"}},children:e.jsxs(u,{sx:{p:{xs:2.5,sm:3.5},height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",fontWeight:500,sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:a.label}),e.jsx(s,{sx:{width:{xs:40,sm:48},height:{xs:40,sm:48},borderRadius:2.5,backgroundColor:a.bg,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(a.icon,{sx:{fontSize:{xs:24,sm:28},color:a.color}})})]}),e.jsx(o,{variant:"h2",fontWeight:"700",color:"text.primary",sx:{fontSize:{xs:"2rem",sm:"3rem"}},children:a.value})]})})},n))}),e.jsx(s,{sx:{mb:3},children:e.jsx(m,{elevation:0,sx:{border:"1px solid #e2e8f0",width:"100%"},children:e.jsxs(u,{sx:{p:{xs:2,sm:3}},children:[e.jsx(o,{variant:"h6",fontWeight:"600",color:"text.primary",mb:2,sx:{fontSize:{xs:"1rem",sm:"1.25rem"}},children:t("organizationDashboard.organizationDistribution")}),l.length===0?e.jsx(s,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"300px",children:e.jsx(o,{color:"text.secondary",children:t("organizationDashboard.noData")})}):e.jsx(z,{width:"100%",height:320,children:e.jsxs(F,{children:[e.jsx(X,{data:l,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:n})=>`${a}: ${((n??0)*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:l.map((a,n)=>e.jsx(M,{fill:v[n%v.length]},`cell-${n}`))}),e.jsx(D,{}),e.jsx(C,{})]})})]})})}),e.jsx(s,{sx:{mb:3},children:e.jsx(m,{elevation:0,sx:{border:"1px solid #e2e8f0",width:"100%"},children:e.jsxs(u,{sx:{p:{xs:2,sm:3}},children:[e.jsx(o,{variant:"h6",fontWeight:"600",color:"text.primary",mb:2,sx:{fontSize:{xs:"1rem",sm:"1.25rem"}},children:t("organizationDashboard.organizationDistribution")}),l.length===0?e.jsx(s,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"300px",children:e.jsx(o,{color:"text.secondary",children:t("organizationDashboard.noData")})}):e.jsx(z,{width:"100%",height:320,children:e.jsxs(U,{data:l,children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(Y,{dataKey:"name"}),e.jsx($,{}),e.jsx(D,{}),e.jsx(C,{}),e.jsx(_,{dataKey:"value",fill:"#667eea"})]})})]})})})]})}export{ee as default};

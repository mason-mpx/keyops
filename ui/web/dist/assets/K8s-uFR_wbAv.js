import{r as a,bf as j,j as e,B as r,T as t,a as I,v as S,C as v,w as i,x as c,bi as d}from"./index-STo1oTDL.js";import{k as B}from"./index-BY4k-vmZ.js";import{k as N}from"./k8sClusterApi-7xlxICBp.js";import{C as k}from"./ClusterSelector-D_9vFdZX.js";import{N as w}from"./NamespaceSelector-4s1JeenR.js";import{G as l}from"./GridLegacy-t679NzKB.js";import"./utils-Bf2w_ouu.js";import"./yaml-CjebJvkV.js";import"./namespaces-ClIDLtp_.js";function R(){const[h,u]=a.useState(!1),[o,f]=a.useState(null),[n,y]=a.useState(""),[x,g]=a.useState(""),[C,b]=a.useState(null);a.useEffect(()=>{n&&N.getCluster(n).then(b).catch(s=>{j(s?.response?.data?.message||"获取集群信息失败")})},[n]);const m=a.useCallback(async()=>{if(!n){j("请先选择集群");return}try{u(!0);const s={clusterId:n,namespace:x||void 0},p=await B.getBaseInfo(s);f(p)}catch(s){const p=(s&&typeof s=="object"&&"response"in s&&s.response&&typeof s.response=="object"&&"data"in s.response&&s.response.data&&typeof s.response.data=="object"&&"message"in s.response.data&&typeof s.response.data.message=="string"?s.response.data.message:null)||"获取基础信息失败";j(p),s&&typeof s=="object"&&"response"in s&&s.response&&typeof s.response=="object"&&"status"in s.response&&s.response.status===403&&f(null)}finally{u(!1)}},[n,x]);return a.useEffect(()=>{n&&m()},[n,x,m]),e.jsxs(r,{sx:{width:"100%",p:3},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsxs(r,{children:[e.jsx(t,{variant:"h4",component:"h1",fontWeight:"700",children:"Kubernetes 概览"}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:"查看 Kubernetes 集群基础信息"})]}),e.jsxs(r,{display:"flex",gap:2,alignItems:"center",children:[e.jsx(k,{value:n,onChange:y,size:"small",fullWidth:!1,label:"选择集群"}),n&&e.jsx(w,{value:x,onChange:g,defaultNamespace:C?.defaultNamespace,size:"small",fullWidth:!1}),e.jsx(I,{variant:"outlined",startIcon:e.jsx(S,{}),onClick:m,disabled:h||!n,children:"刷新"})]})]}),h?e.jsx(r,{display:"flex",justifyContent:"center",p:3,children:e.jsx(v,{})}):o?e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(i,{children:e.jsxs(c,{children:[e.jsxs(r,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(d,{color:"primary"}),e.jsx(t,{color:"textSecondary",gutterBottom:!0,children:"集群名称"})]}),e.jsx(t,{variant:"h5",children:o.cluster||"N/A"})]})})}),e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(i,{children:e.jsxs(c,{children:[e.jsxs(r,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(d,{color:"primary"}),e.jsx(t,{color:"textSecondary",gutterBottom:!0,children:"命名空间"})]}),e.jsx(t,{variant:"h5",children:o.namespace||"N/A"})]})})}),e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(i,{children:e.jsxs(c,{children:[e.jsxs(r,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(d,{color:"primary"}),e.jsx(t,{color:"textSecondary",gutterBottom:!0,children:"Node 数量"})]}),e.jsx(t,{variant:"h5",children:o.nodeCount||0})]})})}),e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(i,{children:e.jsxs(c,{children:[e.jsxs(r,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(d,{color:"primary"}),e.jsx(t,{color:"textSecondary",gutterBottom:!0,children:"Pod 数量"})]}),e.jsx(t,{variant:"h5",children:o.podCount||0})]})})}),e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(i,{children:e.jsxs(c,{children:[e.jsxs(r,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(d,{color:"primary"}),e.jsx(t,{color:"textSecondary",gutterBottom:!0,children:"Service 数量"})]}),e.jsx(t,{variant:"h5",children:o.serviceCount||0})]})})}),e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(i,{children:e.jsxs(c,{children:[e.jsxs(r,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(d,{color:"primary"}),e.jsx(t,{color:"textSecondary",gutterBottom:!0,children:"Ingress 数量"})]}),e.jsx(t,{variant:"h5",children:o.ingressCount||0})]})})})]}):n?e.jsx(r,{display:"flex",justifyContent:"center",p:3,children:e.jsx(t,{color:"textSecondary",children:"暂无数据或没有访问权限"})}):e.jsx(r,{display:"flex",justifyContent:"center",p:3,children:e.jsx(t,{color:"textSecondary",children:"请先选择集群"})})]})}export{R as default};

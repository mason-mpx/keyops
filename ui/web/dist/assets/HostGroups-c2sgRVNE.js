import{u as ps,r,H as f,j as e,B as l,T as a,J as q,a as x,A as J,w as xe,x as ue,K,c as X,P as B,m as y,s as pe,t as Z,L as gs,N as ze,M as b,O as ge,I as ee,g as Ae,Q as js,h as Re,i as k,k as H,l as z,p as A,b as M,V as We,W as Te,X as Oe,y as ms,Y as Fe,D as fs}from"./index-wVs8DYHr.js";import{T as $e,a as Be,b as Me,c as se,d as c,e as Le}from"./TableRow-17IyVPm2.js";import{C as j}from"./Chip-DzNpApxT.js";import{T as je}from"./TablePagination-l3CyI5hc.js";import{S as me}from"./Stack-CNnEoVHt.js";import"./LastPage-Bx6x4Acm.js";function Ps(){const{t}=ps(),[te,Ee]=r.useState([]),[i,v]=r.useState(null),[L,Ue]=r.useState({}),[oe,Ne]=r.useState([]),[,E]=r.useState(!1),[U,Qe]=r.useState(""),[R,P]=r.useState("name"),[Ve,D]=r.useState("asc"),[fe,ne]=r.useState(0),[re,Ye]=r.useState(20),[ys]=r.useState(0),[ye,be]=r.useState(null),[w,Ce]=r.useState(null),[Ge,C]=r.useState(null),[_e,W]=r.useState(!1),[qe,N]=r.useState(!1),[Je,T]=r.useState(!1),[Ke,ae]=r.useState(!1),[ve,we]=r.useState([]),[Xe,Q]=r.useState(!1),[le,O]=r.useState(!1),[h,m]=r.useState({name:"",description:"",color:"#607d8b"}),[g,S]=r.useState([]),[F,G]=r.useState(""),[ie,p]=r.useState(0),[V,Se]=r.useState(10),I=async()=>{try{E(!0);const s=await f.get("/api/host-groups?stats=true");s.data.code===0&&Ee(s.data.data?.groups||s.data.data||[])}catch(s){console.error("Failed to load groups:",s)}finally{E(!1)}},Y=r.useCallback(async s=>{try{const o=await f.get(`/api/host-groups/${s}/hosts?pageSize=10000`);o.data.code===0&&Ue(d=>({...d,[s]:o.data.data.hosts||[]}))}catch(o){console.error("Failed to load group hosts:",o)}},[]),Ze=async()=>{try{const s=await f.get("/api/hosts?pageSize=10000");s.data.code===0&&Ne(s.data.data?.hosts||[])}catch(s){console.error("Failed to load all hosts:",s)}};r.useEffect(()=>{I(),Ze()},[]),r.useEffect(()=>{le&&i&&!L[i.id]&&Y(i.id)},[le,i,L,Y]);const es=async()=>{try{(await f.post("/api/host-groups",h)).data.code===0&&(W(!1),I(),m({name:"",description:"",color:"#607d8b"}))}catch(s){console.error("Failed to create group:",s)}},ss=async()=>{if(i){if(!h.name.trim()){alert("分组名称不能为空");return}try{const s=await f.put(`/api/host-groups/${i.id}`,h);s.data.code===0?(N(!1),I(),m({name:"",description:"",color:"#607d8b"}),i.id===s.data.data?.id&&v(s.data.data)):alert(`更新失败: ${s.data.msg||"未知错误"}`)}catch(s){console.error("Failed to update group:",s);const o=s?.response?.data?.msg||s?.message||"更新分组失败";alert(`更新失败: ${o}`)}}},ts=async()=>{if(i)try{const s=await f.delete(`/api/host-groups/${i.id}`);s.data.code===0?(Q(!1),v(null),I()):alert(`删除失败: ${s.data.msg||"未知错误"}`)}catch(s){console.error("Failed to delete group:",s);const o=s?.response?.data?.msg||s?.message||"删除分组失败";alert(`删除失败: ${o}`)}},os=async()=>{if(!(!i||g.length===0))try{const s=await f.post(`/api/host-groups/${i.id}/hosts`,{hostIds:g});s.data.code===0?(T(!1),S([]),G(""),p(0),await Y(i.id),await I(),O(!0)):alert(`添加失败: ${s.data.msg||"未知错误"}`)}catch(s){console.error("Failed to add hosts:",s);const o=s?.response?.data?.msg||s?.message||"添加主机失败";alert(`添加失败: ${o}`)}},ns=async s=>{if(i)try{const o=await f.delete(`/api/host-groups/${i.id}/hosts`,{data:{hostIds:[s]}});o.data.code===0?(await Y(i.id),await I()):alert(`删除失败: ${o.data.msg||"未知错误"}`)}catch(o){console.error("Failed to remove host:",o);const d=o?.response?.data?.msg||o?.message||"删除主机失败";alert(`删除失败: ${d}`)}},rs=(s,o)=>{s.stopPropagation(),be(s.currentTarget),Ce(o)},_=()=>{be(null),Ce(null)},as=()=>{w&&Pe(w),_()},ls=()=>{w&&(v(w),Q(!0)),_()},is=async()=>{if(w){v(w),E(!0);try{const s=await f.get(`/api/host-groups/${w.id}/users`);s.data.code===0&&(we(s.data.data.users||[]),ae(!0))}catch(s){console.error("Failed to load group users:",s),we([])}finally{E(!1)}}_()},cs=s=>{v(s),T(!0)},Pe=s=>{v(s),m({name:s.name,description:s.description,color:s.color||"#607d8b"}),N(!0)},ds=()=>{if(!i)return[];const s=L[i.id]||[],o=new Set(s.map(d=>d.id));return oe.filter(d=>!o.has(d.id))},De=()=>{let s=te;return U&&(s=s.filter(o=>o.name.toLowerCase().includes(U.toLowerCase())||o.description.toLowerCase().includes(U.toLowerCase()))),s=[...s].sort((o,d)=>{let n=o[R],u=d[R];return R==="createdAt"&&(n=new Date(n).getTime(),u=new Date(u).getTime()),Ve==="asc"?n>u?1:-1:n<u?1:-1}),s},hs=()=>{const s=De(),o=fe*re,d=o+re;return s.slice(o,d)},ce=s=>F?s.filter(o=>o.name.toLowerCase().includes(F.toLowerCase())||o.ip.includes(F)):s,Ie=s=>{const o=ce(s),d=ie*V,n=d+V;return o.slice(d,n)},ke=te.length,de=oe.length,He=oe.filter(s=>s.status==="online").length,he=De(),xs=(s,o)=>{ne(o)},us=s=>{Ye(parseInt(s.target.value,10)),ne(0)};return e.jsxs(l,{sx:{p:3},children:[e.jsxs(l,{sx:{mb:3},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(l,{children:[e.jsxs(a,{variant:"h4",sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(q,{fontSize:"large"}),t("hostGroups.title")]}),e.jsx(a,{variant:"body2",color:"text.secondary",children:t("hostGroups.subtitle")})]}),e.jsx(x,{variant:"contained",size:"large",startIcon:e.jsx(J,{}),onClick:()=>W(!0),sx:{borderRadius:2},children:t("hostGroups.createGroup")})]}),e.jsxs(l,{sx:{display:"flex",gap:2,mb:3,width:"100%",flexWrap:"wrap"},children:[e.jsx(xe,{sx:{flex:1,minWidth:{xs:"100%",sm:"calc(33.333% - 12px)"},bgcolor:"primary.main",color:"white",height:160,borderRadius:3,transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:6}},children:e.jsx(ue,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{children:[e.jsx(a,{variant:"body2",sx:{opacity:.9,mb:1},children:t("hostGroups.stats.totalGroups")}),e.jsx(a,{variant:"h2",sx:{fontWeight:700,lineHeight:1},children:ke}),e.jsx(a,{variant:"caption",sx:{opacity:.8,mt:1,display:"block"},children:t("hostGroups.stats.groups")})]}),e.jsx(l,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",p:2,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(q,{sx:{fontSize:48}})})]})})}),e.jsx(xe,{sx:{flex:1,minWidth:{xs:"100%",sm:"calc(33.333% - 12px)"},bgcolor:"success.main",color:"white",height:160,borderRadius:3,transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:6}},children:e.jsx(ue,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{children:[e.jsx(a,{variant:"body2",sx:{opacity:.9,mb:1},children:t("hostGroups.stats.totalHosts")}),e.jsx(a,{variant:"h2",sx:{fontWeight:700,lineHeight:1},children:de}),e.jsx(a,{variant:"caption",sx:{opacity:.8,mt:1,display:"block"},children:t("hostGroups.stats.hosts")})]}),e.jsx(l,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",p:2,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(K,{sx:{fontSize:48}})})]})})}),e.jsx(xe,{sx:{flex:1,minWidth:{xs:"100%",sm:"calc(33.333% - 12px)"},bgcolor:"info.main",color:"white",height:160,borderRadius:3,transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:6}},children:e.jsx(ue,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{children:[e.jsx(a,{variant:"body2",sx:{opacity:.9,mb:1},children:t("hostGroups.stats.onlineHosts")}),e.jsx(a,{variant:"h2",sx:{fontWeight:700,lineHeight:1},children:He}),e.jsxs(a,{variant:"caption",sx:{opacity:.8,mt:1,display:"block"},children:[de>0?Math.round(He/de*100):0,"% ",t("hostGroups.stats.onlineRate")]})]}),e.jsx(l,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",borderRadius:"50%",p:2,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(X,{sx:{fontSize:48}})})]})})})]})]}),e.jsx(B,{sx:{p:2,mb:3},children:e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:2,alignItems:"center"},children:[e.jsx(l,{sx:{flex:{xs:"none",md:"0 0 33.333%"}},children:e.jsx(y,{fullWidth:!0,size:"small",placeholder:t("hostGroups.search.placeholder"),value:U,onChange:s=>{Qe(s.target.value),ne(0)},InputProps:{startAdornment:e.jsx(pe,{position:"start",children:e.jsx(Z,{})})}})}),e.jsx(l,{sx:{flex:1},children:e.jsxs(l,{sx:{display:"flex",gap:2,alignItems:"center",justifyContent:"flex-end"},children:[e.jsxs(x,{startIcon:e.jsx(gs,{}),onClick:s=>C(s.currentTarget),variant:"outlined",size:"small",children:[t("hostGroups.search.sort"),": ",t(R==="name"?"common.name":R==="hostCount"?"hostGroups.table.hostCount":"common.createdAt")]}),e.jsx(a,{variant:"body2",color:"text.secondary",children:t("hostGroups.search.showing",{filtered:he.length,total:ke})})]})})]})}),e.jsxs(ze,{anchorEl:Ge,open:!!Ge,onClose:()=>C(null),children:[e.jsx(b,{onClick:()=>{P("name"),D("asc"),C(null)},children:t("hostGroups.search.sortBy.nameAsc")}),e.jsx(b,{onClick:()=>{P("name"),D("desc"),C(null)},children:t("hostGroups.search.sortBy.nameDesc")}),e.jsx(b,{onClick:()=>{P("hostCount"),D("desc"),C(null)},children:t("hostGroups.search.sortBy.hostCountDesc")}),e.jsx(b,{onClick:()=>{P("hostCount"),D("asc"),C(null)},children:t("hostGroups.search.sortBy.hostCountAsc")}),e.jsx(b,{onClick:()=>{P("createdAt"),D("desc"),C(null)},children:t("hostGroups.search.sortBy.timeDesc")}),e.jsx(b,{onClick:()=>{P("createdAt"),D("asc"),C(null)},children:t("hostGroups.search.sortBy.timeAsc")})]}),te.length===0?e.jsxs(B,{sx:{p:6,textAlign:"center",borderRadius:3,background:"linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(168, 85, 247, 0.05) 100%)"},children:[e.jsx(q,{sx:{fontSize:80,color:"text.secondary",mb:2,opacity:.5}}),e.jsx(a,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:t("hostGroups.empty.noGroups")}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3},children:t("hostGroups.empty.noGroupsDesc")}),e.jsx(x,{variant:"contained",startIcon:e.jsx(J,{}),onClick:()=>W(!0),children:t("hostGroups.empty.createFirst")})]}):he.length===0?e.jsxs(B,{sx:{p:4,textAlign:"center"},children:[e.jsx(Z,{sx:{fontSize:60,color:"text.secondary",mb:2}}),e.jsx(a,{variant:"h6",color:"text.secondary",children:t("hostGroups.empty.noResults")}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1},children:t("hostGroups.empty.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{component:B,children:e.jsxs(Be,{children:[e.jsx(Me,{children:e.jsxs(se,{children:[e.jsx(c,{children:t("hostGroups.table.groupInfo")}),e.jsx(c,{align:"center",children:t("hostGroups.table.hostCount")}),e.jsx(c,{align:"center",children:t("hostGroups.table.onlineCount")}),e.jsx(c,{align:"center",children:t("hostGroups.table.onlineRate")}),e.jsx(c,{align:"center",children:t("hostGroups.table.createdAt")}),e.jsx(c,{align:"right",children:t("common.actions")})]})}),e.jsx(Le,{children:hs().map(s=>e.jsxs(se,{hover:!0,sx:{cursor:"pointer"},onClick:()=>{v(s),O(!0)},children:[e.jsx(c,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ge,{sx:{bgcolor:s.color,width:40,height:40,fontWeight:600,fontSize:"1.2rem"},children:s.name?.[0]?.toUpperCase()}),e.jsxs(l,{children:[e.jsx(a,{variant:"subtitle2",fontWeight:600,children:s.name}),e.jsx(a,{variant:"caption",color:"text.secondary",children:s.description||t("hostGroups.dialog.noDescription")})]})]})}),e.jsx(c,{align:"center",children:e.jsx(j,{icon:e.jsx(K,{}),label:s.hostCount,size:"small",variant:"outlined"})}),e.jsx(c,{align:"center",children:e.jsx(j,{icon:e.jsx(X,{}),label:s.onlineCount,size:"small",color:"success"})}),e.jsx(c,{align:"center",children:e.jsx(a,{variant:"body2",children:s.hostCount>0?`${Math.round(s.onlineCount/s.hostCount*100)}%`:"-"})}),e.jsx(c,{align:"center",children:e.jsx(a,{variant:"caption",color:"text.secondary",children:new Date(s.createdAt).toLocaleDateString()})}),e.jsxs(c,{align:"right",onClick:o=>o.stopPropagation(),children:[e.jsx(ee,{size:"small",onClick:o=>{o.stopPropagation(),Pe(s)},children:e.jsx(Ae,{fontSize:"small"})}),e.jsx(ee,{size:"small",onClick:o=>{o.stopPropagation(),cs(s)},children:e.jsx(J,{fontSize:"small"})}),e.jsx(ee,{size:"small",onClick:o=>rs(o,s),children:e.jsx(js,{fontSize:"small"})})]})]},s.id))})]})}),e.jsx(B,{sx:{mt:2},children:e.jsx(je,{component:"div",count:he.length,page:fe,onPageChange:xs,rowsPerPage:re,onRowsPerPageChange:us,rowsPerPageOptions:[10,20,50,100],labelRowsPerPage:t("hostGroups.pagination.rowsPerPage"),labelDisplayedRows:({from:s,to:o,count:d})=>t("hostGroups.pagination.displayedRows",{from:s,to:o,count:d})})})]}),e.jsxs(ze,{anchorEl:ye,open:!!ye,onClose:_,children:[e.jsxs(b,{onClick:as,children:[e.jsx(Ae,{sx:{mr:1},fontSize:"small"}),t("hostGroups.actions.edit")]}),e.jsxs(b,{onClick:is,children:[e.jsx(q,{sx:{mr:1},fontSize:"small"}),"查看授权用户"]}),e.jsxs(b,{onClick:ls,sx:{color:"error.main"},children:[e.jsx(Re,{sx:{mr:1},fontSize:"small"}),t("hostGroups.actions.delete")]})]}),e.jsxs(k,{open:_e,onClose:()=>W(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(H,{children:t("hostGroups.dialog.create")}),e.jsx(z,{children:e.jsxs(me,{spacing:2,sx:{mt:1},children:[e.jsx(y,{label:t("hostGroups.groupName"),value:h.name,onChange:s=>m({...h,name:s.target.value}),fullWidth:!0,required:!0}),e.jsx(y,{label:t("hostGroups.groupDescription"),value:h.description,onChange:s=>m({...h,description:s.target.value}),fullWidth:!0,multiline:!0,rows:2,placeholder:t("hostGroups.dialog.descPlaceholder")}),e.jsx(y,{label:t("hostGroups.groupColor"),type:"color",value:h.color,onChange:s=>m({...h,color:s.target.value}),fullWidth:!0})]})}),e.jsxs(A,{children:[e.jsx(x,{onClick:()=>W(!1),children:t("hostGroups.actions.cancel")}),e.jsx(x,{onClick:es,variant:"contained",disabled:!h.name,children:t("hostGroups.actions.create")})]})]}),e.jsxs(k,{open:qe,onClose:()=>N(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(H,{children:t("hostGroups.dialog.edit")}),e.jsx(z,{children:e.jsxs(me,{spacing:2,sx:{mt:1},children:[e.jsx(y,{label:t("hostGroups.groupName"),value:h.name,onChange:s=>m({...h,name:s.target.value}),fullWidth:!0,required:!0}),e.jsx(y,{label:t("hostGroups.groupDescription"),value:h.description,onChange:s=>m({...h,description:s.target.value}),fullWidth:!0,multiline:!0,rows:2,placeholder:t("hostGroups.dialog.descPlaceholder")}),e.jsx(y,{label:t("hostGroups.groupColor"),type:"color",value:h.color,onChange:s=>m({...h,color:s.target.value}),fullWidth:!0})]})}),e.jsxs(A,{children:[e.jsx(x,{onClick:()=>N(!1),children:t("hostGroups.actions.cancel")}),e.jsx(x,{onClick:ss,variant:"contained",disabled:!h.name,children:t("hostGroups.actions.save")})]})]}),e.jsxs(k,{open:le,onClose:()=>{O(!1),G(""),p(0)},maxWidth:"lg",fullWidth:!0,children:[e.jsx(H,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ge,{sx:{bgcolor:i?.color,width:48,height:48,fontWeight:700,fontSize:"1.5rem"},children:i?.name?.[0]?.toUpperCase()}),e.jsxs(l,{children:[e.jsx(a,{variant:"h6",children:i?.name}),e.jsx(a,{variant:"caption",color:"text.secondary",children:i?.description||t("hostGroups.dialog.noDescription")})]})]}),e.jsx(x,{variant:"outlined",startIcon:e.jsx(J,{}),onClick:()=>{O(!1),T(!0)},children:t("hostGroups.hosts.addHost")})]})}),e.jsxs(z,{dividers:!0,children:[e.jsx(y,{fullWidth:!0,size:"small",placeholder:t("hostGroups.hosts.searchPlaceholder"),value:F,onChange:s=>{G(s.target.value),p(0)},sx:{mb:2},InputProps:{startAdornment:e.jsx(pe,{position:"start",children:e.jsx(Z,{})})}}),(()=>{const s=L[i?.id||""]||[],o=ce(s),d=Ie(s);return s.length===0?e.jsx(M,{severity:"info",children:t("hostGroups.hosts.noHosts")}):o.length===0?e.jsx(M,{severity:"warning",children:t("hostGroups.hosts.noHostsFound")}):e.jsxs(e.Fragment,{children:[e.jsx($e,{children:e.jsxs(Be,{size:"small",children:[e.jsx(Me,{children:e.jsxs(se,{children:[e.jsx(c,{children:t("hostGroups.hosts.hostName")}),e.jsx(c,{children:t("hostGroups.hosts.ipAddress")}),e.jsx(c,{align:"center",children:t("hostGroups.hosts.port")}),e.jsx(c,{align:"center",children:t("hostGroups.hosts.type")}),e.jsx(c,{align:"center",children:t("common.status")}),e.jsx(c,{align:"right",children:t("common.actions")})]})}),e.jsx(Le,{children:d.map(n=>e.jsxs(se,{hover:!0,children:[e.jsx(c,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(K,{color:"primary",fontSize:"small"}),e.jsx(a,{variant:"body2",children:n.name})]})}),e.jsx(c,{children:e.jsx(j,{label:n.ip,size:"small",variant:"outlined"})}),e.jsx(c,{align:"center",children:n.port}),e.jsx(c,{align:"center",children:e.jsx(j,{label:n.deviceType,size:"small"})}),e.jsx(c,{align:"center",children:e.jsx(j,{icon:n.status==="online"?e.jsx(X,{}):e.jsx(We,{}),label:n.status,size:"small",color:n.status==="online"?"success":"default"})}),e.jsx(c,{align:"right",children:e.jsx(ee,{size:"small",onClick:()=>{window.confirm(`确定要从分组 "${i?.name}" 中移除主机 "${n.name}" 吗？`)&&ns(n.id)},color:"error",children:e.jsx(Re,{fontSize:"small"})})})]},n.id))})]})}),e.jsx(je,{component:"div",count:o.length,page:ie,onPageChange:(n,u)=>p(u),rowsPerPage:V,onRowsPerPageChange:n=>{Se(parseInt(n.target.value,10)),p(0)},rowsPerPageOptions:[10,25,50,100],labelRowsPerPage:t("hostGroups.pagination.rowsPerPage"),labelDisplayedRows:({from:n,to:u,count:$})=>t("hostGroups.pagination.displayedRows",{from:n,to:u,count:$})})]})})()]}),e.jsx(A,{children:e.jsx(x,{onClick:()=>{O(!1),G(""),p(0)},children:t("hostGroups.actions.close")})})]}),e.jsxs(k,{open:Je,onClose:()=>{T(!1),S([]),G(""),p(0)},maxWidth:"md",fullWidth:!0,children:[e.jsx(H,{children:t("hostGroups.hosts.addToGroup")}),e.jsxs(z,{dividers:!0,children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t("hostGroups.hosts.addToGroupDesc",{name:i?.name})}),e.jsx(y,{fullWidth:!0,size:"small",placeholder:t("hostGroups.hosts.searchPlaceholder"),value:F,onChange:s=>{G(s.target.value),p(0)},sx:{mb:2},InputProps:{startAdornment:e.jsx(pe,{position:"start",children:e.jsx(Z,{})})}}),(()=>{const s=ds(),o=ce(s),d=Ie(s);return s.length===0?e.jsx(M,{severity:"info",children:t("hostGroups.hosts.allInGroup")}):o.length===0?e.jsx(M,{severity:"warning",children:t("hostGroups.hosts.noHostsFound")}):e.jsxs(e.Fragment,{children:[e.jsxs(l,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:t("hostGroups.hosts.selectedCount",{count:g.length})}),e.jsx(x,{size:"small",onClick:()=>{g.length===o.length?S([]):S(o.map(n=>n.id))},children:g.length===o.length?t("hostGroups.hosts.deselectAll"):t("hostGroups.hosts.selectAll")})]}),e.jsx(Te,{sx:{maxHeight:400,overflow:"auto"},children:d.map(n=>e.jsxs(Oe,{dense:!0,sx:{border:"1px solid",borderColor:"divider",borderRadius:1,mb:1},children:[e.jsx(ms,{checked:g.includes(n.id),onChange:u=>{u.target.checked?S([...g,n.id]):S(g.filter($=>$!==n.id))}}),e.jsx(K,{sx:{mr:1,color:"primary.main"}}),e.jsx(Fe,{primary:n.name,secondary:e.jsxs(me,{direction:"row",spacing:.5,sx:{mt:.5},children:[e.jsx(j,{label:n.ip,size:"small",variant:"outlined"}),e.jsx(j,{icon:n.status==="online"?e.jsx(X,{}):e.jsx(We,{}),label:n.status,size:"small",color:n.status==="online"?"success":"default"}),e.jsx(j,{label:n.deviceType,size:"small"})]})})]},n.id))}),e.jsx(je,{component:"div",count:o.length,page:ie,onPageChange:(n,u)=>p(u),rowsPerPage:V,onRowsPerPageChange:n=>{Se(parseInt(n.target.value,10)),p(0)},rowsPerPageOptions:[10,25,50],labelRowsPerPage:t("hostGroups.pagination.rowsPerPage"),labelDisplayedRows:({from:n,to:u,count:$})=>t("hostGroups.pagination.displayedRows",{from:n,to:u,count:$})})]})})()]}),e.jsxs(A,{children:[e.jsx(x,{onClick:()=>{T(!1),S([]),G(""),p(0)},children:t("hostGroups.actions.cancel")}),e.jsxs(x,{onClick:()=>{os(),G(""),p(0)},variant:"contained",disabled:g.length===0,children:[t("hostGroups.actions.add")," (",g.length,")"]})]})]}),e.jsxs(k,{open:Ke,onClose:()=>ae(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(H,{children:["授权用户列表 - ",i?.name]}),e.jsx(z,{children:e.jsxs(l,{sx:{pt:2},children:[ve.length===0?e.jsx(M,{severity:"info",children:"暂无用户被授权访问此分组"}):e.jsx(Te,{children:ve.map((s,o)=>e.jsxs("div",{children:[o>0&&e.jsx(fs,{}),e.jsxs(Oe,{children:[e.jsx(ge,{sx:{mr:2,bgcolor:"primary.main"},children:s.username?.[0]?.toUpperCase()}),e.jsx(Fe,{primary:s.username,secondary:e.jsxs(l,{children:[e.jsx(a,{variant:"caption",display:"block",children:s.email||"未设置邮箱"}),e.jsx(j,{label:s.role==="admin"?"管理员":"普通用户",size:"small",color:s.role==="admin"?"error":"default",sx:{mt:.5}}),s.status!=="active"&&e.jsx(j,{label:"已禁用",size:"small",color:"warning",sx:{mt:.5,ml:.5}})]})})]})]},s.id))}),e.jsx(l,{sx:{mt:2,p:2,bgcolor:"background.default",borderRadius:1},children:e.jsx(a,{variant:"body2",color:"text.secondary",children:'提示：在"用户管理"页面可以为用户分配分组权限'})})]})}),e.jsx(A,{children:e.jsx(x,{onClick:()=>ae(!1),children:"关闭"})})]}),e.jsxs(k,{open:Xe,onClose:()=>Q(!1),children:[e.jsx(H,{children:t("hostGroups.dialog.delete")}),e.jsxs(z,{children:[e.jsx(a,{children:t("hostGroups.dialog.deleteConfirm",{name:i?.name})}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1},children:t("hostGroups.dialog.deleteNote")})]}),e.jsxs(A,{children:[e.jsx(x,{onClick:()=>Q(!1),children:t("hostGroups.actions.cancel")}),e.jsx(x,{onClick:ts,color:"error",variant:"contained",children:t("hostGroups.actions.confirmDelete")})]})]})]})}export{Ps as default};

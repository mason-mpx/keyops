import{br as fe,cE as ye,r as m,bs as ge,j as e,an as je,cF as ue,bt as be,ao as ke,ak as Se,bz as ve,af as Ce,al as we,bJ as De,u as $e,bg as Ae,ax as Ge,B as x,C as U,b as W,a as B,aA as ne,I as ie,T as d,d as Re,v as Te,bm as re,cA as Ie,w,x as G,a3 as We,a4 as Y,a2 as Be,Z as Pe,bl as Me,cG as ze,i as Ee,k as Oe,l as Ne,p as Le,bf as ee,a7 as Ye}from"./index-DNdAKB9f.js";import{k as se,a as He,b as Ke,c as Xe,r as Fe}from"./index-CR_954yY.js";import{P as _e,Y as Ue}from"./PodActions-0Tf8DQqY.js";import{C as P}from"./Chip-B8lB6W_F.js";import{R as ae,C as oe,X as le,Y as ce,T as de,L as xe}from"./CartesianChart-Z4MMshd-.js";import{L as pe}from"./LineChart-Dr39Uq0_.js";import{L as me}from"./Line-CPjPyFDu.js";import"./utils-5I4TgzTo.js";import"./yaml-xSLLCrpq.js";import"./index-CNgOdE3q.js";import"./k8sClusterApi-YbI-1DRG.js";import"./PodLogsDialog-BhpZFNfn.js";import"./xterm-BqYE0GQX.js";import"./Switch-psoPU8CH.js";import"./value-DEjY8fVb.js";const Je=(s,n)=>s.filter(i=>n.includes(i)),z=(s,n,i)=>{const r=s.keys[0];Array.isArray(n)?n.forEach((o,l)=>{i((S,c)=>{l<=s.keys.length-1&&(l===0?Object.assign(S,c):S[s.up(s.keys[l])]=c)},o)}):n&&typeof n=="object"?(Object.keys(n).length>s.keys.length?s.keys:Je(s.keys,Object.keys(n))).forEach(l=>{if(s.keys.includes(l)){const S=n[l];S!==void 0&&i((c,D)=>{r===l?Object.assign(c,D):c[s.up(l)]=D},S)}}):(typeof n=="number"||typeof n=="string")&&i((o,l)=>{Object.assign(o,l)},n)};function J(s){return`--Grid-${s}Spacing`}function V(s){return`--Grid-parent-${s}Spacing`}const he="--Grid-columns",M="--Grid-parent-columns",Ve=({theme:s,ownerState:n})=>{const i={};return z(s.breakpoints,n.size,(r,o)=>{let l={};o==="grow"&&(l={flexBasis:0,flexGrow:1,maxWidth:"100%"}),o==="auto"&&(l={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof o=="number"&&(l={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${o} / var(${M}) - (var(${M}) - ${o}) * (var(${V("column")}) / var(${M})))`}),r(i,l)}),i},Ze=({theme:s,ownerState:n})=>{const i={};return z(s.breakpoints,n.offset,(r,o)=>{let l={};o==="auto"&&(l={marginLeft:"auto"}),typeof o=="number"&&(l={marginLeft:o===0?"0px":`calc(100% * ${o} / var(${M}) + var(${V("column")}) * ${o} / var(${M}))`}),r(i,l)}),i},qe=({theme:s,ownerState:n})=>{if(!n.container)return{};const i={[he]:12};return z(s.breakpoints,n.columns,(r,o)=>{const l=o??12;r(i,{[he]:l,"> *":{[M]:l}})}),i},Qe=({theme:s,ownerState:n})=>{if(!n.container)return{};const i={};return z(s.breakpoints,n.rowSpacing,(r,o)=>{const l=typeof o=="string"?o:s.spacing?.(o);r(i,{[J("row")]:l,"> *":{[V("row")]:l}})}),i},es=({theme:s,ownerState:n})=>{if(!n.container)return{};const i={};return z(s.breakpoints,n.columnSpacing,(r,o)=>{const l=typeof o=="string"?o:s.spacing?.(o);r(i,{[J("column")]:l,"> *":{[V("column")]:l}})}),i},ss=({theme:s,ownerState:n})=>{if(!n.container)return{};const i={};return z(s.breakpoints,n.direction,(r,o)=>{r(i,{flexDirection:o})}),i},ts=({ownerState:s})=>({minWidth:0,boxSizing:"border-box",...s.container&&{display:"flex",flexWrap:"wrap",...s.wrap&&s.wrap!=="wrap"&&{flexWrap:s.wrap},gap:`var(${J("row")}) var(${J("column")})`}}),ns=s=>{const n=[];return Object.entries(s).forEach(([i,r])=>{r!==!1&&r!==void 0&&n.push(`grid-${i}-${String(r)}`)}),n},is=(s,n="xs")=>{function i(r){return r===void 0?!1:typeof r=="string"&&!Number.isNaN(Number(r))||typeof r=="number"&&r>0}if(i(s))return[`spacing-${n}-${String(s)}`];if(typeof s=="object"&&!Array.isArray(s)){const r=[];return Object.entries(s).forEach(([o,l])=>{i(l)&&r.push(`spacing-${o}-${String(l)}`)}),r}return[]},rs=s=>s===void 0?[]:typeof s=="object"?Object.entries(s).map(([n,i])=>`direction-${n}-${i}`):[`direction-xs-${String(s)}`];function as(s,n){s.item!==void 0&&delete s.item,s.zeroMinWidth!==void 0&&delete s.zeroMinWidth,n.keys.forEach(i=>{s[i]!==void 0&&delete s[i]})}const os=ve(),ls=fe("div",{name:"MuiGrid",slot:"Root"});function cs(s){return be({props:s,name:"MuiGrid",defaultTheme:os})}function ds(s={}){const{createStyledComponent:n=ls,useThemeProps:i=cs,useTheme:r=ye,componentName:o="MuiGrid"}=s,l=(g,h)=>{const{container:f,direction:y,spacing:u,wrap:p,size:v}=g,R={root:["root",f&&"container",p!=="wrap"&&`wrap-xs-${String(p)}`,...rs(y),...ns(v),...f?is(u,h.breakpoints.keys[0]):[]]};return ke(R,E=>Se(o,E),{})};function S(g,h,f=()=>!0){const y={};return g===null||(Array.isArray(g)?g.forEach((u,p)=>{u!==null&&f(u)&&h.keys[p]&&(y[h.keys[p]]=u)}):typeof g=="object"?Object.keys(g).forEach(u=>{const p=g[u];p!=null&&f(p)&&(y[u]=p)}):y[h.keys[0]]=g),y}const c=n(qe,es,Qe,Ve,ss,ts,Ze),D=m.forwardRef(function(h,f){const y=r(),u=i(h),p=ge(u);as(p,y.breakpoints);const{className:v,children:R,columns:E=12,container:O=!1,component:Z="div",direction:T="row",wrap:$="wrap",size:q={},offset:K={},spacing:I=0,rowSpacing:X=I,columnSpacing:F=I,unstable_level:b=0,...Q}=p,N=S(q,y.breakpoints,k=>k!==!1),_=S(K,y.breakpoints),L=h.columns??(b?void 0:E),t=h.spacing??(b?void 0:I),a=h.rowSpacing??h.spacing??(b?void 0:X),j=h.columnSpacing??h.spacing??(b?void 0:F),C={...p,level:b,columns:L,container:O,direction:T,wrap:$,spacing:t,rowSpacing:a,columnSpacing:j,size:N,offset:_},A=l(C,y);return e.jsx(c,{ref:f,as:Z,ownerState:C,className:je(A.root,v),...Q,children:m.Children.map(R,k=>m.isValidElement(k)&&ue(k,["Grid"])&&O&&k.props.container?m.cloneElement(k,{unstable_level:k.props?.unstable_level??b+1}):k)})});return D.muiName="Grid",D}const te=ds({createStyledComponent:Ce("div",{name:"MuiGrid",slot:"Root",overridesResolver:(s,n)=>{const{ownerState:i}=s;return[n.root,i.container&&n.container]}}),componentName:"MuiGrid",useThemeProps:s=>we({props:s,name:"MuiGrid"}),useTheme:De});function H(s){const{children:n,value:i,index:r,...o}=s;return e.jsx("div",{role:"tabpanel",hidden:i!==r,id:`daemonset-tabpanel-${r}`,"aria-labelledby":`daemonset-tab-${r}`,...o,children:i===r&&e.jsx(x,{sx:{p:3},children:n})})}function Ds(){const{t:s}=$e(),{clusterId:n,namespace:i,name:r}=Ae(),o=Ge(),[l,S]=m.useState(!0),[c,D]=m.useState(null),[g,h]=m.useState(null),[f,y]=m.useState(0),[u,p]=m.useState(!1),[v,R]=m.useState(null),[E,O]=m.useState(!1),[Z,T]=m.useState(!1),[$,q]=m.useState([]),[K,I]=m.useState(!1),[X,F]=m.useState(!1),b=async()=>{if(!(!n||!i||!r))try{S(!0),h(null);const a=await He({clusterId:n,namespace:i},r);D(a),Q(),N()}catch(t){const a=t&&typeof t=="object"&&"response"in t&&t.response&&typeof t.response=="object"&&"data"in t.response&&t.response.data&&typeof t.response.data=="object"&&"message"in t.response.data&&typeof t.response.data.message=="string"?t.response.data.message:s("k8s.daemonSets.loadDetailFailed","获取DaemonSet详情失败");h(a),ee(a)}finally{S(!1)}},Q=async()=>{if(!(!n||!i||!r))try{O(!0);const a=await Ke({clusterId:n,namespace:i},r,3600,300);R(a)}catch(t){console.error("加载监控数据失败:",t),R(null)}finally{O(!1)}},N=async()=>{if(!(!n||!i||!r))try{I(!0);const a=await Xe({clusterId:n,namespace:i},r);q(a.revisions)}catch(t){const a=t&&typeof t=="object"&&"response"in t&&t.response&&typeof t.response=="object"&&"data"in t.response&&t.response.data&&typeof t.response.data=="object"&&"message"in t.response.data&&typeof t.response.data.message=="string"?t.response.data.message:"加载历史版本失败";ee(a)}finally{I(!1)}},_=async t=>{if(!(!n||!i||!r))try{F(!0),await Fe({clusterId:n,namespace:i},r,t),Ye(`已成功回滚到版本 ${t}`),T(!1),b(),N()}catch(a){const j=a&&typeof a=="object"&&"response"in a&&a.response&&typeof a.response=="object"&&"data"in a.response&&a.response.data&&typeof a.response.data=="object"&&"message"in a.response.data&&typeof a.response.data.message=="string"?a.response.data.message:"回滚失败";ee(j)}finally{F(!1)}};m.useEffect(()=>{n&&i&&r&&b()},[n,i,r]),m.useEffect(()=>{if(!n||!i||!r)return;const t=setInterval(()=>{b()},3e4);return()=>clearInterval(t)},[n,i,r]);const L=(t,a)=>a==null||a===""?null:e.jsxs(x,{sx:{mb:2},children:[e.jsx(d,{variant:"caption",color:"text.secondary",display:"block",children:t}),e.jsx(d,{variant:"body1",fontWeight:500,children:String(a)})]});return l&&!c?e.jsx(x,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:e.jsx(U,{})}):g&&!c?e.jsxs(x,{sx:{p:3},children:[e.jsx(W,{severity:"error",children:g}),e.jsx(B,{startIcon:e.jsx(ne,{}),onClick:()=>o("/k8s/daemonsets"),sx:{mt:2},children:s("common.back")})]}):e.jsxs(x,{sx:{width:"100%",p:3},children:[e.jsxs(x,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:2},children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ie,{onClick:()=>o("/k8s/daemonsets"),children:e.jsx(ne,{})}),e.jsxs(x,{children:[e.jsx(d,{variant:"h4",component:"h1",fontWeight:"700",children:r}),e.jsxs(d,{variant:"body2",color:"text.secondary",children:[i," / ",n]})]})]}),e.jsxs(x,{sx:{display:"flex",gap:1},children:[e.jsx(Re,{title:s("common.refresh"),children:e.jsx(ie,{onClick:b,children:e.jsx(Te,{})})}),e.jsx(B,{variant:"outlined",startIcon:e.jsx(re,{}),onClick:()=>{T(!0),N()},children:s("k8s.deployments.rollback","回滚")}),e.jsx(B,{variant:"outlined",startIcon:e.jsx(Ie,{}),onClick:()=>p(!0),children:s("k8s.viewYaml")})]})]}),e.jsxs(x,{sx:{display:"flex",gap:2,mb:3,width:"100%",flexWrap:{xs:"wrap",sm:"nowrap"}},children:[e.jsx(w,{sx:{flex:1,minWidth:{xs:"100%",sm:0},display:"flex",flexDirection:"column"},children:e.jsxs(G,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",minHeight:120},children:[e.jsx(d,{variant:"caption",color:"text.secondary",sx:{mb:1},children:s("k8s.daemonSets.desired","期望")}),e.jsx(d,{variant:"h4",fontWeight:"600",children:String(c?.replicas??c?.desired??0)})]})}),e.jsx(w,{sx:{flex:1,minWidth:{xs:"100%",sm:0},display:"flex",flexDirection:"column"},children:e.jsxs(G,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",minHeight:120},children:[e.jsx(d,{variant:"caption",color:"text.secondary",sx:{mb:1},children:s("k8s.daemonSets.current","当前")}),e.jsx(d,{variant:"h4",fontWeight:"600",color:"info.main",children:String(c?.replicas??c?.current??0)})]})}),e.jsx(w,{sx:{flex:1,minWidth:{xs:"100%",sm:0},display:"flex",flexDirection:"column"},children:e.jsxs(G,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",minHeight:120},children:[e.jsx(d,{variant:"caption",color:"text.secondary",sx:{mb:1},children:s("k8s.daemonSets.ready","就绪")}),e.jsx(d,{variant:"h4",fontWeight:"600",color:"success.main",children:String(c?.ready??0)})]})}),e.jsx(w,{sx:{flex:1,minWidth:{xs:"100%",sm:0},display:"flex",flexDirection:"column"},children:e.jsxs(G,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",minHeight:120},children:[e.jsx(d,{variant:"caption",color:"text.secondary",sx:{mb:1},children:s("k8s.daemonSets.available","可用")}),e.jsx(d,{variant:"h4",fontWeight:"600",color:"warning.main",children:String(c?.available??0)})]})})]}),e.jsxs(w,{children:[e.jsx(x,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(We,{value:f,onChange:(t,a)=>y(a),children:[e.jsx(Y,{icon:e.jsx(Be,{}),iconPosition:"start",label:s("k8s.basicInfo")}),e.jsx(Y,{icon:e.jsx(Pe,{}),iconPosition:"start",label:`${s("k8s.pods.title")} (${Array.isArray(c?.pods)?c.pods.length:0})`}),e.jsx(Y,{icon:e.jsx(Me,{}),iconPosition:"start",label:`${s("k8s.events.title")} (${Array.isArray(c?.events)?c.events.length:0})`}),e.jsx(Y,{icon:e.jsx(ze,{}),iconPosition:"start",label:s("k8s.monitoring","监控")}),e.jsx(Y,{icon:e.jsx(re,{}),iconPosition:"start",label:`${s("k8s.deployments.history","历史版本")} (${$.length})`})]})}),e.jsx(H,{value:f,index:0,children:e.jsxs(te,{container:!0,spacing:3,children:[e.jsxs(te,{item:!0,xs:12,md:6,children:[e.jsx(d,{variant:"h6",sx:{mb:2},children:s("k8s.basicInfo")}),L(s("k8s.name"),c?.name),L(s("k8s.namespace"),c?.namespace),L(s("k8s.age"),c?.age)]}),e.jsxs(te,{item:!0,xs:12,md:6,children:[e.jsx(d,{variant:"h6",sx:{mb:2},children:s("k8s.labels")}),c?.labels&&Object.keys(c.labels).length>0?e.jsx(x,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:Object.entries(c.labels).map(([t,a])=>e.jsx(P,{label:`${t}=${a}`,size:"small"},t))}):e.jsx(d,{variant:"body2",color:"text.secondary",children:s("common.noData")})]})]})}),e.jsx(H,{value:f,index:1,children:c?.pods&&c.pods.length>0?e.jsxs(x,{children:[e.jsx(d,{variant:"h6",sx:{mb:2},children:s("k8s.pods.title")}),e.jsx(x,{sx:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #e0e0e0"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.name")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.status")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.node")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.restarts")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.age")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("common.actions")})]})}),e.jsx("tbody",{children:c.pods.map((t,a)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f0f0f0"},children:[e.jsx("td",{style:{padding:"12px"},children:String(t.name??"")}),e.jsx("td",{style:{padding:"12px"},children:e.jsx(P,{label:String(t.status??""),color:t.status==="Running"?"success":"default",size:"small"})}),e.jsx("td",{style:{padding:"12px"},children:String(t.node??"-")}),e.jsx("td",{style:{padding:"12px"},children:String(t.restarts??0)}),e.jsx("td",{style:{padding:"12px"},children:String(t.age??"-")}),e.jsx("td",{style:{padding:"12px"},children:e.jsx(_e,{pod:t,clusterId:n||"",namespace:i||""})})]},a))})]})})]}):e.jsx(W,{severity:"info",children:s("common.noData")})}),e.jsx(H,{value:f,index:2,children:c?.events&&c.events.length>0?e.jsxs(x,{children:[e.jsx(d,{variant:"h6",sx:{mb:2},children:s("k8s.events.title")}),e.jsx(x,{sx:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #e0e0e0"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.type")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.reason")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.message")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.count")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.lastSeen")})]})}),e.jsx("tbody",{children:c.events.map((t,a)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f0f0f0"},children:[e.jsx("td",{style:{padding:"12px"},children:e.jsx(P,{label:String(t.type??""),color:t.type==="Warning"?"warning":"info",size:"small"})}),e.jsx("td",{style:{padding:"12px"},children:String(t.reason??"")}),e.jsx("td",{style:{padding:"12px"},children:String(t.message??"")}),e.jsx("td",{style:{padding:"12px"},children:String(t.count??0)}),e.jsx("td",{style:{padding:"12px"},children:String(t.lastSeen??"")})]},a))})]})})]}):e.jsx(W,{severity:"info",children:s("common.noData")})}),e.jsxs(H,{value:f,index:3,children:[e.jsx(d,{variant:"h6",sx:{mb:3},children:s("k8s.monitoring","监控")}),E?e.jsx(x,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(U,{})}):v&&v.metrics&&v.metrics.length>0?e.jsxs(x,{sx:{display:"flex",flexDirection:"column",gap:3,width:"100%"},children:[e.jsx(w,{sx:{width:"100%"},children:e.jsxs(G,{children:[e.jsx(d,{variant:"subtitle1",sx:{mb:2},children:"CPU 使用率 (m)"}),e.jsx(ae,{width:"100%",height:300,children:e.jsxs(pe,{data:v.metrics,children:[e.jsx(oe,{strokeDasharray:"3 3"}),e.jsx(le,{dataKey:"time"}),e.jsx(ce,{}),e.jsx(de,{}),e.jsx(xe,{}),e.jsx(me,{type:"monotone",dataKey:"cpu",stroke:"#8884d8",name:"CPU (m)"})]})})]})}),e.jsx(w,{sx:{width:"100%"},children:e.jsxs(G,{children:[e.jsx(d,{variant:"subtitle1",sx:{mb:2},children:"内存使用率 (MB)"}),e.jsx(ae,{width:"100%",height:300,children:e.jsxs(pe,{data:v.metrics,children:[e.jsx(oe,{strokeDasharray:"3 3"}),e.jsx(le,{dataKey:"time"}),e.jsx(ce,{}),e.jsx(de,{}),e.jsx(xe,{}),e.jsx(me,{type:"monotone",dataKey:"memory",stroke:"#82ca9d",name:"Memory (MB)"})]})})]})})]}):e.jsx(W,{severity:"info",children:s("k8s.monitoring.noData","暂无监控数据")})]}),e.jsxs(H,{value:f,index:4,children:[e.jsx(d,{variant:"h6",sx:{mb:2},children:s("k8s.deployments.history","历史版本")}),K?e.jsx(x,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(U,{})}):$.length>0?e.jsx(x,{sx:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid #e0e0e0"},children:[e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.deployments.revision","版本")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.age","创建时间")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.deployments.changeReason","变更原因")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.images","镜像")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("k8s.status","状态")}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:s("common.actions")})]})}),e.jsx("tbody",{children:$.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid #f0f0f0"},children:[e.jsx("td",{style:{padding:"12px"},children:e.jsxs(d,{variant:"body2",fontWeight:t.status==="current"?600:400,children:[t.revision,t.status==="current"&&e.jsx(P,{label:s("k8s.deployments.current","当前"),size:"small",color:"primary",sx:{ml:1}})]})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx(d,{variant:"body2",children:t.creationTime})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx(d,{variant:"body2",color:"text.secondary",children:t.changeReason||"-"})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx(x,{sx:{display:"flex",flexDirection:"column",gap:.5},children:t.images.map((a,j)=>e.jsx(d,{variant:"body2",sx:{fontFamily:"monospace",fontSize:"0.875rem"},children:a},j))})}),e.jsx("td",{style:{padding:"12px"},children:e.jsx(P,{label:t.status==="current"?s("k8s.deployments.current","当前"):s("k8s.deployments.historical","历史"),size:"small",color:t.status==="current"?"primary":"default"})}),e.jsx("td",{style:{padding:"12px"},children:t.status==="historical"&&e.jsx(B,{size:"small",variant:"outlined",onClick:()=>_(t.revision),disabled:X,children:s("k8s.deployments.rollback","回滚")})})]},t.revision))})]})}):e.jsx(W,{severity:"info",children:s("common.noData")})]})]}),e.jsxs(Ee,{open:Z,onClose:()=>T(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Oe,{children:s("k8s.deployments.rollback","回滚 DaemonSet")}),e.jsx(Ne,{children:K?e.jsx(x,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(U,{})}):$.length>0?e.jsxs(x,{sx:{mt:2},children:[e.jsx(d,{variant:"body2",color:"text.secondary",sx:{mb:2},children:s("k8s.deployments.selectRevision","选择要回滚到的版本")}),$.filter(t=>t.status==="historical").map(t=>e.jsx(w,{sx:{mb:1},children:e.jsx(G,{children:e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(x,{children:[e.jsxs(d,{variant:"subtitle1",fontWeight:600,children:[s("k8s.deployments.revision","版本")," ",t.revision]}),e.jsx(d,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:t.creationTime}),t.changeReason&&e.jsx(d,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:t.changeReason}),e.jsx(x,{sx:{mt:1},children:t.images.map((a,j)=>e.jsx(P,{label:a,size:"small",sx:{mr:.5,mb:.5}},j))})]}),e.jsx(B,{variant:"contained",onClick:()=>_(t.revision),disabled:X,children:s("k8s.deployments.rollback","回滚")})]})})},t.revision))]}):e.jsx(W,{severity:"info",sx:{mt:2},children:s("k8s.deployments.loadRevisionsFailed","没有可回滚的历史版本")})}),e.jsx(Le,{children:e.jsx(B,{onClick:()=>T(!1),children:s("common.cancel")})})]}),n&&i&&r&&e.jsx(Ue,{open:u,onClose:()=>p(!1),title:`${s("k8s.daemonSets.title")} - ${r}`,clusterId:n,namespace:i,resourceType:"daemonset",resourceName:r,onLoadYaml:async(t,a,j,C)=>{const A={clusterId:t,namespace:a};return await se.getResourceYaml(A,j,C)},onSaveYaml:async(t,a,j,C,A)=>{const k={clusterId:t,namespace:a};await se.updateResourceYaml(k,j,C,A),b()},onDryRun:async(t,a,j,C,A)=>{const k={clusterId:t,namespace:a};return await se.dryRunResourceYaml(k,j,C,A)}})]})}export{Ds as default};

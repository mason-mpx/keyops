import{r as o,j as e,B as i,C as T,T as n,b as I,w as _,x as D,_ as j,m as l,a as d,a5 as R,bf as a,a7 as C,V as M,c as W}from"./index-DNdAKB9f.js";import{S as c}from"./Stack-6rKlDBQM.js";import{S as v}from"./Switch-psoPU8CH.js";function z(){const[y,x]=o.useState(!1),[h,p]=o.useState(!1),[g,m]=o.useState(!1),[k,f]=o.useState("unknown"),[r,s]=o.useState({server_url:"",auth_type:"token",token:"",username:"",password:"",insecure:!1,enabled:!0,description:""});o.useEffect(()=>{b()},[]);const b=async()=>{try{x(!0)}catch(t){console.error("加载配置失败:",t)}finally{x(!1)}},w=async()=>{if(!r.server_url){a("请填写ArgoCD服务器地址");return}if(r.auth_type==="token"&&!r.token){a("请填写API Token");return}if(r.auth_type==="password"&&(!r.username||!r.password)){a("请填写用户名和密码");return}try{p(!0),C("配置保存成功"),b()}catch(t){const u=t?.response?.data?.message||"保存配置失败";a(u)}finally{p(!1)}},S=async()=>{if(!r.server_url){a("请填写ArgoCD服务器地址");return}try{m(!0),C("连接测试功能待实现"),f("connected")}catch(t){const u=t?.response?.data?.message||"连接测试失败";a(u),f("disconnected")}finally{m(!1)}},A=()=>{switch(k){case"connected":return e.jsxs(c,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(W,{color:"success",fontSize:"small"}),e.jsx(n,{variant:"body2",color:"success.main",children:"已连接"})]});case"disconnected":return e.jsxs(c,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(M,{color:"error",fontSize:"small"}),e.jsx(n,{variant:"body2",color:"error.main",children:"未连接"})]});default:return e.jsx(n,{variant:"body2",color:"text.secondary",children:"未测试"})}};return y?e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:4},children:e.jsx(T,{})}):e.jsxs(i,{sx:{width:"100%",p:{xs:2,sm:3}},children:[e.jsxs(i,{sx:{mb:3},children:[e.jsx(n,{variant:"h5",component:"h2",fontWeight:"600",sx:{fontSize:{xs:"1.5rem",sm:"1.75rem"},color:"#1a202c",mb:.5},children:"ArgoCD 配置管理"}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.875rem",color:"#718096"},children:"配置 ArgoCD 集成，通过 GitOps 方式管理应用部署"})]}),e.jsx(I,{severity:"info",sx:{mb:3},children:"ArgoCD 配置功能正在开发中，后续版本将支持完整的 ArgoCD 集成功能。"}),e.jsx(_,{elevation:0,sx:{borderRadius:3,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsx(D,{sx:{p:{xs:2,sm:3}},children:e.jsxs(c,{spacing:3,children:[e.jsxs(i,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"连接状态"}),A()]}),e.jsx(j,{control:e.jsx(v,{checked:r.enabled,onChange:t=>s({...r,enabled:t.target.checked}),color:"primary"}),label:"启用 ArgoCD 集成"}),e.jsx(l,{fullWidth:!0,label:"ArgoCD 服务器地址",value:r.server_url,onChange:t=>s({...r,server_url:t.target.value}),placeholder:"https://argocd.example.com",helperText:"请输入完整的 ArgoCD 服务器 URL",required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.5}}}),e.jsxs(i,{children:[e.jsx(n,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"认证方式"}),e.jsxs(c,{direction:"row",spacing:2,children:[e.jsx(d,{variant:r.auth_type==="token"?"contained":"outlined",onClick:()=>s({...r,auth_type:"token"}),sx:{borderRadius:1.5,textTransform:"none"},children:"API Token"}),e.jsx(d,{variant:r.auth_type==="password"?"contained":"outlined",onClick:()=>s({...r,auth_type:"password"}),sx:{borderRadius:1.5,textTransform:"none"},children:"用户名/密码"})]})]}),r.auth_type==="token"&&e.jsx(l,{fullWidth:!0,type:"password",label:"API Token",value:r.token,onChange:t=>s({...r,token:t.target.value}),placeholder:"ArgoCD API Token",helperText:"在 ArgoCD 中生成的 API Token",required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.5}}}),r.auth_type==="password"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{fullWidth:!0,label:"用户名",value:r.username,onChange:t=>s({...r,username:t.target.value}),placeholder:"ArgoCD 用户名",required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.5}}}),e.jsx(l,{fullWidth:!0,type:"password",label:"密码",value:r.password,onChange:t=>s({...r,password:t.target.value}),placeholder:"ArgoCD 密码",required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.5}}})]}),e.jsx(j,{control:e.jsx(v,{checked:r.insecure,onChange:t=>s({...r,insecure:t.target.checked}),color:"primary"}),label:"跳过 TLS 验证（不推荐）"}),e.jsx(l,{fullWidth:!0,multiline:!0,rows:3,label:"描述（可选）",value:r.description,onChange:t=>s({...r,description:t.target.value}),sx:{"& .MuiOutlinedInput-root":{borderRadius:1.5}}}),e.jsxs(c,{direction:"row",spacing:2,sx:{pt:2},children:[e.jsx(d,{onClick:S,disabled:g,variant:"outlined",sx:{borderRadius:1.5,textTransform:"none",px:3},children:g?"测试中...":"测试连接"}),e.jsx(d,{onClick:w,disabled:h,variant:"contained",startIcon:e.jsx(R,{}),sx:{borderRadius:1.5,textTransform:"none",px:3,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.3)","&:hover":{background:"linear-gradient(135deg, #5568d3 0%, #6a3d91 100%)",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.4)"}},children:h?"保存中...":"保存配置"})]})]})})})]})}export{z as default};
